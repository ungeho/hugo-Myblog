<!DOCTYPE html>
<html lang="ja" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>è‡ªå‹•å¾®åˆ† | ungehoBlog</title>
<meta name="keywords" content="Float, IEEE754, æ•°å€¤è¨ˆç®—, èª¤å·®, ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°, è‡ªå‹•å¾®åˆ†, åŒå¯¾æ•°">
<meta name="description" content="

ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚
1. æµ®å‹•å°æ•°ç‚¹æ•°
2. åŒºé–“æ¼”ç®—
3. æ•°å€¤ç©åˆ†
4. æ•°å€¤å¾®åˆ†
5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“


è‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚">
<meta name="author" content="ungeho">
<link rel="canonical" href="http://localhost:1313/posts/autodiff/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.4599eadb9eb2ad3d0a8d6827b41a8fda8f2f4af226b63466c09c5fddbc8706b7.css" integrity="sha256-RZnq256yrT0KjWgntBqP2o8vSvImtjRmwJxf3byHBrc=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="ja" href="http://localhost:1313/posts/autodiff/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/contrib/auto-render.min.js"
    crossorigin="anonymous"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true },
            ]
        });
    });
</script>



<script defer src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        if (window.mermaid) {
            mermaid.initialize({
                startOnLoad: true,
            });
        }
    });
</script>


</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="ungehoBlog (Alt + H)">ungehoBlog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">ãƒ›ãƒ¼ãƒ </a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      è‡ªå‹•å¾®åˆ†
    </h1>
    <div class="post-meta"><span title='2025-12-12 16:30:33 +0900 JST'>2025/12/12</span>&nbsp;Â·&nbsp;12 åˆ†&nbsp;Â·&nbsp;ungeho

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®æ¬¡</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%8f%8c%e5%af%be%e6%95%b0%e3%82%92%e7%94%a8%e3%81%84%e3%81%9f%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86" aria-label="åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†">åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†</a><ul>
                        
                <li>
                    <a href="#%e3%83%86%e3%82%a4%e3%83%a9%e3%83%bc%e5%b1%95%e9%96%8b%e3%81%8b%e3%82%89%e8%a6%8b%e3%81%9f%e5%8f%8c%e5%af%be%e6%95%b0%e3%81%ae%e5%8e%9f%e7%90%86" aria-label="ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†">ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†</a></li>
                <li>
                    <a href="#%e5%8f%8c%e5%af%be%e6%95%b0%e3%82%92%e8%a1%8c%e5%88%97%e3%81%a7%e8%a1%a8%e7%8f%be%e3%81%99%e3%82%8b" aria-label="åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹">åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹</a></li>
                <li>
                    <a href="#%e5%ae%9f%e8%a3%85%e4%b8%8a%e3%81%ae%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0" aria-label="å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ">å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a><ul>
                        
                <li>
                    <a href="#%e5%8a%a0%e7%ae%97-" aria-label="åŠ ç®— &#43;">åŠ ç®— +</a></li>
                <li>
                    <a href="#%e6%b8%9b%e7%ae%97--" aria-label="æ¸›ç®— -">æ¸›ç®— -</a></li>
                <li>
                    <a href="#%e3%82%b9%e3%82%ab%e3%83%a9%e3%83%bc%e5%80%8d" aria-label="ã‚¹ã‚«ãƒ©ãƒ¼å€">ã‚¹ã‚«ãƒ©ãƒ¼å€</a></li>
                <li>
                    <a href="#%e4%b9%97%e7%ae%97-" aria-label="ä¹—ç®— *">ä¹—ç®— *</a></li>
                <li>
                    <a href="#%e9%80%86%e8%a1%8c%e5%88%97%e9%99%a4%e7%ae%97-" aria-label="é€†è¡Œåˆ—(é™¤ç®— /)">é€†è¡Œåˆ—(é™¤ç®— /)</a></li>
                <li>
                    <a href="#%e6%8c%87%e6%95%b0%e9%96%a2%e6%95%b0" aria-label="æŒ‡æ•°é–¢æ•°">æŒ‡æ•°é–¢æ•°</a></li>
                <li>
                    <a href="#%e4%b8%89%e8%a7%92%e9%96%a2%e6%95%b0sincos" aria-label="ä¸‰è§’é–¢æ•°(sin,cos)">ä¸‰è§’é–¢æ•°(sin,cos)</a></li>
                <li>
                    <a href="#%e4%b8%89%e8%a7%92%e9%96%a2%e6%95%b0tan" aria-label="ä¸‰è§’é–¢æ•°(tan)">ä¸‰è§’é–¢æ•°(tan)</a></li>
                <li>
                    <a href="#%e5%af%be%e6%95%b0%e9%96%a2%e6%95%b0log" aria-label="å¯¾æ•°é–¢æ•°(log)">å¯¾æ•°é–¢æ•°(log)</a></li>
                <li>
                    <a href="#%e7%b4%af%e4%b9%97power" aria-label="ç´¯ä¹—ï¼ˆpowerï¼‰">ç´¯ä¹—ï¼ˆpowerï¼‰</a></li>
                <li>
                    <a href="#%e5%b9%b3%e6%96%b9%e6%a0%b9square-root" aria-label="å¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰">å¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰</a></li>
                <li>
                    <a href="#%e8%a1%8c%e5%88%97%e8%a1%a8%e7%8f%be%e3%81%ab%e5%af%be%e3%81%99%e3%82%8b%e5%b9%b3%e6%96%b9%e6%a0%b9" aria-label="è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹">è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹</a></li>
                <li>
                    <a href="#%e5%ae%9f%e8%a3%85%e4%b8%8a%e3%81%ae%e5%87%a6%e7%90%86" aria-label="å®Ÿè£…ä¸Šã®å‡¦ç†">å®Ÿè£…ä¸Šã®å‡¦ç†</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#python-flint%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%9f%e5%8f%8c%e5%af%be%e6%95%b0%e3%81%ab%e3%82%88%e3%82%8b%e7%b2%be%e5%ba%a6%e4%bf%9d%e8%a8%bc%e4%bb%98%e3%81%8d%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86" aria-label="Python-FLINTã‚’ä½¿ã£ãŸåŒå¯¾æ•°ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†">Python-FLINTã‚’ä½¿ã£ãŸåŒå¯¾æ•°ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†</a></li>
                <li>
                    <a href="#%e3%81%be%e3%81%a8%e3%82%81" aria-label="ã¾ã¨ã‚">ã¾ã¨ã‚</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><hr>
<blockquote>
<p>ğŸ’¡ <strong>ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚</strong><br>
<a href="../float"><strong>1. æµ®å‹•å°æ•°ç‚¹æ•°</strong></a><br>
<a href="../interval"><strong>2. åŒºé–“æ¼”ç®—</strong></a><br>
<a href="../numericalIntegration"><strong>3. æ•°å€¤ç©åˆ†</strong></a><br>
<a href="../numericalDifferentiation"><strong>4. æ•°å€¤å¾®åˆ†</strong></a><br>
<a href="../autoDiff"><strong>5. è‡ªå‹•å¾®åˆ†</strong></a> <strong>ğŸ‘ˆ ä»Šã“ã“</strong></p>
</blockquote>
<hr>
<p><strong>è‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD)</strong> ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>
<p>ç‰¹ã«<strong>åŒå¯¾æ•°(Dual numbers)</strong> ã‚’ç”¨ã„ãŸæ‰‹æ³•ã§ã¯ã€å…¥åŠ›ã‚’$x+\varepsilon$ ã¨ã—ã¦è¨ˆç®—ã™ã‚‹ã ã‘ã§ã€é–¢æ•°å€¤$f(x)$ ã¨å°é–¢æ•°$f^{\prime}(x)$ ãŒåŒæ™‚ã«å¾—ã‚‰ã‚Œã€æ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªèª¤å·®ãŒãªã$h$ ã®é¸æŠãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚</p>
<h2 id="åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†">åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†<a hidden class="anchor" aria-hidden="true" href="#åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†">#</a></h2>
<p>åŒå¯¾æ•°ï¼ˆDual Numbersï¼‰ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã§ã¯ã€å…¥åŠ›ã‚’</p>
<p>$$
\begin{aligned}
x + \varepsilon
\end{aligned}
$$</p>
<p>ã¨ã—ãŸã¨ãã®é–¢æ•°ã®å€¤ãŒ</p>
<p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x)
\end{aligned}
$$</p>
<p>ã¨ã„ã†å½¢ã«ãªã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã¦å¾®åˆ†å€¤ã‚’å¾—ã¾ã™ã€‚</p>
<p>ã“ã“ã§$\varepsilon$ã¯æ¬¡ã®æ€§è³ªã‚’ã‚‚ã¤ç‰¹åˆ¥ãªå…ƒã§ã™</p>
<p>$$
\begin{aligned}
\varepsilon &amp;\neq 0\\
\varepsilon^{2} &amp;= 0
\end{aligned}
$$</p>
<p>ã“ã‚Œã¯ã€Œ$\varepsilon$ ã¯äºŒä¹—ã™ã‚‹ã¨å®Œå…¨ã«æ¶ˆãˆã‚‹ã€ã¨ã„ã†æ„å‘³ã‚’è¡¨ã—ã¾ã™ã€‚</p>
<hr>
<h3 id="ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†">ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†<a hidden class="anchor" aria-hidden="true" href="#ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†">#</a></h3>
<p>ã“ã“ã§ã€æ¬¡ã®ãƒ†ã‚¤ãƒ©ãƒ¼ç´šæ•°ã‚’è€ƒãˆã¾ã™ã€‚</p>
<p>$$
\begin{aligned}
f(x + a) = \sum_{n=0}^{\infty} \frac{f^{(n)} (x)}{n!}(a)^{n}
\end{aligned}
$$</p>
<p>ã«$a=\varepsilon$ã‚’ä»£å…¥ã™ã‚‹ã¨</p>
<p>$$
\begin{aligned}
f(x + \varepsilon) = \sum_{n=0}^{\infty} \frac{f^{(n)} (x)}{n!}(\varepsilon)^{n}
\end{aligned}
$$</p>
<p>ã“ã‚Œã‚’å±•é–‹ã™ã‚‹ã¨</p>
<p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x) + \varepsilon^{2} \frac{f^{\prime\prime}(x)}{2!} +\varepsilon^{3}\frac{ f^{(3)}(x)}{3!} + \dots
\end{aligned}
$$</p>
<p>ã—ã‹ã—ã€åŒå¯¾æ•°ã®å®šç¾©ã‚ˆã‚Š</p>
<p>$$
\begin{aligned}
\varepsilon^{2} = 0
\end{aligned}
$$</p>
<p>ã§ã‚ã‚‹ãŸã‚ã€äºŒæ¬¡ä»¥é™ã®é …ãŒå…¨ã¦æ¶ˆãˆã¾ã™ã€‚<br>
ã‚ˆã£ã¦</p>
<p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x)
\end{aligned}
$$</p>
<p>ã¨ã„ã†éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªå½¢ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚<br>
ã“ã“ã§</p>
<ul>
<li>å®Ÿéƒ¨ï¼š$f(x)$</li>
<li>$\varepsilon$ã®ä¿‚æ•°ï¼š$f^{\prime}(x)$</li>
</ul>
<p>ãŒå¾—ã‚‰ã‚Œã‚‹ãŸã‚ã€åŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§<strong>é–¢æ•°å€¤ã¨å°é–¢æ•°</strong>ãŒåŒæ™‚ã«è¨ˆç®—ã§ãã‚‹ã‚ã‘ã§ã™ã€‚</p>
<hr>
<h3 id="åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹">åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹<a hidden class="anchor" aria-hidden="true" href="#åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹">#</a></h3>
<p>$$
\begin{aligned}
x + \varepsilon y
\end{aligned}
$$</p>
<p>ã¯2 x 2 ã®ä¸Šä¸‰è§’è¡Œåˆ—</p>
<p>$$
\begin{aligned}
\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¨å…¨ãåŒã˜æŒ¯ã‚‹èˆã„ã‚’ã—ã¾ã™ã€‚<br>
ã“ã®ã¨ãã€åŒå¯¾æ•°$\varepsilon$ ã¯</p>
<p>$$
\varepsilon =
\begin{aligned}
\begin{pmatrix}
0 &amp; 1 \\
0 &amp; 0
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã§ã‚ã‚Šã€è¡Œåˆ—ã®ç©ã‚’ã¨ã‚‹ã¨</p>
<p>$$
\varepsilon^{2} =
\begin{aligned}
\begin{pmatrix}
0 &amp; 1 \\
0 &amp; 0
\end{pmatrix}
\times
\begin{pmatrix}
0 &amp; 1 \\
0 &amp; 0
\end{pmatrix}
=
\begin{pmatrix}
0 &amp; 0 \\
0 &amp; 0
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã—ãŸãŒã£ã¦</p>
<p>$$
\begin{aligned}
\varepsilon &amp;\neq 0\\
\varepsilon^{2} &amp;= 0
\end{aligned}
$$</p>
<p>ã¨ã„ã†åŒå¯¾æ•°ã®æ€§è³ªãŒè¡Œåˆ—ã§æ­£ã—ãå†ç¾ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<h3 id="å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ">å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ <a hidden class="anchor" aria-hidden="true" href="#å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ">#</a></h3>
<p>åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã¯ã€åŒå¯¾æ•°</p>
<p>$$
\begin{aligned}
x + \varepsilon y
\end{aligned}
$$</p>
<p>ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ã€<strong>å››å‰‡æ¼”ç®—ãªã©ã®åŸºæœ¬çš„ãªæ¼”ç®—ã‚’ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å†å®šç¾©ã™ã‚‹</strong> ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚<br>
å…·ä½“çš„ã«ã¯ã€ã»ã¨ã‚“ã©è¡Œåˆ—æ¼”ç®—ã®å®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚</p>
<p>ä»£å…¥æ¼”ç®—å­(<code>+=</code>,<code>-=</code>,<code>*=</code>,<code>/=</code>)ã‚„ç¬¦å·<code>-</code>ã¯æ¼”ç®—å­ã‚’ä¸Šæ›¸ãã—ãŸå››å‰‡æ¼”ç®—ã‚’ä½¿ã£ã¦æ¼”ç®—ã—ã¾ã™ã€‚<br>
ä¸€éƒ¨ã®ç‰¹æ®Šé–¢æ•°ã¯å®šç¾©ã—ãŸç‰¹æ®Šé–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<hr>
<h4 id="åŠ ç®—-">åŠ ç®— +<a hidden class="anchor" aria-hidden="true" href="#åŠ ç®—-">#</a></h4>
<p>$$
\begin{aligned}
\begin{pmatrix}
a &amp; b \\
c &amp; d
\end{pmatrix}
+
\begin{pmatrix}
e &amp; f \\
g &amp; h
\end{pmatrix}
=
\begin{pmatrix}
a+e &amp; b+f \\
c+g &amp; d+h
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã‚ˆã‚Š</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) + (v + w \varepsilon)
\end{aligned}
$$</p>
<p>ã¯</p>
<p>$$
\begin{aligned}
\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
+
\begin{pmatrix}
v &amp; w \\
0 &amp; v
\end{pmatrix}
=
\begin{pmatrix}
x+v &amp; y+w \\
0 &amp; x+v
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) + (v + w \varepsilon) =
\begin{pmatrix}
x+v &amp; y+w \\
0 &amp; x+v
\end{pmatrix}
\end{aligned}
$$</p>
<hr>
<h4 id="æ¸›ç®—--">æ¸›ç®— -<a hidden class="anchor" aria-hidden="true" href="#æ¸›ç®—--">#</a></h4>
<p>$$
\begin{aligned}
\begin{pmatrix}
a &amp; b \\
c &amp; d
\end{pmatrix}
-
\begin{pmatrix}
e &amp; f \\
g &amp; h
\end{pmatrix}
=
\begin{pmatrix}
a-e &amp; b-f \\
c-g &amp; d-h
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã‚ˆã‚Š</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) - (v + w \varepsilon)
\end{aligned}
$$</p>
<p>ã¯</p>
<p>$$
\begin{aligned}
\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
-
\begin{pmatrix}
v &amp; w \\
0 &amp; v
\end{pmatrix}
=
\begin{pmatrix}
x-v &amp; y-w \\
0 &amp; x-v
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) - (v + w \varepsilon) =
\begin{pmatrix}
x-v &amp; y-w \\
0 &amp; x-v
\end{pmatrix}
\end{aligned}
$$</p>
<hr>
<h4 id="ã‚¹ã‚«ãƒ©ãƒ¼å€">ã‚¹ã‚«ãƒ©ãƒ¼å€<a hidden class="anchor" aria-hidden="true" href="#ã‚¹ã‚«ãƒ©ãƒ¼å€">#</a></h4>
<p>$$
\begin{aligned}
k(x + y \varepsilon)
\end{aligned}
$$</p>
<p>ã¯</p>
<p>$$
\begin{aligned}
k
\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
=
\begin{pmatrix}
kx &amp; ky \\
0 &amp; kx
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
k(x + y \varepsilon) =
\begin{pmatrix}
kx &amp; ky \\
0 &amp; kx
\end{pmatrix}
\end{aligned}
$$</p>
<hr>
<h4 id="ä¹—ç®—-">ä¹—ç®— *<a hidden class="anchor" aria-hidden="true" href="#ä¹—ç®—-">#</a></h4>
<p>$$
\begin{aligned}
\begin{pmatrix}
a &amp; b \\
c &amp; d
\end{pmatrix}
\times
\begin{pmatrix}
e &amp; f \\
g &amp; h
\end{pmatrix}
=
\begin{pmatrix}
ae + bg &amp; af + bh \\
ce + dg &amp; cf + dh
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã‚ˆã‚Š</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) \times (v + w \varepsilon)
\end{aligned}
$$</p>
<p>ã¯</p>
<p>$$
\begin{aligned}
\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
\times
\begin{pmatrix}
v &amp; w \\
0 &amp; v
\end{pmatrix}
=
\begin{pmatrix}
xv &amp; xw + yv \\
0 &amp; xv
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) \times (v + w \varepsilon) =
\begin{pmatrix}
xv &amp; xw + yv \\
0 &amp; xv
\end{pmatrix}
\end{aligned}
$$</p>
<hr>
<h4 id="é€†è¡Œåˆ—é™¤ç®—-">é€†è¡Œåˆ—(é™¤ç®— /)<a hidden class="anchor" aria-hidden="true" href="#é€†è¡Œåˆ—é™¤ç®—-">#</a></h4>
<p>$$
\begin{aligned}
A =
\begin{pmatrix}
a &amp; b \\
c &amp; d
\end{pmatrix},
\qquad
\det(A) = ad - bc \neq 0
\end{aligned}
$$</p>
<p>$$
\begin{aligned}
A^{-1}
= \frac{1}{ad - bc}
\begin{pmatrix}
d &amp; -b \\
-c &amp; a
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã‚ˆã‚Š</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) \div (v + w \varepsilon)
\end{aligned}
$$</p>
<p>ã¯$(v + w \varepsilon)$ ã®é€†è¡Œåˆ—ã‚’æ±‚ã‚ã¦</p>
<p>$$
\begin{aligned}
v^{2} \neq 0
\end{aligned}
$$</p>
<p>ã‚ˆã‚Šå®Ÿéƒ¨$v \neq 0$ ã®ã¨ã</p>
<p>$$
\begin{aligned}
&amp;\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
\times
\frac{1}{v^{2}}
\begin{pmatrix}
v &amp; -w \\
0 &amp; v
\end{pmatrix}\\
=
&amp;\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
\times
\begin{pmatrix}
\frac{1}{v} &amp; -\frac{w}{v^{2}} \\
0 &amp; \frac{1}{v}
\end{pmatrix}\\
=
&amp;\begin{pmatrix}
\frac{x}{v} &amp; -\frac{xw}{v^{2}}+\frac{y}{v} \\
0 &amp; \frac{x}{v}
\end{pmatrix}\\
=
&amp;\begin{pmatrix}
\frac{x}{v} &amp; \frac{yv-xw}{v^{2}} \\
0 &amp; \frac{x}{v}
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
(x + y \varepsilon) \div (v + w \varepsilon) =
\begin{pmatrix}
\frac{x}{v} &amp; \frac{yv-xw}{v^{2}} \\
0 &amp; \frac{x}{v}
\end{pmatrix}
\end{aligned}
$$</p>
<hr>
<h4 id="æŒ‡æ•°é–¢æ•°">æŒ‡æ•°é–¢æ•°<a hidden class="anchor" aria-hidden="true" href="#æŒ‡æ•°é–¢æ•°">#</a></h4>
<p>ä¸ãˆã‚‰ã‚ŒãŸ$x + \varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚</p>
<p>$$
\begin{aligned}
\exp(x + \varepsilon y) = \exp(x) \times \exp(\varepsilon y)
\end{aligned}
$$</p>
<p>æŒ‡æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã$\exp(X)$ã¯</p>
<p>$$
\begin{aligned}
\exp(X) = \sum_{k=0}^{\infty} \frac{X^{k}}{k!}
\end{aligned}
$$</p>
<p>ã§ã™ã€‚</p>
<p>å®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾</p>
<p>$$
\exp(x)
$$</p>
<p>ã¨ã™ã‚‹ã€‚<br>
åŒå¯¾æ•°$\varepsilon y$ ã¯$\varepsilon^{2} = 0$ã‚ˆã‚Š$k\ge2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§</p>
<p>$$
\begin{aligned}
\exp(\varepsilon y) = \sum_{k=0}^{\infty} \frac{(\varepsilon y)^{k}}{k!} = 1 + \varepsilon y
\end{aligned}
$$</p>
<p>ã«ãªã‚‹ã€‚</p>
<p>ã“ã‚Œã‚’ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
\exp(x + \varepsilon y) = \exp(x) \times (1 + \varepsilon y) = \exp(x) + \varepsilon y \exp(x)
\end{aligned}
$$</p>
<p>ã«ãªã‚Š</p>
<p>$$
\begin{aligned}
\exp(x + \varepsilon y) =
\begin{pmatrix}
\exp(x) &amp;  y \exp(x) \\
0 &amp; \exp(x)
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã§ã‚ã‚‹ã€‚</p>
<hr>
<h4 id="ä¸‰è§’é–¢æ•°sincos">ä¸‰è§’é–¢æ•°(sin,cos)<a hidden class="anchor" aria-hidden="true" href="#ä¸‰è§’é–¢æ•°sincos">#</a></h4>
<p>ä¸ãˆã‚‰ã‚ŒãŸ$x + \varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚</p>
<ul>
<li>æ­£å¼¦é–¢æ•°(sin)ã®å ´åˆ</li>
</ul>
<p>$$
\begin{aligned}
\sin(x + \varepsilon y) = \sin(x)\times\cos(\varepsilon y) + \cos(x) \times \sin(\varepsilon y)
\end{aligned}
$$</p>
<ul>
<li>ä½™å¼¦é–¢æ•°(cos)ã®å ´åˆ</li>
</ul>
<p>$$
\begin{aligned}
\cos(x + \varepsilon y) = \cos(x)\times\cos(\varepsilon y) - \sin(x) \times \sin(\varepsilon y)
\end{aligned}
$$</p>
<p>ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã</p>
<ul>
<li>æ­£å¼¦é–¢æ•°(sin)ã¯</li>
</ul>
<p>$$
\begin{aligned}
\sin(X) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k + 1)!} X^{2k+1}
\end{aligned}
$$</p>
<ul>
<li>ä½™å¼¦é–¢æ•°(cos)ã¯</li>
</ul>
<p>$$
\begin{aligned}
\cos(X) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k)!} X^{2k}
\end{aligned}
$$</p>
<p>æŒ‡æ•°é–¢æ•°ã®æ™‚ã¨åŒã˜ã‚ˆã†ã«ã€å®Ÿéƒ¨$x$ã¯ãã®ã¾ã¾</p>
<ul>
<li>æ­£å¼¦é–¢æ•°(sin)</li>
</ul>
<p>$$
\sin(x)
$$</p>
<ul>
<li>ä½™å¼¦é–¢æ•°(cos)</li>
</ul>
<p>$$
\cos(x)
$$</p>
<p>ã¨ã™ã‚‹ã€‚<br>
åŒå¯¾æ•°$\varepsilon y$ ã¯$\varepsilon^{2} = 0$ã‚ˆã‚Š$k\ge1$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§</p>
<ul>
<li>æ­£å¼¦é–¢æ•°(sin)ã¯</li>
</ul>
<p>$$
\begin{aligned}
\sin(\varepsilon y) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k + 1)!} (\varepsilon y)^{2k+1}=\varepsilon y
\end{aligned}
$$</p>
<ul>
<li>ä½™å¼¦é–¢æ•°(cos)ã¯</li>
</ul>
<p>$$
\begin{aligned}
\cos(\varepsilon y) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k)!} (\varepsilon y)^{2k} = 1
\end{aligned}
$$</p>
<p>ã‚ˆã£ã¦</p>
<ul>
<li>æ­£å¼¦é–¢æ•°(sin)ã¯</li>
</ul>
<p>$$
\begin{aligned}
&amp;\sin(x + \varepsilon y)\\
= &amp;\sin(x)\times\cos(\varepsilon y) + \cos(x) \times \sin(\varepsilon y)\\
= &amp;\sin(x) \times 1 + \cos(x) \times \varepsilon y \\
= &amp;\sin(x) + \varepsilon y \cos(x)
\end{aligned}
$$</p>
<ul>
<li>ä½™å¼¦é–¢æ•°(cos)ã¯</li>
</ul>
<p>$$
\begin{aligned}
&amp;\cos(x + \varepsilon y)\\
= &amp;\cos(x) \times \cos(\varepsilon y) - \sin(x) \times \sin(\varepsilon y)\\
= &amp;\cos(x) \times 1 - \sin(x) \times \varepsilon y\\
= &amp;\cos(x) - \varepsilon y \sin(x)
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<ul>
<li>æ­£å¼¦é–¢æ•°(sin)</li>
</ul>
<p>$$
\begin{aligned}
\sin(x + \varepsilon y) =
\begin{pmatrix}
\sin(x) &amp; y \cos(x) \\
0 &amp; \sin(x)
\end{pmatrix}
\end{aligned}
$$</p>
<ul>
<li>ä½™å¼¦é–¢æ•°(cos)</li>
</ul>
<p>$$
\begin{aligned}
\cos(x + \varepsilon y) =
\begin{pmatrix}
\cos(x) &amp; - y \sin(x) \\
0 &amp; \cos(x)
\end{pmatrix}
\end{aligned}
$$</p>
<hr>
<h4 id="ä¸‰è§’é–¢æ•°tan">ä¸‰è§’é–¢æ•°(tan)<a hidden class="anchor" aria-hidden="true" href="#ä¸‰è§’é–¢æ•°tan">#</a></h4>
<p>$$
\begin{aligned}
\tan(x + y \varepsilon) = \frac{\sin(x + y\varepsilon)}{\cos(x + y\varepsilon)}
\end{aligned}
$$</p>
<p>ã«ã‚ˆã‚Šã€ä¸‰è§’é–¢æ•°(sin,cos)ã¨ä¹—ç®—ã¨é€†è¡Œåˆ—(é™¤ç®—)ã‚’å®Ÿè£…ã—ã¦ã€ãã‚Œã‚‰ã‚’åˆ©ç”¨ã“ã¨ã§æ¼”ç®—å¯èƒ½ã«ãªã‚‹ã€‚</p>
<hr>
<h4 id="å¯¾æ•°é–¢æ•°log">å¯¾æ•°é–¢æ•°(log)<a hidden class="anchor" aria-hidden="true" href="#å¯¾æ•°é–¢æ•°log">#</a></h4>
<p>ä¸ãˆã‚‰ã‚ŒãŸ$x + \varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚</p>
<p>$$
\begin{aligned}
x + y \varepsilon = x \times \left(1 + \frac{y \varepsilon}{x} \right)
\end{aligned}
$$</p>
<p>ã‚ˆã‚Š</p>
<p>$$
\begin{aligned}
\log \left( x \times \left( 1 + \frac{y \varepsilon}{x} \right) \right) = \log(x) + \log \left(1 + \frac{y \varepsilon} {x} \right)
\end{aligned}
$$</p>
<p>å¯¾æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$1 + X$ã¨ã—ãŸã¨ã$\log(1 + X)$ã¯</p>
<p>$$
\begin{aligned}
\log(1 + X) = \sum_{k=1}^{\infty} \frac{(-1)^{k+1}}{k} X^{k}
\end{aligned}
$$</p>
<p>ã§ã™ã€‚</p>
<p>å®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾</p>
<p>$$
\begin{aligned}
\log(x)
\end{aligned}
$$</p>
<p>ã¨ã™ã‚‹ã€‚
åŒå¯¾æ•°$ \left(1 + \frac{y \varepsilon}{x} \right)$ ã¯$\varepsilon^{2} = 0$ã‚ˆã‚Š$k \ge 2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§</p>
<p>$$
\begin{aligned}
\log \left(1 + \frac{y \varepsilon}{x} \right) = \sum_{k=1}^{\infty} \frac{(-1)^{k+1}}{k} \left( \frac{y \varepsilon}{x} \right) ^{k} = \frac{y \varepsilon}{x}
\end{aligned}
$$</p>
<p>ã‚ˆã£ã¦</p>
<p>$$
\begin{aligned}
\log \left( x \times \left(1 + \frac{y \varepsilon}{x} \right) \right) = \log(x) + \frac{y \varepsilon}{x}
\end{aligned}
$$</p>
<p>ã¾ã¨ã‚ã‚‹ã¨</p>
<p>$$
\begin{aligned}
\log(x + y \varepsilon) =
\begin{pmatrix}
\log(x) &amp; \frac{y}{x} \\
0 &amp; \log(x)
\end{pmatrix}
\end{aligned}
$$</p>
<h4 id="ç´¯ä¹—power">ç´¯ä¹—ï¼ˆpowerï¼‰<a hidden class="anchor" aria-hidden="true" href="#ç´¯ä¹—power">#</a></h4>
<p>åŒå¯¾æ•°ã®ç´¯ä¹— $X^n$ ã‚’è¨ˆç®—ã™ã‚‹å ´åˆï¼ŒæŒ‡æ•° $n$ ãŒæ•´æ•°ã‹éæ•´æ•°ã‹ã§æ‰±ã„ãŒç•°ãªã‚Šã¾ã™ã€‚</p>
<hr>
<p><strong>1. $n$ãŒæ•´æ•°ã®å ´åˆï¼ˆæ•´æ•°ä¹—ï¼‰</strong></p>
<ul>
<li>$n = 0$ã®ã¨ã</li>
</ul>
<p>$$
\begin{aligned}
X^{0} = I
\end{aligned}
$$</p>
<p>ï¼ˆå˜ä½è¡Œåˆ—ã‚’è¿”ã™ï¼‰</p>
<ul>
<li>$n &gt; 0$ã®ã¨ã</li>
</ul>
<p>$$
\begin{aligned}
X^n = \underbrace{X X \cdots X}_{n\ \text{å›}}
\end{aligned}
$$</p>
<p>ï¼ˆåå¾©ä¹—ç®—ï¼‰</p>
<ul>
<li>$n &lt; 0$ ã®ã¨ã</li>
</ul>
<p>$$
\begin{aligned}
X^n = (X^{-1})^{|n|}
\end{aligned}
$$</p>
<p>ï¼ˆé€†è¡Œåˆ—ã‚’ä½¿ã£ã¦æ­£ã®æŒ‡æ•°ã¨åŒæ§˜ã«è¨ˆç®—ï¼‰</p>
<hr>
<p><strong>2. $n$ ãŒå®Ÿæ•°ã®ã¨ãï¼ˆå®Ÿæ•°ä¹—ãƒ»éæ•´æ•°æŒ‡æ•°ï¼‰</strong></p>
<p>ã¾ãšæ¡ä»¶ã¨ã—ã¦ã€åŒå¯¾æ•°</p>
<p>$$
\begin{aligned}
X = x + y\varepsilon
\end{aligned}
$$</p>
<p>ã®å®Ÿéƒ¨ $x$ ãŒ$0$ã‚ˆã‚Šå¤§ãã„å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>ã™ãªã‚ã¡ã€æŒ‡æ•° $n$ ãŒå®Ÿæ•°</p>
<p>$$
\begin{aligned}
n \in \mathbb{R}
\end{aligned}
$$</p>
<p>ã§ã‚ã‚‹å ´åˆã€åŒå¯¾æ•° $X$ ã¯</p>
<p>$$
\begin{aligned}
X = x + y\varepsilon,\qquad x &gt; 0
\end{aligned}
$$</p>
<p>ã‚’æº€ãŸã•ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</p>
<p>ã“ã‚Œã¯ã€å®Ÿæ•°ã«ãŠã‘ã‚‹ç´¯ä¹—</p>
<p>$$
\begin{aligned}
x^n = \exp(n\log x)
\end{aligned}
$$</p>
<p>ãŒ $x&gt;0$ ã®ã‚‚ã¨ã§å®šç¾©ã•ã‚Œã‚‹ã“ã¨ã¨å®Œå…¨ã«ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚</p>
<p>ä¸€èˆ¬ã®å®Ÿæ•°æŒ‡æ•° $n$ ã«å¯¾ã—ã¦ã¯ï¼ŒæŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ä½¿ã£ã¦</p>
<p>$$
\begin{aligned}
X^n = \exp\bigl(n \log X\bigr)
\end{aligned}
$$</p>
<p>ã¨å®šç¾©ã—ã¾ã™ã€‚</p>
<p>ã“ã‚Œã¯å®Ÿæ•°ã®ä¸–ç•Œã«ãŠã‘ã‚‹å®šç¾©</p>
<p>$$
\begin{aligned}
x^n = \exp\bigl(n\log x\bigr)
\end{aligned}
$$</p>
<p>ã®è¡Œåˆ—ç‰ˆã§ã™ã€‚</p>
<p>åŒå¯¾æ•°ã¯è¡Œåˆ—ã§è¡¨ã›ã‚‹ã®ã§</p>
<ul>
<li><code>log(X)</code>ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®å¯¾æ•°ï¼‰</li>
<li><code>exp(n log(X))</code>ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®æŒ‡æ•°ï¼‰</li>
</ul>
<p>ãŒã™ã¹ã¦è¨ˆç®—å¯èƒ½ã«ãªã‚Šã€ä»»æ„å®Ÿæ•°æŒ‡æ•°ã®ç´¯ä¹—ã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<hr>
<h4 id="å¹³æ–¹æ ¹square-root">å¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰<a hidden class="anchor" aria-hidden="true" href="#å¹³æ–¹æ ¹square-root">#</a></h4>
<p>å¹³æ–¹æ ¹ã¯ç´¯ä¹—ã®ç‰¹åˆ¥ãªå ´åˆã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚<br>
ã™ãªã‚ã¡</p>
<p>$$
\begin{aligned}
\sqrt{X} = X^{\frac{1}{2}}
\end{aligned}
$$</p>
<p>ãŸã ã—ã€åŒå¯¾æ•° $X$ ã®å®Ÿéƒ¨ãŒ$0$ã‚ˆã‚Šå¤§ãã„ã“ã¨ã€‚ã¤ã¾ã‚Š</p>
<p>$$
\begin{aligned}
X = x + y\varepsilon,\qquad x &gt; 0
\end{aligned}
$$</p>
<p>ã‚’æº€ãŸã™ã“ã¨ãŒæ¡ä»¶ã§ã™ã€‚<br>
å‰ç¯€ã§å®šç¾©ã—ãŸç´¯ä¹—æ¼”ç®— $X^n$ ã‚’æŒ‡æ•° $n = \frac{1}{2}$ ã¨ã—ã¦è©•ä¾¡ã™ã‚Œã°å¹³æ–¹æ ¹ãŒè¨ˆç®—ã§ãã¾ã™ã€‚</p>
<hr>
<h4 id="è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹">è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹<a hidden class="anchor" aria-hidden="true" href="#è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹">#</a></h4>
<p>åŒå¯¾æ•°ã®è¡Œåˆ—è¡¨ç¾</p>
<p>$$
\begin{aligned}
X =
\begin{pmatrix}
x &amp; y \\
0 &amp; x
\end{pmatrix}
,\qquad x &gt; 0
\end{aligned}
$$</p>
<p>ã«å¯¾ã—ã¦ã¯ï¼Œ</p>
<p>$$
\begin{aligned}
\sqrt{X}
=
\begin{pmatrix}
\sqrt{x} &amp; \frac{y}{2\sqrt{x}} \\
0 &amp; \sqrt{x}
\end{pmatrix}
\end{aligned}
$$</p>
<p>ã¨ãªã‚Šï¼Œã“ã‚Œã¯é€šå¸¸ã®å¹³æ–¹æ ¹ã®å¾®åˆ†æ³•å‰‡</p>
<p>$$
\begin{aligned}
\frac{d}{dx} \sqrt{x} = \frac{1}{2\sqrt{x}}
\end{aligned}
$$</p>
<p>ã¨ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚</p>
<hr>
<h4 id="å®Ÿè£…ä¸Šã®å‡¦ç†">å®Ÿè£…ä¸Šã®å‡¦ç†<a hidden class="anchor" aria-hidden="true" href="#å®Ÿè£…ä¸Šã®å‡¦ç†">#</a></h4>
<ul>
<li>$n = \frac{1}{2}$ ã¨ã—ã¦ç´¯ä¹—æ¼”ç®— <code>pow(X, n)</code> ã‚’å‘¼ã³å‡ºã™ã ã‘ã§ã‚ˆã„</li>
<li>ç´¯ä¹—ã®ç¯€ã§ç¤ºã—ãŸã‚ˆã†ã«
<ul>
<li>æŒ‡æ•°$n$ãŒæ•´æ•°ã‹ã©ã†ã‹ã‚’åˆ¤å®š</li>
<li>éæ•´æ•°ã®å ´åˆã¯ã€å®Ÿéƒ¨ãŒ$0$ã‚ˆã‚Šå¤§ãã„ã‹$(x &gt; 0)$ã‚’åˆ¤å®š</li>
<li>å®Ÿéƒ¨ãŒ0ã‚ˆã‚Šå¤§ãã„ã®ã§ã‚ã‚Œã°ã€æŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ç”¨ã„ã¦<br>
$$
\begin{aligned}
\sqrt{X} = X^{\frac{1}{2}} = \exp \left(\frac{1}{2} \log X\right)
\end{aligned}
$$
ã®å½¢ã§å‡¦ç†ã•ã‚Œã‚‹</li>
</ul>
</li>
</ul>
<p>ã“ã‚Œã«ã‚ˆã‚Šï¼ŒåŒå¯¾æ•°ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹ãŒè‡ªç„¶ã«è¨ˆç®—ã§ãã¾ã™ã€‚</p>
<hr>
<h2 id="python-flintã‚’ä½¿ã£ãŸåŒå¯¾æ•°ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†">Python-FLINTã‚’ä½¿ã£ãŸåŒå¯¾æ•°ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†<a hidden class="anchor" aria-hidden="true" href="#python-flintã‚’ä½¿ã£ãŸåŒå¯¾æ•°ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†">#</a></h2>
<p>åŒå¯¾æ•°ã‚’ä½¿ã£ãŸè‡ªå‹•å¾®åˆ†ã§ã¯</p>
<p>$$
\begin{aligned}
x + \varepsilon y
\end{aligned}
$$</p>
<p>ã¨ã„ã†å½¢ã®æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€<strong>é–¢æ•°å€¤ã¨ãã®å¾®åˆ†å€¤</strong> ã‚’åŒæ™‚ã«è¨ˆç®—å‡ºæ¥ã¾ã™ã€‚</p>
<p>ã•ã‚‰ã«ã€å®Ÿæ•°éƒ¨ãƒ»å¾®åˆ†å€¤ã®è¨ˆç®—ã«<strong>Python-FLINTã®<code>arb</code>å‹(å®Ÿæ•°ã®ãŸã‚ã®åŒºé–“æ¼”ç®—)</strong> ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ä¸¸ã‚èª¤å·®ã‚’å«ã‚ãŸ <strong>ã€ŒçœŸã®å€¤ã‚’å¿…ãšå«ã‚€åŒºé–“ã€ã¨ã—ã¦ã®è‡ªå‹•å¾®åˆ†ã®çµæœ</strong> ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<p>æ¬¡ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€Python-FLINTã‚’ç”¨ã„ã¦ã€åŒå¯¾æ•°ã«ã‚ˆã‚Šè‡ªå‹•å¾®åˆ†ã‚’è¡Œã„ã¤ã¤ã€<code>arb</code>ã«ã‚ˆã‚‹åŒºé–“ã§ç²¾åº¦ä¿è¨¼ã‚’è¡Œã†å®Ÿè£…ä¾‹ã§ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flint</span> <span class="kn">import</span> <span class="n">arb</span><span class="p">,</span> <span class="n">ctx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">require_pos</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">arb</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&#34;x&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    v ãŒã€ç¢ºå®Ÿã«æ­£ã€ã§ã‚ã‚‹ã“ã¨ã‚’è¦æ±‚ã™ã‚‹ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">    ï¼ˆåŒºé–“ãŒ 0 ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚Œã°å®šç¾©åŸŸå¤–ã¨ã—ã¦æ­¢ã‚ã‚‹ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s2"> must be strictly positive (interval must not include 0). got </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">DualArb</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Dual number over Arb:
</span></span></span><span class="line"><span class="cl"><span class="s2">        x + eps * dx  (eps^2 = 0)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    val: arb  â€” å®Ÿæ•°éƒ¨ x
</span></span></span><span class="line"><span class="cl"><span class="s2">    der: arb  â€” å¾®åˆ†å€¤ dx
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;val&#34;</span><span class="p">,</span> <span class="s2">&#34;der&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">der</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">arb</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">=</span> <span class="n">arb</span><span class="p">(</span><span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">lift</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ã‚¹ã‚«ãƒ©ãƒ¼ or DualArb ã‚’ DualArb ã«æŒã¡ä¸Šã’ã‚‹ã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DualArb</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;DualArb(val=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="si">}</span><span class="s2">, der=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="si">}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># --- å››å‰‡æ¼”ç®— ---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">other</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="fm">__radd__</span> <span class="o">=</span> <span class="fm">__add__</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">other</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">other</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">der</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">other</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># (x + eps dx)(y + eps dy) = xy + eps (x dy + y dx)</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span>
</span></span><span class="line"><span class="cl">        <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">der</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">other</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># (x + eps dx) / (y + eps dy)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># = (x / y) + eps * ( (dx*y - x*dy) / y^2 )</span>
</span></span><span class="line"><span class="cl">        <span class="n">inv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="n">inv</span>
</span></span><span class="line"><span class="cl">        <span class="n">der</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">der</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="n">inv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># (a) / (x + eps dx)</span>
</span></span><span class="line"><span class="cl">        <span class="n">other</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">inv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="n">inv</span>
</span></span><span class="line"><span class="cl">        <span class="n">der</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="n">inv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># --- ç´¯ä¹— ---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        (x + eps dx)^n
</span></span></span><span class="line"><span class="cl"><span class="s2">        - n ãŒ intï¼ˆæ•´æ•°ï¼‰ãªã‚‰ã€é€šå¸¸ã®æ•´æ•°ä¹—ã¨ã—ã¦æ‰±ã†
</span></span></span><span class="line"><span class="cl"><span class="s2">        - ãã‚Œä»¥å¤–ï¼ˆå®Ÿæ•°æŒ‡æ•°ï¼‰ã¯ x&gt;0 ã‚’è¦æ±‚ï¼ˆå®Ÿæ•°ã® log ãŒå¿…è¦ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">DualArb</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&#34;DualArb ** DualArb ã¯æœªå®Ÿè£…ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼æŒ‡æ•°ã ã‘å¯¾å¿œï¼‰ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># --- 1) æ•´æ•°æŒ‡æ•°ï¼ˆPython intï¼‰ ---</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># (x + eps dx)^0 = 1, å¾®åˆ†ã¯ 0</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># 0 ã®è² æ•´æ•°ä¹—ã¯ä¸å¯</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># arb ã®ã€Œ0ã¨ç­‰ã—ã„ã€åˆ¤å®šã¯æ›–æ˜§ã«ãªã‚Šå¾—ã‚‹ã®ã§å®‰å…¨å´ã«å€’ã™</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s2">&#34;0 ã®è² æ•´æ•°ä¹—ã¯å®šç¾©ã§ãã¾ã›ã‚“ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># 0 ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚‹åŒºé–“ãªã‚‰ã‚¢ã‚¦ãƒˆ</span>
</span></span><span class="line"><span class="cl">                    <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s2">&#34;0 ã‚’å«ã‚€åŒºé–“ã®è² æ•´æ•°ä¹—ã¯å®šç¾©ã§ãã¾ã›ã‚“ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">**</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">            <span class="n">der</span> <span class="o">=</span> <span class="n">arb</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># --- 2) éæ•´æ•°æŒ‡æ•°ï¼ˆå®Ÿæ•°æŒ‡æ•°ï¼‰ ---</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_arb</span> <span class="o">=</span> <span class="n">arb</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å®Ÿæ•°ã¨ã—ã¦ã® x^n ã‚’ exp(n log x) ã§å®šç¾©ã™ã‚‹ã®ã§ x&gt;0 ãŒå¿…è¦</span>
</span></span><span class="line"><span class="cl">        <span class="n">require_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&#34;pow real-part (non-integer exponent)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">**</span> <span class="n">n_arb</span>
</span></span><span class="line"><span class="cl">        <span class="n">der</span> <span class="o">=</span> <span class="n">n_arb</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">**</span> <span class="p">(</span><span class="n">n_arb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        base ** (x + eps dx)
</span></span></span><span class="line"><span class="cl"><span class="s2">        = exp((x + eps dx) * log(base))
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">base_arb</span> <span class="o">=</span> <span class="n">arb</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">base_arb</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;base ã¯æ­£ã®å®Ÿæ•°ã«ã—ã¦ã­ï¼ˆlog ãŒå¿…è¦ã«ãªã‚‹ã®ã§ï¼‰ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># f(x) = base^x, f&#39;(x) = base^x * log(base)</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="n">base_arb</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">val</span>
</span></span><span class="line"><span class="cl">        <span class="n">der</span> <span class="o">=</span> <span class="n">val</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="n">base_arb</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --- elementary functions on DualArb ---</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dual_exp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    exp(x + eps dx) = exp(x) + eps * dx * exp(x)
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dual_log</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    log(x + eps dx) = log(x) + eps * dx / x
</span></span></span><span class="line"><span class="cl"><span class="s2">    å®šç¾©åŸŸï¼ˆå®Ÿæ•°ï¼‰ï¼šå®Ÿéƒ¨ãŒ strictly positive
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">require_pos</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&#34;log real-part&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">log</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">der</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dual_sin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    sin(x + eps dx) = sin(x) + eps * dx * cos(x)
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">sin</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">cos</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dual_cos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    cos(x + eps dx) = cos(x) - eps * dx * sin(x)
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">cos</span><span class="p">(),</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">der</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">sin</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dual_tan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    tan = sin / cos ã§å®Ÿè£…ï¼ˆå®‰ç›´ç‰ˆï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dual_sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">dual_cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dual_sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    sqrt(x + eps dx) = sqrt(x) + eps * dx / (2 * sqrt(x))
</span></span></span><span class="line"><span class="cl"><span class="s2">    å®šç¾©åŸŸï¼ˆå®Ÿæ•°ï¼‰ï¼šå®Ÿéƒ¨ãŒ strictly positive
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">require_pos</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&#34;sqrt real-part&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">der</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">differentiate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">dps</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="n">dps</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">DualArb</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">DualArb</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">DualArb</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">der</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">flint</span> <span class="kn">import</span> <span class="n">arb</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># f(x) ã‚’ DualArb ã§æ›¸ã</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">DualArb</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DualArb</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># f(x) = x^3 + 2 * sin(x) * exp(x)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dual_sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">dual_exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># xã®å€¤ã¨ç²¾åº¦ã‚’å…¥åŠ›</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span><span class="p">,</span> <span class="n">der</span> <span class="o">=</span> <span class="n">differentiate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dps</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># çµæœå‡ºåŠ›</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› -------------------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;f(x)  =&#34;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;f&#39;(x) =&#34;</span><span class="p">,</span> <span class="n">der</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ã“ã“ã‹ã‚‰ã¯æ¤œç®—ç”¨ï¼ˆæ™®é€šã®arbã§è¨ˆç®—ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¤œç®—ç”¨ã® x ã® å€¤ã‚’arbã§å…¥åŠ›</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">arb</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f_exact</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># f&#39;(x) = 3x^2 + 2[cos x * e^x + sin x * e^x]</span>
</span></span><span class="line"><span class="cl">    <span class="n">fprime_exact</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">cos</span><span class="p">()</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¤œç®—å‡ºåŠ›</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› ---------------------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;f(x) (exact-like)  =&#34;</span><span class="p">,</span> <span class="n">f_exact</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;f&#39;(x) (exact-like) =&#34;</span><span class="p">,</span> <span class="n">fprime_exact</span><span class="p">)</span>
</span></span></code></pre></div><p>å®Ÿè¡Œçµæœ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› -------------------
</span></span><span class="line"><span class="cl">f<span class="o">(</span>x<span class="o">)</span>  <span class="o">=</span> <span class="o">[</span>21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79<span class="o">]</span>
</span></span><span class="line"><span class="cl">f<span class="s1">&#39;(x) = [19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79]
</span></span></span><span class="line"><span class="cl"><span class="s1">-------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› ---------------------
</span></span></span><span class="line"><span class="cl"><span class="s1">f(x) (exact-like)  = [21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79]
</span></span></span><span class="line"><span class="cl"><span class="s1">f&#39;</span><span class="o">(</span>x<span class="o">)</span> <span class="o">(</span>exact-like<span class="o">)</span> <span class="o">=</span> <span class="o">[</span>19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79<span class="o">]</span>
</span></span></code></pre></div><h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚<a hidden class="anchor" aria-hidden="true" href="#ã¾ã¨ã‚">#</a></h2>
<p>æœ¬è¨˜äº‹ã§ã¯ã€<strong>åŒå¯¾æ•°ï¼ˆDual numbersï¼‰</strong> ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã®ä»•çµ„ã¿ã«ã¤ã„ã¦</p>
<ul>
<li><strong>åŒå¯¾æ•°ã®å®šç¾©ã¨ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŸç†</strong></li>
<li><strong>åŒå¯¾æ•°ã‚’ 2Ã—2 ä¸Šä¸‰è§’è¡Œåˆ—è¡¨ç¾ã«è½ã¨ã—è¾¼ã‚€æ–¹æ³•</strong></li>
<li><strong>å››å‰‡æ¼”ç®—ï¼ˆåŠ ç®—ãƒ»æ¸›ç®—ãƒ»ä¹—ç®—ãƒ»é™¤ç®—ï¼‰ã®å…·ä½“çš„ãªå¼</strong></li>
<li><strong>exp, log, sin, cos, tan, ç´¯ä¹—ï¼Œå¹³æ–¹æ ¹ã¨ã„ã£ãŸåˆç­‰é–¢æ•°ã®æ‹¡å¼µæ–¹æ³•</strong></li>
<li><strong>ãã‚Œã‚‰ã‚’åœŸå°ã«ã—ãŸå®Ÿè£…ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong></li>
</ul>
<p>ã¨ã„ã£ãŸæµã‚Œã§æ•´ç†ã—ã¾ã—ãŸã€‚</p>
<hr>
<p>åŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§</p>
<ul>
<li>é–¢æ•°å€¤ $f(x)$ ã¨å°é–¢æ•° $f^{\prime}(x)$ ã‚’ <strong>1 å›ã®è©•ä¾¡ã§åŒæ™‚ã«å¾—ã‚‰ã‚Œã‚‹</strong></li>
<li>å·®åˆ†å¹… $h$ ã®èª¿æ•´ãŒä¸è¦ã§ï¼Œ<strong>æ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚µã‚¤ã‚ºèµ·å› ã®èª¤å·®ãŒãªã„</strong></li>
<li>å®Ÿè£…ã¯ã€Œã„ã¤ã‚‚ã®å®Ÿæ•°æ¼”ç®—ã€ã‚’ãã®ã¾ã¾åŒå¯¾æ•°ï¼ˆè¡Œåˆ—ï¼‰ã«æ‹¡å¼µã™ã‚‹ã ã‘</li>
</ul>
<p>ã¨ã„ã£ãŸåˆ©ç‚¹ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<hr>
<p>ã•ã‚‰ã«ï¼ŒPython-FLINT ã® <code>arb</code> å‹ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ï¼Œ</p>
<ul>
<li>å®Ÿæ•°éƒ¨ãƒ»å¾®åˆ†å€¤ã®ã©ã¡ã‚‰ã‚‚ <strong>ã€ŒçœŸå€¤ã‚’å«ã‚€åŒºé–“ã€</strong> ã¨ã—ã¦è¡¨ç¾ã§ãã‚‹</li>
<li>ä¸¸ã‚èª¤å·®ã‚’å«ã‚ãŸ <strong>ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†</strong> ãŒå®Ÿç¾ã§ãã‚‹</li>
</ul>
<p>ã¨ã„ã†ã¨ã“ã‚ã¾ã§åˆ°é”ã—ã¾ã—ãŸã€‚</p>
<hr>
<p>æ•°å€¤å¾®åˆ†ãƒ»è‡ªå‹•å¾®åˆ†ã‚’ä¸¦ã¹ã¦è¦‹ãŸã¨ã</p>
<ul>
<li><strong>æ•°å€¤å¾®åˆ†ï¼šå®Ÿè£…ã¯ç°¡å˜ã ãŒï¼Œèª¤å·®ã¨ $h$ ã®é¸ã³æ–¹ã«æ‚©ã¾ã•ã‚Œã‚‹</strong></li>
<li><strong>è‡ªå‹•å¾®åˆ†ï¼šç²¾åº¦ä¿è¨¼ã«ã¯åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§è‰¯ã„</strong></li>
</ul>
<p>ã¨ã„ã†æ€§è³ªã®é•ã„ãŒã‚ã‚Šã€ã¨ã¦ã‚‚æ°—æŒã¡ã®ã‚ˆã„æ‰‹æ³•ã ã¨æ„Ÿã˜ã¦ã‚‚ã‚‰ãˆãŸã‚‰å¬‰ã—ã„ã§ã™ã€‚<br>
ç‰¹ã«ã€<strong>åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§ç²¾åº¦ãŒä¿è¨¼ã•ã‚Œã‚‹(æ•°å¼ä¸Šã®èª¤å·®ãŒãªã„)</strong> ã¯åŒå¯¾æ•°ã‚’ç”¨ã„ãŸå¾®åˆ†ã®å¤§ããªåˆ©ç‚¹ã§ã™ã€‚</p>
<p>ã¾ãŸåŒå¯¾æ•°ã‚’ä½¿ã£ãŸè‡ªå‹•å¾®åˆ†ã¯</p>
<ul>
<li><strong>$n$æ¬¡ã®è¶…åŒå¯¾æ•°ã«ã‚ˆã‚‹$n$éšå¾®åˆ†ã®è¨ˆç®—</strong><br>
ãŸã ã—ã€$n$ã¯æ•´æ•°ã§ã‚ã‚Š$n \ge 2$ã§ã€$n$éšå¾®åˆ†ã‚’è¡Œã†ã¨ãã®$n$æ¬¡ã®è¶…åŒå¯¾æ•°ã®è¡Œåˆ—ã‚µã‚¤ã‚ºã¯$2^{n} \times 2^{n}$ã§ã‚ã‚Šã€$n$æ¬¡ã®è¶…åŒå¯¾æ•°ã®æ•°ã¯$2^{n-1}$å€‹ã«ãªã‚‹ã€‚<br>
ãã®ãŸã‚ã€è¡Œåˆ—ã®è¨ˆç®—é‡ãŒè†¨å¤§ã«ãªã‚‹ã€‚</li>
</ul>
<p>ã«ã‚‚ç™ºå±•ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/float/">Float</a></li>
      <li><a href="http://localhost:1313/tags/ieee754/">IEEE754</a></li>
      <li><a href="http://localhost:1313/tags/%E6%95%B0%E5%80%A4%E8%A8%88%E7%AE%97/">æ•°å€¤è¨ˆç®—</a></li>
      <li><a href="http://localhost:1313/tags/%E8%AA%A4%E5%B7%AE/">èª¤å·®</a></li>
      <li><a href="http://localhost:1313/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/">ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</a></li>
      <li><a href="http://localhost:1313/tags/%E8%87%AA%E5%8B%95%E5%BE%AE%E5%88%86/">è‡ªå‹•å¾®åˆ†</a></li>
      <li><a href="http://localhost:1313/tags/%E5%8F%8C%E5%AF%BE%E6%95%B0/">åŒå¯¾æ•°</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/posts/numericaldifferentiation/">
    <span class="title">æ¬¡ã¸ Â»</span>
    <br>
    <span>æ•°å€¤å¾®åˆ†</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share è‡ªå‹•å¾®åˆ† on x"
            href="https://x.com/intent/tweet/?text=%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fautodiff%2f&amp;hashtags=Float%2cIEEE754%2c%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97%2c%e8%aa%a4%e5%b7%ae%2c%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%9f%e3%83%b3%e3%82%b0%2c%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86%2c%e5%8f%8c%e5%af%be%e6%95%b0">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="http://localhost:1313/">ungehoBlog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'ã‚³ãƒ”ãƒ¼';

        function copyingDone() {
            copybutton.innerHTML = 'ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸ!';
            setTimeout(() => {
                copybutton.innerHTML = 'ã‚³ãƒ”ãƒ¼';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script></body>

</html>
