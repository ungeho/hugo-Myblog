<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>è‡ªå‹•å¾®åˆ† | ungehoBlog</title><meta name=keywords content="Float,IEEE754,æ•°å€¤è¨ˆç®—,èª¤å·®,ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°,è‡ªå‹•å¾®åˆ†,åŒå¯¾æ•°"><meta name=description content="

ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚
1. æµ®å‹•å°æ•°ç‚¹æ•°
2. åŒºé–“æ¼”ç®—
3. æ•°å€¤ç©åˆ†
4. æ•°å€¤å¾®åˆ†
5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“


è‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚"><meta name=author content="ungeho"><link rel=canonical href=https://ungeho.netlify.app/posts/autodiff/><link crossorigin=anonymous href=/assets/css/stylesheet.4599eadb9eb2ad3d0a8d6827b41a8fda8f2f4af226b63466c09c5fddbc8706b7.css integrity="sha256-RZnq256yrT0KjWgntBqP2o8vSvImtjRmwJxf3byHBrc=" rel="preload stylesheet" as=style><link rel=icon href=https://ungeho.netlify.app/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ungeho.netlify.app/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ungeho.netlify.app/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://ungeho.netlify.app/favicon/apple-touch-icon.png><link rel=mask-icon href=https://ungeho.netlify.app/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ja href=https://ungeho.netlify.app/posts/autodiff/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.js crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/contrib/auto-render.min.js crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){window.mermaid&&mermaid.initialize({startOnLoad:!0})})</script><meta property="og:title" content="è‡ªå‹•å¾®åˆ†"><meta property="og:description" content="

ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚
1. æµ®å‹•å°æ•°ç‚¹æ•°
2. åŒºé–“æ¼”ç®—
3. æ•°å€¤ç©åˆ†
4. æ•°å€¤å¾®åˆ†
5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“


è‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚"><meta property="og:type" content="article"><meta property="og:url" content="https://ungeho.netlify.app/posts/autodiff/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-12T16:30:33+09:00"><meta property="article:modified_time" content="2025-12-12T16:30:33+09:00"><meta property="og:site_name" content="ungehoBlog"><meta name=twitter:card content="summary"><meta name=twitter:title content="è‡ªå‹•å¾®åˆ†"><meta name=twitter:description content="

ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚
1. æµ®å‹•å°æ•°ç‚¹æ•°
2. åŒºé–“æ¼”ç®—
3. æ•°å€¤ç©åˆ†
4. æ•°å€¤å¾®åˆ†
5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“


è‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ungeho.netlify.app/posts/"},{"@type":"ListItem","position":2,"name":"è‡ªå‹•å¾®åˆ†","item":"https://ungeho.netlify.app/posts/autodiff/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"è‡ªå‹•å¾®åˆ†","name":"è‡ªå‹•å¾®åˆ†","description":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°\n2. åŒºé–“æ¼”ç®—\n3. æ•°å€¤ç©åˆ†\n4. æ•°å€¤å¾®åˆ†\n5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“\nè‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚\n","keywords":["Float","IEEE754","æ•°å€¤è¨ˆç®—","èª¤å·®","ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°","è‡ªå‹•å¾®åˆ†","åŒå¯¾æ•°"],"articleBody":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°\n2. åŒºé–“æ¼”ç®—\n3. æ•°å€¤ç©åˆ†\n4. æ•°å€¤å¾®åˆ†\n5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“\nè‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚\nç‰¹ã«åŒå¯¾æ•°(Dual numbers) ã‚’ç”¨ã„ãŸæ‰‹æ³•ã§ã¯ã€å…¥åŠ›ã‚’$x+\\varepsilon$ ã¨ã—ã¦è¨ˆç®—ã™ã‚‹ã ã‘ã§ã€é–¢æ•°å€¤$f(x)$ ã¨å°é–¢æ•°$f^{\\prime}(x)$ ãŒåŒæ™‚ã«å¾—ã‚‰ã‚Œã€æ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªèª¤å·®ãŒãªã$h$ ã®é¸æŠãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚\nåŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ† åŒå¯¾æ•°ï¼ˆDual Numbersï¼‰ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã§ã¯ã€å…¥åŠ›ã‚’\n$$ \\begin{aligned} x + \\varepsilon \\end{aligned} $$\nã¨ã—ãŸã¨ãã®é–¢æ•°ã®å€¤ãŒ\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) \\end{aligned} $$\nã¨ã„ã†å½¢ã«ãªã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã¦å¾®åˆ†å€¤ã‚’å¾—ã¾ã™ã€‚\nã“ã“ã§$\\varepsilon$ã¯æ¬¡ã®æ€§è³ªã‚’ã‚‚ã¤ç‰¹åˆ¥ãªå…ƒã§ã™\n$$ \\begin{aligned} \\varepsilon \u0026\\neq 0\\\\ \\varepsilon^{2} \u0026= 0 \\end{aligned} $$\nã“ã‚Œã¯ã€Œ$\\varepsilon$ ã¯äºŒä¹—ã™ã‚‹ã¨å®Œå…¨ã«æ¶ˆãˆã‚‹ã€ã¨ã„ã†æ„å‘³ã‚’è¡¨ã—ã¾ã™ã€‚\nãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç† ã“ã“ã§ã€æ¬¡ã®ãƒ†ã‚¤ãƒ©ãƒ¼ç´šæ•°ã‚’è€ƒãˆã¾ã™ã€‚\n$$ \\begin{aligned} f(x + a) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)} (x)}{n!}(a)^{n} \\end{aligned} $$\nã«$a=\\varepsilon$ã‚’ä»£å…¥ã™ã‚‹ã¨\n$$ \\begin{aligned} f(x + \\varepsilon) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)} (x)}{n!}(\\varepsilon)^{n} \\end{aligned} $$\nã“ã‚Œã‚’å±•é–‹ã™ã‚‹ã¨\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) + \\varepsilon^{2} \\frac{f^{\\prime\\prime}(x)}{2!} +\\varepsilon^{3}\\frac{ f^{(3)}(x)}{3!} + \\dots \\end{aligned} $$\nã—ã‹ã—ã€åŒå¯¾æ•°ã®å®šç¾©ã‚ˆã‚Š\n$$ \\begin{aligned} \\varepsilon^{2} = 0 \\end{aligned} $$\nã§ã‚ã‚‹ãŸã‚ã€äºŒæ¬¡ä»¥é™ã®é …ãŒå…¨ã¦æ¶ˆãˆã¾ã™ã€‚\nã‚ˆã£ã¦\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) \\end{aligned} $$\nã¨ã„ã†éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªå½¢ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\nã“ã“ã§\nå®Ÿéƒ¨ï¼š$f(x)$ $\\varepsilon$ã®ä¿‚æ•°ï¼š$f^{\\prime}(x)$ ãŒå¾—ã‚‰ã‚Œã‚‹ãŸã‚ã€åŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§é–¢æ•°å€¤ã¨å°é–¢æ•°ãŒåŒæ™‚ã«è¨ˆç®—ã§ãã‚‹ã‚ã‘ã§ã™ã€‚\nåŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹ $$ \\begin{aligned} x + \\varepsilon y \\end{aligned} $$\nã¯2 x 2 ã®ä¸Šä¸‰è§’è¡Œåˆ—\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} \\end{aligned} $$\nã¨å…¨ãåŒã˜æŒ¯ã‚‹èˆã„ã‚’ã—ã¾ã™ã€‚\nã“ã®ã¨ãã€åŒå¯¾æ•°$\\varepsilon$ ã¯\n$$ \\varepsilon = \\begin{aligned} \\begin{pmatrix} 0 \u0026 1 \\\\ 0 \u0026 0 \\end{pmatrix} \\end{aligned} $$\nã§ã‚ã‚Šã€è¡Œåˆ—ã®ç©ã‚’ã¨ã‚‹ã¨\n$$ \\varepsilon^{2} = \\begin{aligned} \\begin{pmatrix} 0 \u0026 1 \\\\ 0 \u0026 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \u0026 1 \\\\ 0 \u0026 0 \\end{pmatrix} = \\begin{pmatrix} 0 \u0026 0 \\\\ 0 \u0026 0 \\end{pmatrix} \\end{aligned} $$\nã—ãŸãŒã£ã¦\n$$ \\begin{aligned} \\varepsilon \u0026\\neq 0\\\\ \\varepsilon^{2} \u0026= 0 \\end{aligned} $$\nã¨ã„ã†åŒå¯¾æ•°ã®æ€§è³ªãŒè¡Œåˆ—ã§æ­£ã—ãå†ç¾ã•ã‚Œã¦ã„ã¾ã™ã€‚\nå®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã¯ã€åŒå¯¾æ•°\n$$ \\begin{aligned} x + \\varepsilon y \\end{aligned} $$\nã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ã€å››å‰‡æ¼”ç®—ãªã©ã®åŸºæœ¬çš„ãªæ¼”ç®—ã‚’ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å†å®šç¾©ã™ã‚‹ ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚\nå…·ä½“çš„ã«ã¯ã€ã»ã¨ã‚“ã©è¡Œåˆ—æ¼”ç®—ã®å®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚\nä»£å…¥æ¼”ç®—å­(+=,-=,*=,/=)ã‚„ç¬¦å·-ã¯æ¼”ç®—å­ã‚’ä¸Šæ›¸ãã—ãŸå››å‰‡æ¼”ç®—ã‚’ä½¿ã£ã¦æ¼”ç®—ã—ã¾ã™ã€‚\nä¸€éƒ¨ã®ç‰¹æ®Šé–¢æ•°ã¯å®šç¾©ã—ãŸç‰¹æ®Šé–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nåŠ ç®— + $$ \\begin{aligned} \\begin{pmatrix} a \u0026 b \\\\ c \u0026 d \\end{pmatrix} + \\begin{pmatrix} e \u0026 f \\\\ g \u0026 h \\end{pmatrix} = \\begin{pmatrix} a+e \u0026 b+f \\\\ c+g \u0026 d+h \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) + (v + w \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} + \\begin{pmatrix} v \u0026 w \\\\ 0 \u0026 v \\end{pmatrix} = \\begin{pmatrix} x+v \u0026 y+w \\\\ 0 \u0026 x+v \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) + (v + w \\varepsilon) = \\begin{pmatrix} x+v \u0026 y+w \\\\ 0 \u0026 x+v \\end{pmatrix} \\end{aligned} $$\næ¸›ç®— - $$ \\begin{aligned} \\begin{pmatrix} a \u0026 b \\\\ c \u0026 d \\end{pmatrix} - \\begin{pmatrix} e \u0026 f \\\\ g \u0026 h \\end{pmatrix} = \\begin{pmatrix} a-e \u0026 b-f \\\\ c-g \u0026 d-h \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) - (v + w \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} - \\begin{pmatrix} v \u0026 w \\\\ 0 \u0026 v \\end{pmatrix} = \\begin{pmatrix} x-v \u0026 y-w \\\\ 0 \u0026 x-v \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) - (v + w \\varepsilon) = \\begin{pmatrix} x-v \u0026 y-w \\\\ 0 \u0026 x-v \\end{pmatrix} \\end{aligned} $$\nã‚¹ã‚«ãƒ©ãƒ¼å€ $$ \\begin{aligned} k(x + y \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} k \\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} = \\begin{pmatrix} kx \u0026 ky \\\\ 0 \u0026 kx \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} k(x + y \\varepsilon) = \\begin{pmatrix} kx \u0026 ky \\\\ 0 \u0026 kx \\end{pmatrix} \\end{aligned} $$\nä¹—ç®— * $$ \\begin{aligned} \\begin{pmatrix} a \u0026 b \\\\ c \u0026 d \\end{pmatrix} \\times \\begin{pmatrix} e \u0026 f \\\\ g \u0026 h \\end{pmatrix} = \\begin{pmatrix} ae + bg \u0026 af + bh \\\\ ce + dg \u0026 cf + dh \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) \\times (v + w \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} \\times \\begin{pmatrix} v \u0026 w \\\\ 0 \u0026 v \\end{pmatrix} = \\begin{pmatrix} xv \u0026 xw + yv \\\\ 0 \u0026 xv \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) \\times (v + w \\varepsilon) = \\begin{pmatrix} xv \u0026 xw + yv \\\\ 0 \u0026 xv \\end{pmatrix} \\end{aligned} $$\né€†è¡Œåˆ—(é™¤ç®— /) $$ \\begin{aligned} A = \\begin{pmatrix} a \u0026 b \\\\ c \u0026 d \\end{pmatrix}, \\qquad \\det(A) = ad - bc \\neq 0 \\end{aligned} $$\n$$ \\begin{aligned} A^{-1} = \\frac{1}{ad - bc} \\begin{pmatrix} d \u0026 -b \\\\ -c \u0026 a \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) \\div (v + w \\varepsilon) \\end{aligned} $$\nã¯$(v + w \\varepsilon)$ ã®é€†è¡Œåˆ—ã‚’æ±‚ã‚ã¦\n$$ \\begin{aligned} v^{2} \\neq 0 \\end{aligned} $$\nã‚ˆã‚Šå®Ÿéƒ¨$v \\neq 0$ ã®ã¨ã\n$$ \\begin{aligned} \u0026\\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} \\times \\frac{1}{v^{2}} \\begin{pmatrix} v \u0026 -w \\\\ 0 \u0026 v \\end{pmatrix}\\\\ = \u0026\\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} \\times \\begin{pmatrix} \\frac{1}{v} \u0026 -\\frac{w}{v^{2}} \\\\ 0 \u0026 \\frac{1}{v} \\end{pmatrix}\\\\ = \u0026\\begin{pmatrix} \\frac{x}{v} \u0026 -\\frac{xw}{v^{2}}+\\frac{y}{v} \\\\ 0 \u0026 \\frac{x}{v} \\end{pmatrix}\\\\ = \u0026\\begin{pmatrix} \\frac{x}{v} \u0026 \\frac{yv-xw}{v^{2}} \\\\ 0 \u0026 \\frac{x}{v} \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) \\div (v + w \\varepsilon) = \\begin{pmatrix} \\frac{x}{v} \u0026 \\frac{yv-xw}{v^{2}} \\\\ 0 \u0026 \\frac{x}{v} \\end{pmatrix} \\end{aligned} $$\næŒ‡æ•°é–¢æ•° ä¸ãˆã‚‰ã‚ŒãŸ$x + \\varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\exp(x + \\varepsilon y) = \\exp(x) \\times \\exp(\\varepsilon y) \\end{aligned} $$\næŒ‡æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã$\\exp(X)$ã¯\n$$ \\begin{aligned} \\exp(X) = \\sum_{k=0}^{\\infty} \\frac{X^{k}}{k!} \\end{aligned} $$\nã§ã™ã€‚\nå®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾\n$$ \\exp(x) $$\nã¨ã™ã‚‹ã€‚\nåŒå¯¾æ•°$\\varepsilon y$ ã¯$\\varepsilon^{2} = 0$ã‚ˆã‚Š$k\\ge2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§\n$$ \\begin{aligned} \\exp(\\varepsilon y) = \\sum_{k=0}^{\\infty} \\frac{(\\varepsilon y)^{k}}{k!} = 1 + \\varepsilon y \\end{aligned} $$\nã«ãªã‚‹ã€‚\nã“ã‚Œã‚’ã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} \\exp(x + \\varepsilon y) = \\exp(x) \\times (1 + \\varepsilon y) = \\exp(x) + \\varepsilon y \\exp(x) \\end{aligned} $$\nã«ãªã‚Š\n$$ \\begin{aligned} \\exp(x + \\varepsilon y) = \\begin{pmatrix} \\exp(x) \u0026 y \\exp(x) \\\\ 0 \u0026 \\exp(x) \\end{pmatrix} \\end{aligned} $$\nã§ã‚ã‚‹ã€‚\nä¸‰è§’é–¢æ•°(sin,cos) ä¸ãˆã‚‰ã‚ŒãŸ$x + \\varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\næ­£å¼¦é–¢æ•°(sin)ã®å ´åˆ $$ \\begin{aligned} \\sin(x + \\varepsilon y) = \\sin(x)\\times\\cos(\\varepsilon y) + \\cos(x) \\times \\sin(\\varepsilon y) \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã®å ´åˆ $$ \\begin{aligned} \\cos(x + \\varepsilon y) = \\cos(x)\\times\\cos(\\varepsilon y) - \\sin(x) \\times \\sin(\\varepsilon y) \\end{aligned} $$\nä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã\næ­£å¼¦é–¢æ•°(sin)ã¯ $$ \\begin{aligned} \\sin(X) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k + 1)!} X^{2k+1} \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã¯ $$ \\begin{aligned} \\cos(X) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k)!} X^{2k} \\end{aligned} $$\næŒ‡æ•°é–¢æ•°ã®æ™‚ã¨åŒã˜ã‚ˆã†ã«ã€å®Ÿéƒ¨$x$ã¯ãã®ã¾ã¾\næ­£å¼¦é–¢æ•°(sin) $$ \\sin(x) $$\nä½™å¼¦é–¢æ•°(cos) $$ \\cos(x) $$\nã¨ã™ã‚‹ã€‚\nåŒå¯¾æ•°$\\varepsilon y$ ã¯$\\varepsilon^{2} = 0$ã‚ˆã‚Š$k\\ge1$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§\næ­£å¼¦é–¢æ•°(sin)ã¯ $$ \\begin{aligned} \\sin(\\varepsilon y) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k + 1)!} (\\varepsilon y)^{2k+1}=\\varepsilon y \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã¯ $$ \\begin{aligned} \\cos(\\varepsilon y) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k)!} (\\varepsilon y)^{2k} = 1 \\end{aligned} $$\nã‚ˆã£ã¦\næ­£å¼¦é–¢æ•°(sin)ã¯ $$ \\begin{aligned} \u0026\\sin(x + \\varepsilon y)\\\\ = \u0026\\sin(x)\\times\\cos(\\varepsilon y) + \\cos(x) \\times \\sin(\\varepsilon y)\\\\ = \u0026\\sin(x) \\times 1 + \\cos(x) \\times \\varepsilon y \\\\ = \u0026\\sin(x) + \\varepsilon y \\cos(x) \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã¯ $$ \\begin{aligned} \u0026\\cos(x + \\varepsilon y)\\\\ = \u0026\\cos(x) \\times \\cos(\\varepsilon y) - \\sin(x) \\times \\sin(\\varepsilon y)\\\\ = \u0026\\cos(x) \\times 1 - \\sin(x) \\times \\varepsilon y\\\\ = \u0026\\cos(x) - \\varepsilon y \\sin(x) \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\næ­£å¼¦é–¢æ•°(sin) $$ \\begin{aligned} \\sin(x + \\varepsilon y) = \\begin{pmatrix} \\sin(x) \u0026 y \\cos(x) \\\\ 0 \u0026 \\sin(x) \\end{pmatrix} \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos) $$ \\begin{aligned} \\cos(x + \\varepsilon y) = \\begin{pmatrix} \\cos(x) \u0026 - y \\sin(x) \\\\ 0 \u0026 \\cos(x) \\end{pmatrix} \\end{aligned} $$\nä¸‰è§’é–¢æ•°(tan) $$ \\begin{aligned} \\tan(x + y \\varepsilon) = \\frac{\\sin(x + y\\varepsilon)}{\\cos(x + y\\varepsilon)} \\end{aligned} $$\nã«ã‚ˆã‚Šã€ä¸‰è§’é–¢æ•°(sin,cos)ã¨ä¹—ç®—ã¨é€†è¡Œåˆ—(é™¤ç®—)ã‚’å®Ÿè£…ã—ã¦ã€ãã‚Œã‚‰ã‚’åˆ©ç”¨ã“ã¨ã§æ¼”ç®—å¯èƒ½ã«ãªã‚‹ã€‚\nå¯¾æ•°é–¢æ•°(log) ä¸ãˆã‚‰ã‚ŒãŸ$x + \\varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\n$$ \\begin{aligned} x + y \\varepsilon = x \\times \\left(1 + \\frac{y \\varepsilon}{x} \\right) \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} \\log \\left( x \\times \\left( 1 + \\frac{y \\varepsilon}{x} \\right) \\right) = \\log(x) + \\log \\left(1 + \\frac{y \\varepsilon} {x} \\right) \\end{aligned} $$\nå¯¾æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$1 + X$ã¨ã—ãŸã¨ã$\\log(1 + X)$ã¯\n$$ \\begin{aligned} \\log(1 + X) = \\sum_{k=1}^{\\infty} \\frac{(-1)^{k+1}}{k} X^{k} \\end{aligned} $$\nã§ã™ã€‚\nå®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾\n$$ \\begin{aligned} \\log(x) \\end{aligned} $$\nã¨ã™ã‚‹ã€‚ åŒå¯¾æ•°$ \\left(1 + \\frac{y \\varepsilon}{x} \\right)$ ã¯$\\varepsilon^{2} = 0$ã‚ˆã‚Š$k \\ge 2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§\n$$ \\begin{aligned} \\log \\left(1 + \\frac{y \\varepsilon}{x} \\right) = \\sum_{k=1}^{\\infty} \\frac{(-1)^{k+1}}{k} \\left( \\frac{y \\varepsilon}{x} \\right) ^{k} = \\frac{y \\varepsilon}{x} \\end{aligned} $$\nã‚ˆã£ã¦\n$$ \\begin{aligned} \\log \\left( x \\times \\left(1 + \\frac{y \\varepsilon}{x} \\right) \\right) = \\log(x) + \\frac{y \\varepsilon}{x} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} \\log(x + y \\varepsilon) = \\begin{pmatrix} \\log(x) \u0026 \\frac{y}{x} \\\\ 0 \u0026 \\log(x) \\end{pmatrix} \\end{aligned} $$\nç´¯ä¹—ï¼ˆpowerï¼‰ åŒå¯¾æ•°ã®ç´¯ä¹— $X^n$ ã‚’è¨ˆç®—ã™ã‚‹å ´åˆï¼ŒæŒ‡æ•° $n$ ãŒæ•´æ•°ã‹éæ•´æ•°ã‹ã§æ‰±ã„ãŒç•°ãªã‚Šã¾ã™ã€‚\n1. $n$ãŒæ•´æ•°ã®å ´åˆï¼ˆæ•´æ•°ä¹—ï¼‰\n$n = 0$ã®ã¨ã $$ \\begin{aligned} X^{0} = I \\end{aligned} $$\nï¼ˆå˜ä½è¡Œåˆ—ã‚’è¿”ã™ï¼‰\n$n \u003e 0$ã®ã¨ã $$ \\begin{aligned} X^n = \\underbrace{X X \\cdots X}_{n\\ \\text{å›}} \\end{aligned} $$\nï¼ˆåå¾©ä¹—ç®—ï¼‰\n$n \u003c 0$ ã®ã¨ã $$ \\begin{aligned} X^n = (X^{-1})^{|n|} \\end{aligned} $$\nï¼ˆé€†è¡Œåˆ—ã‚’ä½¿ã£ã¦æ­£ã®æŒ‡æ•°ã¨åŒæ§˜ã«è¨ˆç®—ï¼‰\n2. $n$ ãŒå®Ÿæ•°ã®ã¨ãï¼ˆå®Ÿæ•°ä¹—ãƒ»éæ•´æ•°æŒ‡æ•°ï¼‰\nã¾ãšæ¡ä»¶ã¨ã—ã¦ã€åŒå¯¾æ•°\n$$ \\begin{aligned} X = x + y\\varepsilon \\end{aligned} $$\nã®å®Ÿéƒ¨ $x$ ãŒ$0$ã‚ˆã‚Šå¤§ãã„å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã™ãªã‚ã¡ã€æŒ‡æ•° $n$ ãŒå®Ÿæ•°\n$$ \\begin{aligned} n \\in \\mathbb{R} \\end{aligned} $$\nã§ã‚ã‚‹å ´åˆã€åŒå¯¾æ•° $X$ ã¯\n$$ \\begin{aligned} X = x + y\\varepsilon,\\qquad x \u003e 0 \\end{aligned} $$\nã‚’æº€ãŸã•ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚\nã“ã‚Œã¯ã€å®Ÿæ•°ã«ãŠã‘ã‚‹ç´¯ä¹—\n$$ \\begin{aligned} x^n = \\exp(n\\log x) \\end{aligned} $$\nãŒ $x\u003e0$ ã®ã‚‚ã¨ã§å®šç¾©ã•ã‚Œã‚‹ã“ã¨ã¨å®Œå…¨ã«ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚\nä¸€èˆ¬ã®å®Ÿæ•°æŒ‡æ•° $n$ ã«å¯¾ã—ã¦ã¯ï¼ŒæŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ä½¿ã£ã¦\n$$ \\begin{aligned} X^n = \\exp\\bigl(n \\log X\\bigr) \\end{aligned} $$\nã¨å®šç¾©ã—ã¾ã™ã€‚\nã“ã‚Œã¯å®Ÿæ•°ã®ä¸–ç•Œã«ãŠã‘ã‚‹å®šç¾©\n$$ \\begin{aligned} x^n = \\exp\\bigl(n\\log x\\bigr) \\end{aligned} $$\nã®è¡Œåˆ—ç‰ˆã§ã™ã€‚\nåŒå¯¾æ•°ã¯è¡Œåˆ—ã§è¡¨ã›ã‚‹ã®ã§\nlog(X)ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®å¯¾æ•°ï¼‰ exp(n log(X))ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®æŒ‡æ•°ï¼‰ ãŒã™ã¹ã¦è¨ˆç®—å¯èƒ½ã«ãªã‚Šã€ä»»æ„å®Ÿæ•°æŒ‡æ•°ã®ç´¯ä¹—ã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚\nå¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰ å¹³æ–¹æ ¹ã¯ç´¯ä¹—ã®ç‰¹åˆ¥ãªå ´åˆã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚\nã™ãªã‚ã¡\n$$ \\begin{aligned} \\sqrt{X} = X^{\\frac{1}{2}} \\end{aligned} $$\nãŸã ã—ã€åŒå¯¾æ•° $X$ ã®å®Ÿéƒ¨ãŒ$0$ã‚ˆã‚Šå¤§ãã„ã“ã¨ã€‚ã¤ã¾ã‚Š\n$$ \\begin{aligned} X = x + y\\varepsilon,\\qquad x \u003e 0 \\end{aligned} $$\nã‚’æº€ãŸã™ã“ã¨ãŒæ¡ä»¶ã§ã™ã€‚\nå‰ç¯€ã§å®šç¾©ã—ãŸç´¯ä¹—æ¼”ç®— $X^n$ ã‚’æŒ‡æ•° $n = \\frac{1}{2}$ ã¨ã—ã¦è©•ä¾¡ã™ã‚Œã°å¹³æ–¹æ ¹ãŒè¨ˆç®—ã§ãã¾ã™ã€‚\nè¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹ åŒå¯¾æ•°ã®è¡Œåˆ—è¡¨ç¾\n$$ \\begin{aligned} X = \\begin{pmatrix} x \u0026 y \\\\ 0 \u0026 x \\end{pmatrix} ,\\qquad x \u003e 0 \\end{aligned} $$\nã«å¯¾ã—ã¦ã¯ï¼Œ\n$$ \\begin{aligned} \\sqrt{X} = \\begin{pmatrix} \\sqrt{x} \u0026 \\frac{y}{2\\sqrt{x}} \\\\ 0 \u0026 \\sqrt{x} \\end{pmatrix} \\end{aligned} $$\nã¨ãªã‚Šï¼Œã“ã‚Œã¯é€šå¸¸ã®å¹³æ–¹æ ¹ã®å¾®åˆ†æ³•å‰‡\n$$ \\begin{aligned} \\frac{d}{dx} \\sqrt{x} = \\frac{1}{2\\sqrt{x}} \\end{aligned} $$\nã¨ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚\nå®Ÿè£…ä¸Šã®å‡¦ç† $n = \\frac{1}{2}$ ã¨ã—ã¦ç´¯ä¹—æ¼”ç®— pow(X, n) ã‚’å‘¼ã³å‡ºã™ã ã‘ã§ã‚ˆã„ ç´¯ä¹—ã®ç¯€ã§ç¤ºã—ãŸã‚ˆã†ã« æŒ‡æ•°$n$ãŒæ•´æ•°ã‹ã©ã†ã‹ã‚’åˆ¤å®š éæ•´æ•°ã®å ´åˆã¯ã€å®Ÿéƒ¨ãŒ$0$ã‚ˆã‚Šå¤§ãã„ã‹$(x \u003e 0)$ã‚’åˆ¤å®š å®Ÿéƒ¨ãŒ0ã‚ˆã‚Šå¤§ãã„ã®ã§ã‚ã‚Œã°ã€æŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ç”¨ã„ã¦\n$$ \\begin{aligned} \\sqrt{X} = X^{\\frac{1}{2}} = \\exp \\left(\\frac{1}{2} \\log X\\right) \\end{aligned} $$ ã®å½¢ã§å‡¦ç†ã•ã‚Œã‚‹ ã“ã‚Œã«ã‚ˆã‚Šï¼ŒåŒå¯¾æ•°ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹ãŒè‡ªç„¶ã«è¨ˆç®—ã§ãã¾ã™ã€‚\nPython-FLINTã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ† ã“ã‚Œã¯ã€arb-FLINTã®arbã§åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ãŸç²¾åº¦ä¿è¨¼ä»˜ãã®è‡ªå‹•å¾®åˆ†ã§ã™ã€‚\nã“ã“ã§ã¯ åŒå¯¾æ•°ã®$ 2 \\times 2$ è¡Œåˆ—ã«ã‚ˆã‚‹è¡¨ç¾ã¯ä½¿ã‚ãš (å€¤, å¾®åˆ†) ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¼”ç®—ã§ä¼æ’­ã•ã›ã‚‹ã“ã¨ã§è‡ªå‹•å¾®åˆ†ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚\nfrom flint import arb, ctx def require_pos(v: arb, *, what=\"x\"): \"\"\" v ãŒã€ç¢ºå®Ÿã«æ­£ã€ã§ã‚ã‚‹ã“ã¨ã‚’è¦æ±‚ã™ã‚‹ã€‚ ï¼ˆåŒºé–“ãŒ 0 ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚Œã°å®šç¾©åŸŸå¤–ã¨ã—ã¦æ­¢ã‚ã‚‹ï¼‰ \"\"\" try: if v \u003e 0: return except TypeError: pass raise ValueError( f\"{what} must be strictly positive (interval must not include 0). got {v}\") class DualArb: \"\"\" Dual number over Arb: x + eps * dx (eps^2 = 0) val: arb â€” å®Ÿæ•°éƒ¨ x der: arb â€” å¾®åˆ†å€¤ dx \"\"\" __slots__ = (\"val\", \"der\") def __init__(self, val=0, der=0): self.val = arb(val) self.der = arb(der) # --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ --- @staticmethod def lift(x): \"\"\"ã‚¹ã‚«ãƒ©ãƒ¼ or DualArb ã‚’ DualArb ã«æŒã¡ä¸Šã’ã‚‹ã€‚\"\"\" if isinstance(x, DualArb): return x return DualArb(x, 0) def copy(self): return DualArb(self.val, self.der) def __repr__(self): return f\"DualArb(val={self.val}, der={self.der})\" # --- å››å‰‡æ¼”ç®— --- def __add__(self, other): other = DualArb.lift(other) return DualArb(self.val + other.val, self.der + other.der) __radd__ = __add__ def __sub__(self, other): other = DualArb.lift(other) return DualArb(self.val - other.val, self.der - other.der) def __rsub__(self, other): other = DualArb.lift(other) return DualArb(other.val - self.val, other.der - self.der) def __neg__(self): return DualArb(-self.val, -self.der) def __mul__(self, other): other = DualArb.lift(other) # (x + eps dx)(y + eps dy) = xy + eps (x dy + y dx) val = self.val * other.val der = self.val * other.der + self.der * other.val return DualArb(val, der) __rmul__ = __mul__ def __truediv__(self, other): other = DualArb.lift(other) # (x + eps dx) / (y + eps dy) # = (x / y) + eps * ( (dx*y - x*dy) / y^2 ) inv = 1 / other.val val = self.val * inv der = (self.der * other.val - self.val * other.der) * (inv * inv) return DualArb(val, der) def __rtruediv__(self, other): # (a) / (x + eps dx) other = DualArb.lift(other) inv = 1 / self.val val = other.val * inv der = (other.der * self.val - other.val * self.der) * (inv * inv) return DualArb(val, der) # --- ç´¯ä¹— --- def __pow__(self, n): \"\"\" (x + eps dx)^n - n ãŒ intï¼ˆæ•´æ•°ï¼‰ãªã‚‰ã€é€šå¸¸ã®æ•´æ•°ä¹—ã¨ã—ã¦æ‰±ã† - ãã‚Œä»¥å¤–ï¼ˆå®Ÿæ•°æŒ‡æ•°ï¼‰ã¯ x\u003e0 ã‚’è¦æ±‚ï¼ˆå®Ÿæ•°ã® log ãŒå¿…è¦ï¼‰ \"\"\" if isinstance(n, DualArb): raise TypeError(\"DualArb ** DualArb ã¯æœªå®Ÿè£…ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼æŒ‡æ•°ã ã‘å¯¾å¿œï¼‰ã€‚\") # --- 1) æ•´æ•°æŒ‡æ•°ï¼ˆPython intï¼‰ --- if isinstance(n, int): if n == 0: # (x + eps dx)^0 = 1, å¾®åˆ†ã¯ 0 return DualArb(1, 0) if n \u003c 0: # 0 ã®è² æ•´æ•°ä¹—ã¯ä¸å¯ # arb ã®ã€Œ0ã¨ç­‰ã—ã„ã€åˆ¤å®šã¯æ›–æ˜§ã«ãªã‚Šå¾—ã‚‹ã®ã§å®‰å…¨å´ã«å€’ã™ try: if self.val == 0: raise ZeroDivisionError(\"0 ã®è² æ•´æ•°ä¹—ã¯å®šç¾©ã§ãã¾ã›ã‚“ã€‚\") except TypeError: # 0 ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚‹åŒºé–“ãªã‚‰ã‚¢ã‚¦ãƒˆ raise ZeroDivisionError(\"0 ã‚’å«ã‚€åŒºé–“ã®è² æ•´æ•°ä¹—ã¯å®šç¾©ã§ãã¾ã›ã‚“ã€‚\") val = self.val ** n der = arb(n) * (self.val ** (n - 1)) * self.der return DualArb(val, der) # --- 2) éæ•´æ•°æŒ‡æ•°ï¼ˆå®Ÿæ•°æŒ‡æ•°ï¼‰ --- n_arb = arb(n) # å®Ÿæ•°ã¨ã—ã¦ã® x^n ã‚’ exp(n log x) ã§å®šç¾©ã™ã‚‹ã®ã§ x\u003e0 ãŒå¿…è¦ require_pos(self.val, what=\"pow real-part (non-integer exponent)\") val = self.val ** n_arb der = n_arb * (self.val ** (n_arb - 1)) * self.der return DualArb(val, der) def __rpow__(self, base): \"\"\" base ** (x + eps dx) = exp((x + eps dx) * log(base)) \"\"\" base_arb = arb(base) if base_arb \u003c= 0: raise ValueError(\"base ã¯æ­£ã®å®Ÿæ•°ã«ã—ã¦ã­ï¼ˆlog ãŒå¿…è¦ã«ãªã‚‹ã®ã§ï¼‰ã€‚\") # f(x) = base^x, f'(x) = base^x * log(base) val = base_arb ** self.val der = val * self.der * base_arb.log() return DualArb(val, der) # --- elementary functions on DualArb --- def dual_exp(x): \"\"\" exp(x + eps dx) = exp(x) + eps * dx * exp(x) \"\"\" x = DualArb.lift(x) v = x.val.exp() return DualArb(v, x.der * v) def dual_log(x): \"\"\" log(x + eps dx) = log(x) + eps * dx / x å®šç¾©åŸŸï¼ˆå®Ÿæ•°ï¼‰ï¼šå®Ÿéƒ¨ãŒ strictly positive \"\"\" x = DualArb.lift(x) require_pos(x.val, what=\"log real-part\") return DualArb(x.val.log(), x.der / x.val) def dual_sin(x): \"\"\" sin(x + eps dx) = sin(x) + eps * dx * cos(x) \"\"\" x = DualArb.lift(x) return DualArb(x.val.sin(), x.der * x.val.cos()) def dual_cos(x): \"\"\" cos(x + eps dx) = cos(x) - eps * dx * sin(x) \"\"\" x = DualArb.lift(x) return DualArb(x.val.cos(), -x.der * x.val.sin()) def dual_tan(x): \"\"\" tan = sin / cos ã§å®Ÿè£…ï¼ˆå®‰ç›´ç‰ˆï¼‰ \"\"\" return dual_sin(x) / dual_cos(x) def dual_sqrt(x): \"\"\" sqrt(x + eps dx) = sqrt(x) + eps * dx / (2 * sqrt(x)) å®šç¾©åŸŸï¼ˆå®Ÿæ•°ï¼‰ï¼šå®Ÿéƒ¨ãŒ strictly positive \"\"\" x = DualArb.lift(x) require_pos(x.val, what=\"sqrt real-part\") v = x.val.sqrt() return DualArb(v, x.der / (2 * v)) def differentiate(f, x0, dps=50): ctx.dps = dps x = DualArb(x0, 1) y = f(x) if not isinstance(y, DualArb): y = DualArb.lift(y) return y.val, y.der if __name__ == \"__main__\": from flint import arb # f(x) ã‚’ DualArb ã§æ›¸ã def f(x: DualArb) -\u003e DualArb: # f(x) = x^3 + 2 * sin(x) * exp(x) return x**3 + 2 * dual_sin(x) * dual_exp(x) # xã®å€¤ã¨ç²¾åº¦ã‚’å…¥åŠ› val, der = differentiate(f, x0=2, dps=80) # çµæœå‡ºåŠ› print(\"-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› -------------------\") print(\"f(x) =\", val) print(\"f'(x) =\", der) # ã“ã“ã‹ã‚‰ã¯æ¤œç®—ç”¨ï¼ˆæ™®é€šã®arbã§è¨ˆç®—ï¼‰ # æ¤œç®—ç”¨ã® x ã® å€¤ã‚’arbã§å…¥åŠ› x = arb(2) f_exact = x**3 + 2 * x.sin() * x.exp() # f'(x) = 3x^2 + 2[cos x * e^x + sin x * e^x] fprime_exact = 3 * x**2 + 2 * (x.cos() * x.exp() + x.sin() * x.exp()) # æ¤œç®—å‡ºåŠ› print(\"-------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› ---------------------\") print(\"f(x) (exact-like) =\", f_exact) print(\"f'(x) (exact-like) =\", fprime_exact) å®Ÿè¡Œçµæœ\n-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› ------------------- f(x) = [21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79] f'(x) = [19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79] -------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› --------------------- f(x) (exact-like) = [21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79] f'(x) (exact-like) = [19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79] Arbãƒ©ã‚¤ãƒ–ãƒ©ãƒª(C++)ã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ† åŒå¯¾æ•°ã«ã‚ˆã‚‹å¾®åˆ†ã¯ã€$\\varepsilon^2 = 0$ ã‚’æº€ãŸã™å…ƒ $\\varepsilon$ ã‚’ç”¨ã„ã¦\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) \\end{aligned} $$\nã¨è¡¨ã•ã‚Œã¾ã™ã€‚\nã“ã‚Œã‚’\n$$ \\begin{aligned} x + \\varepsilon = \\begin{pmatrix} x \u0026 1 \\\\ 0 \u0026 x \\end{pmatrix} \\end{aligned} $$\nã¨ã„ã† $2 \\times 2$ ä¸Šä¸‰è§’è¡Œåˆ—ã¨ã—ã¦è¡¨ç¾ã—ï¼Œ Arb ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã¦ 1 éšã®è‡ªå‹•å¾®åˆ†ã‚’ ç²¾åº¦ä¿è¨¼ä»˜ãã§å®Ÿè£…ã—ãŸä¾‹ã¯ï¼Œæ¬¡ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚\nğŸ“¦åŒå¯¾æ•°ã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†\nPythonç‰ˆã§ã¯ãªãœè¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã—ãªã‹ã£ãŸã‹ C++ç‰ˆã§ã¯åŒå¯¾æ•°$x+\\varepsilon$ã‚’\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026 \\varepsilon \\\\ 0 \u0026 x \\end{pmatrix} \\end{aligned} $$\nã¨ã„ã† $2\\times2$ ä¸Šä¸‰è§’è¡Œåˆ—ã§è¡¨ç¾ã—ã€è¡Œåˆ—ç©ã«ã‚ˆã£ã¦å¾®åˆ†ã‚’è‡ªå‹•çš„ã«ä¼æ’­ã•ã›ã¦ã„ã‚‹ã€‚\nä¸€æ–¹ã€Python ç‰ˆã§ã¯ã“ã®è¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã›ãšã€(å€¤, å¾®åˆ†å€¤) ã‚’æ˜ç¤ºçš„ã«ä¿æŒã™ã‚‹è‡ªå‹•å¾®åˆ†ã®å®Ÿè£…ã‚’é¸æŠã—ãŸã€‚\nãã®ç†ç”±ã¯ä¸»ã«æ¬¡ã®ç‚¹ã«ã‚ã‚‹ã€‚\n1.Pythonã§ã¯è¡Œåˆ—æ¼”ç®—ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„ arb_matã‚’ç”¨ã„ãŸè¡Œåˆ—æ¼”ç®—ã¯ã€ã‚¹ã‚«ãƒ©ãƒ¼arbã®æ¼”ç®—ã¨æ¯”ã¹ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„ã€‚\nåŒå¯¾æ•°ã«ã‚ˆã‚‹1éšå¾®åˆ†ã§ã¯æœ¬è³ªçš„ã«\nå€¤ã€€ï¼š$x$ å¾®åˆ†å€¤ï¼š$dx$ ã®2ã¤ã®ã‚¹ã‚«ãƒ©ãƒ¼ã ã‘ã‚’æ‰±ãˆã°ååˆ†ã§ã‚ã‚Šã€å¸¸ã«$2 \\times 2$ è¡Œåˆ—ã‚’æ§‹æˆãƒ»æ¼”ç®—ã™ã‚‹å¿…è¦ãŒãªã„ã€‚\nPythonã§ã¯ã“ã®å·®ãŒç‰¹ã«é¡•è‘—ã«ãªã‚‹ãŸã‚ã€ã‚¹ã‚«ãƒ©ãƒ¼2å€‹ã‚’ç›´æ¥ä¼æ’­ã•ã›ã‚‹æ–¹ãŒå®Ÿç”¨çš„ã€‚\n2.è¡Œåˆ—é–¢æ•°ã¯ã€Œå¿…è¦ä»¥ä¸Šã«ä¸€èˆ¬çš„ã€ arb_mat_expã‚„arb_mat_logãªã©ã®è¡Œåˆ—é–¢æ•°ã¯ã€ä¸€èˆ¬è¡Œåˆ—ã‚’å¯¾è±¡ã¨ã—ãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚\nã—ã‹ã—åŒå¯¾æ•°ã«å¯¾å¿œã™ã‚‹è¡Œåˆ—ã¯å¸¸ã«\nä¸Šä¸‰è§’è¡Œåˆ— ç‰¹æ®Šãªå†ªé›¶æ§‹é€ $(\\varepsilon^{2} = 0)$ ã‚’æŒã¡ã¾ã™ã€‚\nã“ã®ç‰¹æ®Šæ§‹é€ ã‚’ç”Ÿã‹ã™ãªã‚‰\n$$ \\begin{aligned} \\exp(x + \\epsilon) = \\exp(x) + \\varepsilon \\exp(x) \\end{aligned} $$\nã®ã‚ˆã†ãªç°¡æ½”ãªå¼ã§ååˆ†ã§ã€ä¸€èˆ¬è¡Œåˆ—ã®åˆç­‰é–¢æ•°ã‚’è¨ˆç®—ã™ã‚‹ã®ã¯éå‰°ã§ã™ã€‚\nPythonç‰ˆã§ã¯ã€åŒå¯¾æ•°ã¨ã—ã¦å¿…è¦ãªå¾®åˆ†å‰‡ã®ã¿ã‚’æ˜ç¤ºçš„ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€è¨ˆç®—ã¨å®Ÿè£…ã®ä¸¡é¢ã§ç°¡æ½”ã•ã‚’ä¿ã£ã¦ã„ã¾ã™ã€‚\n3.æ‹¡å¼µæ€§(é«˜éšå¾®åˆ†)ã¨ã®ç›¸æ€§ 1éšã®ã‚¹ã‚«ãƒ©ãƒ¼å¾®åˆ†ã«é™ã‚Œã°ã€$2 \\times 2$ã®è¡¨ç¾ã¯éå¸¸ã«æœ‰åŠ¹ã§ã™ã€‚\nã—ã‹ã—é«˜éšå¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹å ´åˆã€è¡Œåˆ—ã‚µã‚¤ã‚ºã‚„æ§‹é€ ã¯æ€¥é€Ÿã«è¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚\nãŸã¨ãˆã°ã€$(n \\ge 2)$ã¨ã—ã¦ $n$éšå¾®åˆ†(é«˜éšå¾®åˆ†)ã¸ã®æ‹¡å¼µ ã‚’è¡Œã†å ´åˆã€ è¶…åŒå¯¾æ•°(Hyper Dual Numbers) ã‚’ç”¨ã„ã‚‹æ–¹æ³•ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚\nã—ã‹ã—ã€$n$éšå¾®åˆ†ã‚’è¶…åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹å ´åˆ\nè¡Œåˆ—ã‚µã‚¤ã‚ºï¼š$2^{n} \\times 2^{n}$ è¡Œåˆ—ã®æ•°ã€€ï¼š$2^{n-1}$å€‹ ã®ã‚ˆã†ã«ã€æ€¥é€Ÿã«ã‚µã‚¤ã‚ºã‚„æ•°ãŒå¢—ãˆã¦ã„ãã€æ§‹é€ ã‚‚è¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚\nPythonç‰ˆã®(val, der)å½¢å¼ã¯\nderã‚’ã•ã‚‰ã«dualã«ã™ã‚Œã°é«˜éšã«å¯¾å¿œ ã¨ã„ã£ãŸã‚ˆã†ãªæ‹¡å¼µãŒè‡ªç„¶ã§ã‚ã‚Šã€è‡ªå‹•å¾®åˆ†ã®ä¸€èˆ¬çš„ãªè¨­è¨ˆã¨è¦ªå’Œæ€§ãŒé«˜ã„ã¨æ€ã„ã¾ã™ã€‚\n4.è¡¨ç¾ã®é•ã„ã§ã‚ã£ã¦ã€æœ¬è³ªã¯åŒã˜ ãªãŠã€Pythonç‰ˆãŒè¡Œåˆ—è¡¨ç¾ã‚’ç”¨ã„ãªã„ã‹ã‚‰ã¨ã„ã£ã¦ã€åŒå¯¾æ•°ãã®ã‚‚ã®ã‚’ä½¿ã£ã¦ã„ãªã„ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n(å€¤, å¾®åˆ†å€¤)ã‚’æ¼”ç®—ã”ã¨ã«ä¼æ’­ã•ã›ã‚‹æ–¹æ³•ã¯\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) \\end{aligned} $$\nã‚’å†…éƒ¨çš„ã«æ‰±ã£ã¦ã„ã‚‹ã®ã¨ç­‰ä¾¡ã§ã™ã€‚\nã“ã‚Œã¯å®Ÿè£…ä¸Šã®è¡¨ç¾ã®é•ã„ã§ã‚ã‚Šã€æ•°å­¦çš„ãªæ„å‘³ã§ã®è‡ªå‹•å¾®åˆ†ã®æœ¬è³ªã¯C++ç‰ˆã¨å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚\nã¾ã¨ã‚ã‚‹ã¨\nPythonç‰ˆ\n(å€¤, å¾®åˆ†å€¤)ã‚’æ˜ç¤ºçš„ã«ä¼æ’­ã—ã€è»½é‡ã§æ‹¡å¼µã—ã‚„ã™ã„å®Ÿè£…ã‚’æ¡ç”¨ C++ç‰ˆ\nè¡Œåˆ—è¡¨ç¾ã«ã‚ˆã‚‹åŒå¯¾æ•°ã‚’æ´»ã‹ã—ã€Arbã®è¡Œåˆ—æ¼”ç®—ã§è‡ªå‹•å¾®åˆ†ã‚’å®Ÿè£… ä¸¡è€…ã¯ç•°ãªã‚‹å®Ÿè£…æˆ¦ç•¥ã‚’å–ã£ã¦ã„ã¾ã™ãŒã€ã„ãšã‚Œã‚‚åŒå¯¾æ•°ã«åŸºã¥ãè‡ªå‹•å¾®åˆ†ã¨ã„ã†ç‚¹ã§æœ¬è³ªçš„ã«åŒã˜ã§ã™ã€‚\nã¾ã¨ã‚ æœ¬è¨˜äº‹ã§ã¯ã€åŒå¯¾æ•°ï¼ˆDual numbersï¼‰ ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã®ä»•çµ„ã¿ã«ã¤ã„ã¦\nåŒå¯¾æ•°ã®å®šç¾©ã¨ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŸç† åŒå¯¾æ•°ã‚’ 2Ã—2 ä¸Šä¸‰è§’è¡Œåˆ—è¡¨ç¾ã«è½ã¨ã—è¾¼ã‚€æ–¹æ³• å››å‰‡æ¼”ç®—ï¼ˆåŠ ç®—ãƒ»æ¸›ç®—ãƒ»ä¹—ç®—ãƒ»é™¤ç®—ï¼‰ã®å…·ä½“çš„ãªå¼ exp, log, sin, cos, tan, ç´¯ä¹—ï¼Œå¹³æ–¹æ ¹ã¨ã„ã£ãŸåˆç­‰é–¢æ•°ã®æ‹¡å¼µæ–¹æ³• ãã‚Œã‚‰ã‚’åœŸå°ã«ã—ãŸå®Ÿè£…ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ã¨ã„ã£ãŸæµã‚Œã§æ•´ç†ã—ã¾ã—ãŸã€‚\nåŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§\né–¢æ•°å€¤ $f(x)$ ã¨å°é–¢æ•° $f^{\\prime}(x)$ ã‚’ 1 å›ã®è©•ä¾¡ã§åŒæ™‚ã«å¾—ã‚‰ã‚Œã‚‹ å·®åˆ†å¹… $h$ ã®èª¿æ•´ãŒä¸è¦ã§ï¼Œæ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚µã‚¤ã‚ºèµ·å› ã®èª¤å·®ãŒãªã„ å®Ÿè£…ã¯ã€Œã„ã¤ã‚‚ã®å®Ÿæ•°æ¼”ç®—ã€ã‚’ãã®ã¾ã¾åŒå¯¾æ•°ï¼ˆè¡Œåˆ—ï¼‰ã«æ‹¡å¼µã™ã‚‹ã ã‘ ã¨ã„ã£ãŸåˆ©ç‚¹ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\nã•ã‚‰ã«ï¼ŒPython-FLINT ã® arb å‹ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ï¼Œ\nå®Ÿæ•°éƒ¨ãƒ»å¾®åˆ†å€¤ã®ã©ã¡ã‚‰ã‚‚ ã€ŒçœŸå€¤ã‚’å«ã‚€åŒºé–“ã€ ã¨ã—ã¦è¡¨ç¾ã§ãã‚‹ ä¸¸ã‚èª¤å·®ã‚’å«ã‚ãŸ ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ† ãŒå®Ÿç¾ã§ãã‚‹ ã¨ã„ã†ã¨ã“ã‚ã¾ã§åˆ°é”ã—ã¾ã—ãŸã€‚\næ•°å€¤å¾®åˆ†ãƒ»è‡ªå‹•å¾®åˆ†ã‚’ä¸¦ã¹ã¦è¦‹ãŸã¨ã\næ•°å€¤å¾®åˆ†ï¼šå®Ÿè£…ã¯ç°¡å˜ã ãŒï¼Œèª¤å·®ã¨ $h$ ã®é¸ã³æ–¹ã«æ‚©ã¾ã•ã‚Œã‚‹ è‡ªå‹•å¾®åˆ†ï¼šç²¾åº¦ä¿è¨¼ã«ã¯åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§è‰¯ã„ ã¨ã„ã†æ€§è³ªã®é•ã„ãŒã‚ã‚Šã€ã¨ã¦ã‚‚æ°—æŒã¡ã®ã‚ˆã„æ‰‹æ³•ã ã¨æ„Ÿã˜ã¦ã‚‚ã‚‰ãˆãŸã‚‰å¬‰ã—ã„ã§ã™ã€‚\nç‰¹ã«ã€åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§ç²¾åº¦ãŒä¿è¨¼ã•ã‚Œã‚‹(æ•°å¼ä¸Šã®èª¤å·®ãŒãªã„) ã¯åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã®å¤§ããªåˆ©ç‚¹ã§ã™ã€‚\n","wordCount":"6795","inLanguage":"ja","datePublished":"2025-12-12T16:30:33+09:00","dateModified":"2025-12-12T16:30:33+09:00","author":{"@type":"Person","name":"ungeho"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ungeho.netlify.app/posts/autodiff/"},"publisher":{"@type":"Organization","name":"ungehoBlog","logo":{"@type":"ImageObject","url":"https://ungeho.netlify.app/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ungeho.netlify.app/ accesskey=h title="ungehoBlog (Alt + H)">ungehoBlog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://ungeho.netlify.app/about title=About><span>About</span></a></li><li><a href=https://ungeho.netlify.app/posts title=Posts><span>Posts</span></a></li><li><a href=https://ungeho.netlify.app/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://ungeho.netlify.app/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ungeho.netlify.app/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://ungeho.netlify.app/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ungeho.netlify.app/>ãƒ›ãƒ¼ãƒ </a>&nbsp;Â»&nbsp;<a href=https://ungeho.netlify.app/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">è‡ªå‹•å¾®åˆ†</h1><div class=post-meta><span title='2025-12-12 16:30:33 +0900 JST'>2025/12/12</span>&nbsp;Â·&nbsp;14 åˆ†&nbsp;Â·&nbsp;ungeho</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>ç›®æ¬¡</span></summary><div class=inner><ul><li><a href=#%e5%8f%8c%e5%af%be%e6%95%b0%e3%82%92%e7%94%a8%e3%81%84%e3%81%9f%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86 aria-label=åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†>åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†</a><ul><li><a href=#%e3%83%86%e3%82%a4%e3%83%a9%e3%83%bc%e5%b1%95%e9%96%8b%e3%81%8b%e3%82%89%e8%a6%8b%e3%81%9f%e5%8f%8c%e5%af%be%e6%95%b0%e3%81%ae%e5%8e%9f%e7%90%86 aria-label=ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†>ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†</a></li><li><a href=#%e5%8f%8c%e5%af%be%e6%95%b0%e3%82%92%e8%a1%8c%e5%88%97%e3%81%a7%e8%a1%a8%e7%8f%be%e3%81%99%e3%82%8b aria-label=åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹>åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹</a></li><li><a href=#%e5%ae%9f%e8%a3%85%e4%b8%8a%e3%81%ae%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0 aria-label=å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ >å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a><ul><li><a href=#%e5%8a%a0%e7%ae%97- aria-label="åŠ ç®— +">åŠ ç®— +</a></li><li><a href=#%e6%b8%9b%e7%ae%97-- aria-label="æ¸›ç®— -">æ¸›ç®— -</a></li><li><a href=#%e3%82%b9%e3%82%ab%e3%83%a9%e3%83%bc%e5%80%8d aria-label=ã‚¹ã‚«ãƒ©ãƒ¼å€>ã‚¹ã‚«ãƒ©ãƒ¼å€</a></li><li><a href=#%e4%b9%97%e7%ae%97- aria-label="ä¹—ç®— *">ä¹—ç®— *</a></li><li><a href=#%e9%80%86%e8%a1%8c%e5%88%97%e9%99%a4%e7%ae%97- aria-label="é€†è¡Œåˆ—(é™¤ç®— /)">é€†è¡Œåˆ—(é™¤ç®— /)</a></li><li><a href=#%e6%8c%87%e6%95%b0%e9%96%a2%e6%95%b0 aria-label=æŒ‡æ•°é–¢æ•°>æŒ‡æ•°é–¢æ•°</a></li><li><a href=#%e4%b8%89%e8%a7%92%e9%96%a2%e6%95%b0sincos aria-label=ä¸‰è§’é–¢æ•°(sin,cos)>ä¸‰è§’é–¢æ•°(sin,cos)</a></li><li><a href=#%e4%b8%89%e8%a7%92%e9%96%a2%e6%95%b0tan aria-label=ä¸‰è§’é–¢æ•°(tan)>ä¸‰è§’é–¢æ•°(tan)</a></li><li><a href=#%e5%af%be%e6%95%b0%e9%96%a2%e6%95%b0log aria-label=å¯¾æ•°é–¢æ•°(log)>å¯¾æ•°é–¢æ•°(log)</a></li><li><a href=#%e7%b4%af%e4%b9%97power aria-label=ç´¯ä¹—ï¼ˆpowerï¼‰>ç´¯ä¹—ï¼ˆpowerï¼‰</a></li><li><a href=#%e5%b9%b3%e6%96%b9%e6%a0%b9square-root aria-label="å¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰">å¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰</a></li><li><a href=#%e8%a1%8c%e5%88%97%e8%a1%a8%e7%8f%be%e3%81%ab%e5%af%be%e3%81%99%e3%82%8b%e5%b9%b3%e6%96%b9%e6%a0%b9 aria-label=è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹>è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹</a></li><li><a href=#%e5%ae%9f%e8%a3%85%e4%b8%8a%e3%81%ae%e5%87%a6%e7%90%86 aria-label=å®Ÿè£…ä¸Šã®å‡¦ç†>å®Ÿè£…ä¸Šã®å‡¦ç†</a></li></ul></li></ul></li><li><a href=#python-flint%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%9f%e7%b2%be%e5%ba%a6%e4%bf%9d%e8%a8%bc%e4%bb%98%e3%81%8d%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86 aria-label=Python-FLINTã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†>Python-FLINTã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†</a></li><li><a href=#arb%e3%83%a9%e3%82%a4%e3%83%96%e3%83%a9%e3%83%aac%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%9f%e7%b2%be%e5%ba%a6%e4%bf%9d%e8%a8%bc%e4%bb%98%e3%81%8d%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86 aria-label=Arbãƒ©ã‚¤ãƒ–ãƒ©ãƒª(C++)ã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†>Arbãƒ©ã‚¤ãƒ–ãƒ©ãƒª(C++)ã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†</a></li><li><a href=#python%e7%89%88%e3%81%a7%e3%81%af%e3%81%aa%e3%81%9c%e8%a1%8c%e5%88%97%e8%a1%a8%e7%8f%be%e3%82%92%e6%8e%a1%e7%94%a8%e3%81%97%e3%81%aa%e3%81%8b%e3%81%a3%e3%81%9f%e3%81%8b aria-label=Pythonç‰ˆã§ã¯ãªãœè¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã—ãªã‹ã£ãŸã‹>Pythonç‰ˆã§ã¯ãªãœè¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã—ãªã‹ã£ãŸã‹</a><ul><li><a href=#1python%e3%81%a7%e3%81%af%e8%a1%8c%e5%88%97%e6%bc%94%e7%ae%97%e3%81%ae%e3%82%aa%e3%83%bc%e3%83%90%e3%83%bc%e3%83%98%e3%83%83%e3%83%89%e3%81%8c%e5%a4%a7%e3%81%8d%e3%81%84 aria-label=1.Pythonã§ã¯è¡Œåˆ—æ¼”ç®—ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„>1.Pythonã§ã¯è¡Œåˆ—æ¼”ç®—ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„</a></li><li><a href=#2%e8%a1%8c%e5%88%97%e9%96%a2%e6%95%b0%e3%81%af%e5%bf%85%e8%a6%81%e4%bb%a5%e4%b8%8a%e3%81%ab%e4%b8%80%e8%88%ac%e7%9a%84 aria-label=2.è¡Œåˆ—é–¢æ•°ã¯ã€Œå¿…è¦ä»¥ä¸Šã«ä¸€èˆ¬çš„ã€>2.è¡Œåˆ—é–¢æ•°ã¯ã€Œå¿…è¦ä»¥ä¸Šã«ä¸€èˆ¬çš„ã€</a></li><li><a href=#3%e6%8b%a1%e5%bc%b5%e6%80%a7%e9%ab%98%e9%9a%8e%e5%be%ae%e5%88%86%e3%81%a8%e3%81%ae%e7%9b%b8%e6%80%a7 aria-label=3.æ‹¡å¼µæ€§(é«˜éšå¾®åˆ†)ã¨ã®ç›¸æ€§>3.æ‹¡å¼µæ€§(é«˜éšå¾®åˆ†)ã¨ã®ç›¸æ€§</a></li><li><a href=#4%e8%a1%a8%e7%8f%be%e3%81%ae%e9%81%95%e3%81%84%e3%81%a7%e3%81%82%e3%81%a3%e3%81%a6%e6%9c%ac%e8%b3%aa%e3%81%af%e5%90%8c%e3%81%98 aria-label=4.è¡¨ç¾ã®é•ã„ã§ã‚ã£ã¦ã€æœ¬è³ªã¯åŒã˜>4.è¡¨ç¾ã®é•ã„ã§ã‚ã£ã¦ã€æœ¬è³ªã¯åŒã˜</a></li></ul></li><li><a href=#%e3%81%be%e3%81%a8%e3%82%81 aria-label=ã¾ã¨ã‚>ã¾ã¨ã‚</a></li></ul></div></details></div><div class=post-content><hr><blockquote><p>ğŸ’¡ <strong>ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚</strong><br><a href=../float><strong>1. æµ®å‹•å°æ•°ç‚¹æ•°</strong></a><br><a href=../interval><strong>2. åŒºé–“æ¼”ç®—</strong></a><br><a href=../numericalIntegration><strong>3. æ•°å€¤ç©åˆ†</strong></a><br><a href=../numericalDifferentiation><strong>4. æ•°å€¤å¾®åˆ†</strong></a><br><a href=../autoDiff><strong>5. è‡ªå‹•å¾®åˆ†</strong></a> <strong>ğŸ‘ˆ ä»Šã“ã“</strong></p></blockquote><hr><p><strong>è‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD)</strong> ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚</p><p>ç‰¹ã«<strong>åŒå¯¾æ•°(Dual numbers)</strong> ã‚’ç”¨ã„ãŸæ‰‹æ³•ã§ã¯ã€å…¥åŠ›ã‚’$x+\varepsilon$ ã¨ã—ã¦è¨ˆç®—ã™ã‚‹ã ã‘ã§ã€é–¢æ•°å€¤$f(x)$ ã¨å°é–¢æ•°$f^{\prime}(x)$ ãŒåŒæ™‚ã«å¾—ã‚‰ã‚Œã€æ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªèª¤å·®ãŒãªã$h$ ã®é¸æŠãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚</p><h2 id=åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†>åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†<a hidden class=anchor aria-hidden=true href=#åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†>#</a></h2><p>åŒå¯¾æ•°ï¼ˆDual Numbersï¼‰ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã§ã¯ã€å…¥åŠ›ã‚’</p><p>$$
\begin{aligned}
x + \varepsilon
\end{aligned}
$$</p><p>ã¨ã—ãŸã¨ãã®é–¢æ•°ã®å€¤ãŒ</p><p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x)
\end{aligned}
$$</p><p>ã¨ã„ã†å½¢ã«ãªã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã¦å¾®åˆ†å€¤ã‚’å¾—ã¾ã™ã€‚</p><p>ã“ã“ã§$\varepsilon$ã¯æ¬¡ã®æ€§è³ªã‚’ã‚‚ã¤ç‰¹åˆ¥ãªå…ƒã§ã™</p><p>$$
\begin{aligned}
\varepsilon &\neq 0\\
\varepsilon^{2} &= 0
\end{aligned}
$$</p><p>ã“ã‚Œã¯ã€Œ$\varepsilon$ ã¯äºŒä¹—ã™ã‚‹ã¨å®Œå…¨ã«æ¶ˆãˆã‚‹ã€ã¨ã„ã†æ„å‘³ã‚’è¡¨ã—ã¾ã™ã€‚</p><hr><h3 id=ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†>ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†<a hidden class=anchor aria-hidden=true href=#ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç†>#</a></h3><p>ã“ã“ã§ã€æ¬¡ã®ãƒ†ã‚¤ãƒ©ãƒ¼ç´šæ•°ã‚’è€ƒãˆã¾ã™ã€‚</p><p>$$
\begin{aligned}
f(x + a) = \sum_{n=0}^{\infty} \frac{f^{(n)} (x)}{n!}(a)^{n}
\end{aligned}
$$</p><p>ã«$a=\varepsilon$ã‚’ä»£å…¥ã™ã‚‹ã¨</p><p>$$
\begin{aligned}
f(x + \varepsilon) = \sum_{n=0}^{\infty} \frac{f^{(n)} (x)}{n!}(\varepsilon)^{n}
\end{aligned}
$$</p><p>ã“ã‚Œã‚’å±•é–‹ã™ã‚‹ã¨</p><p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x) + \varepsilon^{2} \frac{f^{\prime\prime}(x)}{2!} +\varepsilon^{3}\frac{ f^{(3)}(x)}{3!} + \dots
\end{aligned}
$$</p><p>ã—ã‹ã—ã€åŒå¯¾æ•°ã®å®šç¾©ã‚ˆã‚Š</p><p>$$
\begin{aligned}
\varepsilon^{2} = 0
\end{aligned}
$$</p><p>ã§ã‚ã‚‹ãŸã‚ã€äºŒæ¬¡ä»¥é™ã®é …ãŒå…¨ã¦æ¶ˆãˆã¾ã™ã€‚<br>ã‚ˆã£ã¦</p><p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x)
\end{aligned}
$$</p><p>ã¨ã„ã†éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªå½¢ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚<br>ã“ã“ã§</p><ul><li>å®Ÿéƒ¨ï¼š$f(x)$</li><li>$\varepsilon$ã®ä¿‚æ•°ï¼š$f^{\prime}(x)$</li></ul><p>ãŒå¾—ã‚‰ã‚Œã‚‹ãŸã‚ã€åŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§<strong>é–¢æ•°å€¤ã¨å°é–¢æ•°</strong>ãŒåŒæ™‚ã«è¨ˆç®—ã§ãã‚‹ã‚ã‘ã§ã™ã€‚</p><hr><h3 id=åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹>åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹<a hidden class=anchor aria-hidden=true href=#åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹>#</a></h3><p>$$
\begin{aligned}
x + \varepsilon y
\end{aligned}
$$</p><p>ã¯2 x 2 ã®ä¸Šä¸‰è§’è¡Œåˆ—</p><p>$$
\begin{aligned}
\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
\end{aligned}
$$</p><p>ã¨å…¨ãåŒã˜æŒ¯ã‚‹èˆã„ã‚’ã—ã¾ã™ã€‚<br>ã“ã®ã¨ãã€åŒå¯¾æ•°$\varepsilon$ ã¯</p><p>$$
\varepsilon =
\begin{aligned}
\begin{pmatrix}
0 & 1 \\
0 & 0
\end{pmatrix}
\end{aligned}
$$</p><p>ã§ã‚ã‚Šã€è¡Œåˆ—ã®ç©ã‚’ã¨ã‚‹ã¨</p><p>$$
\varepsilon^{2} =
\begin{aligned}
\begin{pmatrix}
0 & 1 \\
0 & 0
\end{pmatrix}
\times
\begin{pmatrix}
0 & 1 \\
0 & 0
\end{pmatrix}
=
\begin{pmatrix}
0 & 0 \\
0 & 0
\end{pmatrix}
\end{aligned}
$$</p><p>ã—ãŸãŒã£ã¦</p><p>$$
\begin{aligned}
\varepsilon &\neq 0\\
\varepsilon^{2} &= 0
\end{aligned}
$$</p><p>ã¨ã„ã†åŒå¯¾æ•°ã®æ€§è³ªãŒè¡Œåˆ—ã§æ­£ã—ãå†ç¾ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><h3 id=å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ >å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ <a hidden class=anchor aria-hidden=true href=#å®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ >#</a></h3><p>åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã¯ã€åŒå¯¾æ•°</p><p>$$
\begin{aligned}
x + \varepsilon y
\end{aligned}
$$</p><p>ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ã€<strong>å››å‰‡æ¼”ç®—ãªã©ã®åŸºæœ¬çš„ãªæ¼”ç®—ã‚’ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å†å®šç¾©ã™ã‚‹</strong> ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚<br>å…·ä½“çš„ã«ã¯ã€ã»ã¨ã‚“ã©è¡Œåˆ—æ¼”ç®—ã®å®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚</p><p>ä»£å…¥æ¼”ç®—å­(<code>+=</code>,<code>-=</code>,<code>*=</code>,<code>/=</code>)ã‚„ç¬¦å·<code>-</code>ã¯æ¼”ç®—å­ã‚’ä¸Šæ›¸ãã—ãŸå››å‰‡æ¼”ç®—ã‚’ä½¿ã£ã¦æ¼”ç®—ã—ã¾ã™ã€‚<br>ä¸€éƒ¨ã®ç‰¹æ®Šé–¢æ•°ã¯å®šç¾©ã—ãŸç‰¹æ®Šé–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p><hr><h4 id=åŠ ç®—->åŠ ç®— +<a hidden class=anchor aria-hidden=true href=#åŠ ç®—->#</a></h4><p>$$
\begin{aligned}
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
+
\begin{pmatrix}
e & f \\
g & h
\end{pmatrix}
=
\begin{pmatrix}
a+e & b+f \\
c+g & d+h
\end{pmatrix}
\end{aligned}
$$</p><p>ã‚ˆã‚Š</p><p>$$
\begin{aligned}
(x + y \varepsilon) + (v + w \varepsilon)
\end{aligned}
$$</p><p>ã¯</p><p>$$
\begin{aligned}
\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
+
\begin{pmatrix}
v & w \\
0 & v
\end{pmatrix}
=
\begin{pmatrix}
x+v & y+w \\
0 & x+v
\end{pmatrix}
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
(x + y \varepsilon) + (v + w \varepsilon) =
\begin{pmatrix}
x+v & y+w \\
0 & x+v
\end{pmatrix}
\end{aligned}
$$</p><hr><h4 id=æ¸›ç®—-->æ¸›ç®— -<a hidden class=anchor aria-hidden=true href=#æ¸›ç®—-->#</a></h4><p>$$
\begin{aligned}
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
-
\begin{pmatrix}
e & f \\
g & h
\end{pmatrix}
=
\begin{pmatrix}
a-e & b-f \\
c-g & d-h
\end{pmatrix}
\end{aligned}
$$</p><p>ã‚ˆã‚Š</p><p>$$
\begin{aligned}
(x + y \varepsilon) - (v + w \varepsilon)
\end{aligned}
$$</p><p>ã¯</p><p>$$
\begin{aligned}
\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
-
\begin{pmatrix}
v & w \\
0 & v
\end{pmatrix}
=
\begin{pmatrix}
x-v & y-w \\
0 & x-v
\end{pmatrix}
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
(x + y \varepsilon) - (v + w \varepsilon) =
\begin{pmatrix}
x-v & y-w \\
0 & x-v
\end{pmatrix}
\end{aligned}
$$</p><hr><h4 id=ã‚¹ã‚«ãƒ©ãƒ¼å€>ã‚¹ã‚«ãƒ©ãƒ¼å€<a hidden class=anchor aria-hidden=true href=#ã‚¹ã‚«ãƒ©ãƒ¼å€>#</a></h4><p>$$
\begin{aligned}
k(x + y \varepsilon)
\end{aligned}
$$</p><p>ã¯</p><p>$$
\begin{aligned}
k
\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
=
\begin{pmatrix}
kx & ky \\
0 & kx
\end{pmatrix}
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
k(x + y \varepsilon) =
\begin{pmatrix}
kx & ky \\
0 & kx
\end{pmatrix}
\end{aligned}
$$</p><hr><h4 id=ä¹—ç®—->ä¹—ç®— *<a hidden class=anchor aria-hidden=true href=#ä¹—ç®—->#</a></h4><p>$$
\begin{aligned}
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
\times
\begin{pmatrix}
e & f \\
g & h
\end{pmatrix}
=
\begin{pmatrix}
ae + bg & af + bh \\
ce + dg & cf + dh
\end{pmatrix}
\end{aligned}
$$</p><p>ã‚ˆã‚Š</p><p>$$
\begin{aligned}
(x + y \varepsilon) \times (v + w \varepsilon)
\end{aligned}
$$</p><p>ã¯</p><p>$$
\begin{aligned}
\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
\times
\begin{pmatrix}
v & w \\
0 & v
\end{pmatrix}
=
\begin{pmatrix}
xv & xw + yv \\
0 & xv
\end{pmatrix}
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
(x + y \varepsilon) \times (v + w \varepsilon) =
\begin{pmatrix}
xv & xw + yv \\
0 & xv
\end{pmatrix}
\end{aligned}
$$</p><hr><h4 id=é€†è¡Œåˆ—é™¤ç®—->é€†è¡Œåˆ—(é™¤ç®— /)<a hidden class=anchor aria-hidden=true href=#é€†è¡Œåˆ—é™¤ç®—->#</a></h4><p>$$
\begin{aligned}
A =
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix},
\qquad
\det(A) = ad - bc \neq 0
\end{aligned}
$$</p><p>$$
\begin{aligned}
A^{-1}
= \frac{1}{ad - bc}
\begin{pmatrix}
d & -b \\
-c & a
\end{pmatrix}
\end{aligned}
$$</p><p>ã‚ˆã‚Š</p><p>$$
\begin{aligned}
(x + y \varepsilon) \div (v + w \varepsilon)
\end{aligned}
$$</p><p>ã¯$(v + w \varepsilon)$ ã®é€†è¡Œåˆ—ã‚’æ±‚ã‚ã¦</p><p>$$
\begin{aligned}
v^{2} \neq 0
\end{aligned}
$$</p><p>ã‚ˆã‚Šå®Ÿéƒ¨$v \neq 0$ ã®ã¨ã</p><p>$$
\begin{aligned}
&\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
\times
\frac{1}{v^{2}}
\begin{pmatrix}
v & -w \\
0 & v
\end{pmatrix}\\
=
&\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
\times
\begin{pmatrix}
\frac{1}{v} & -\frac{w}{v^{2}} \\
0 & \frac{1}{v}
\end{pmatrix}\\
=
&\begin{pmatrix}
\frac{x}{v} & -\frac{xw}{v^{2}}+\frac{y}{v} \\
0 & \frac{x}{v}
\end{pmatrix}\\
=
&\begin{pmatrix}
\frac{x}{v} & \frac{yv-xw}{v^{2}} \\
0 & \frac{x}{v}
\end{pmatrix}
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
(x + y \varepsilon) \div (v + w \varepsilon) =
\begin{pmatrix}
\frac{x}{v} & \frac{yv-xw}{v^{2}} \\
0 & \frac{x}{v}
\end{pmatrix}
\end{aligned}
$$</p><hr><h4 id=æŒ‡æ•°é–¢æ•°>æŒ‡æ•°é–¢æ•°<a hidden class=anchor aria-hidden=true href=#æŒ‡æ•°é–¢æ•°>#</a></h4><p>ä¸ãˆã‚‰ã‚ŒãŸ$x + \varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚</p><p>$$
\begin{aligned}
\exp(x + \varepsilon y) = \exp(x) \times \exp(\varepsilon y)
\end{aligned}
$$</p><p>æŒ‡æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã$\exp(X)$ã¯</p><p>$$
\begin{aligned}
\exp(X) = \sum_{k=0}^{\infty} \frac{X^{k}}{k!}
\end{aligned}
$$</p><p>ã§ã™ã€‚</p><p>å®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾</p><p>$$
\exp(x)
$$</p><p>ã¨ã™ã‚‹ã€‚<br>åŒå¯¾æ•°$\varepsilon y$ ã¯$\varepsilon^{2} = 0$ã‚ˆã‚Š$k\ge2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§</p><p>$$
\begin{aligned}
\exp(\varepsilon y) = \sum_{k=0}^{\infty} \frac{(\varepsilon y)^{k}}{k!} = 1 + \varepsilon y
\end{aligned}
$$</p><p>ã«ãªã‚‹ã€‚</p><p>ã“ã‚Œã‚’ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
\exp(x + \varepsilon y) = \exp(x) \times (1 + \varepsilon y) = \exp(x) + \varepsilon y \exp(x)
\end{aligned}
$$</p><p>ã«ãªã‚Š</p><p>$$
\begin{aligned}
\exp(x + \varepsilon y) =
\begin{pmatrix}
\exp(x) & y \exp(x) \\
0 & \exp(x)
\end{pmatrix}
\end{aligned}
$$</p><p>ã§ã‚ã‚‹ã€‚</p><hr><h4 id=ä¸‰è§’é–¢æ•°sincos>ä¸‰è§’é–¢æ•°(sin,cos)<a hidden class=anchor aria-hidden=true href=#ä¸‰è§’é–¢æ•°sincos>#</a></h4><p>ä¸ãˆã‚‰ã‚ŒãŸ$x + \varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚</p><ul><li>æ­£å¼¦é–¢æ•°(sin)ã®å ´åˆ</li></ul><p>$$
\begin{aligned}
\sin(x + \varepsilon y) = \sin(x)\times\cos(\varepsilon y) + \cos(x) \times \sin(\varepsilon y)
\end{aligned}
$$</p><ul><li>ä½™å¼¦é–¢æ•°(cos)ã®å ´åˆ</li></ul><p>$$
\begin{aligned}
\cos(x + \varepsilon y) = \cos(x)\times\cos(\varepsilon y) - \sin(x) \times \sin(\varepsilon y)
\end{aligned}
$$</p><p>ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã</p><ul><li>æ­£å¼¦é–¢æ•°(sin)ã¯</li></ul><p>$$
\begin{aligned}
\sin(X) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k + 1)!} X^{2k+1}
\end{aligned}
$$</p><ul><li>ä½™å¼¦é–¢æ•°(cos)ã¯</li></ul><p>$$
\begin{aligned}
\cos(X) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k)!} X^{2k}
\end{aligned}
$$</p><p>æŒ‡æ•°é–¢æ•°ã®æ™‚ã¨åŒã˜ã‚ˆã†ã«ã€å®Ÿéƒ¨$x$ã¯ãã®ã¾ã¾</p><ul><li>æ­£å¼¦é–¢æ•°(sin)</li></ul><p>$$
\sin(x)
$$</p><ul><li>ä½™å¼¦é–¢æ•°(cos)</li></ul><p>$$
\cos(x)
$$</p><p>ã¨ã™ã‚‹ã€‚<br>åŒå¯¾æ•°$\varepsilon y$ ã¯$\varepsilon^{2} = 0$ã‚ˆã‚Š$k\ge1$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§</p><ul><li>æ­£å¼¦é–¢æ•°(sin)ã¯</li></ul><p>$$
\begin{aligned}
\sin(\varepsilon y) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k + 1)!} (\varepsilon y)^{2k+1}=\varepsilon y
\end{aligned}
$$</p><ul><li>ä½™å¼¦é–¢æ•°(cos)ã¯</li></ul><p>$$
\begin{aligned}
\cos(\varepsilon y) = \sum_{k=0}^{\infty} \frac{(-1)^{k}}{(2k)!} (\varepsilon y)^{2k} = 1
\end{aligned}
$$</p><p>ã‚ˆã£ã¦</p><ul><li>æ­£å¼¦é–¢æ•°(sin)ã¯</li></ul><p>$$
\begin{aligned}
&\sin(x + \varepsilon y)\\
= &\sin(x)\times\cos(\varepsilon y) + \cos(x) \times \sin(\varepsilon y)\\
= &\sin(x) \times 1 + \cos(x) \times \varepsilon y \\
= &\sin(x) + \varepsilon y \cos(x)
\end{aligned}
$$</p><ul><li>ä½™å¼¦é–¢æ•°(cos)ã¯</li></ul><p>$$
\begin{aligned}
&\cos(x + \varepsilon y)\\
= &\cos(x) \times \cos(\varepsilon y) - \sin(x) \times \sin(\varepsilon y)\\
= &\cos(x) \times 1 - \sin(x) \times \varepsilon y\\
= &\cos(x) - \varepsilon y \sin(x)
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><ul><li>æ­£å¼¦é–¢æ•°(sin)</li></ul><p>$$
\begin{aligned}
\sin(x + \varepsilon y) =
\begin{pmatrix}
\sin(x) & y \cos(x) \\
0 & \sin(x)
\end{pmatrix}
\end{aligned}
$$</p><ul><li>ä½™å¼¦é–¢æ•°(cos)</li></ul><p>$$
\begin{aligned}
\cos(x + \varepsilon y) =
\begin{pmatrix}
\cos(x) & - y \sin(x) \\
0 & \cos(x)
\end{pmatrix}
\end{aligned}
$$</p><hr><h4 id=ä¸‰è§’é–¢æ•°tan>ä¸‰è§’é–¢æ•°(tan)<a hidden class=anchor aria-hidden=true href=#ä¸‰è§’é–¢æ•°tan>#</a></h4><p>$$
\begin{aligned}
\tan(x + y \varepsilon) = \frac{\sin(x + y\varepsilon)}{\cos(x + y\varepsilon)}
\end{aligned}
$$</p><p>ã«ã‚ˆã‚Šã€ä¸‰è§’é–¢æ•°(sin,cos)ã¨ä¹—ç®—ã¨é€†è¡Œåˆ—(é™¤ç®—)ã‚’å®Ÿè£…ã—ã¦ã€ãã‚Œã‚‰ã‚’åˆ©ç”¨ã“ã¨ã§æ¼”ç®—å¯èƒ½ã«ãªã‚‹ã€‚</p><hr><h4 id=å¯¾æ•°é–¢æ•°log>å¯¾æ•°é–¢æ•°(log)<a hidden class=anchor aria-hidden=true href=#å¯¾æ•°é–¢æ•°log>#</a></h4><p>ä¸ãˆã‚‰ã‚ŒãŸ$x + \varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚</p><p>$$
\begin{aligned}
x + y \varepsilon = x \times \left(1 + \frac{y \varepsilon}{x} \right)
\end{aligned}
$$</p><p>ã‚ˆã‚Š</p><p>$$
\begin{aligned}
\log \left( x \times \left( 1 + \frac{y \varepsilon}{x} \right) \right) = \log(x) + \log \left(1 + \frac{y \varepsilon} {x} \right)
\end{aligned}
$$</p><p>å¯¾æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$1 + X$ã¨ã—ãŸã¨ã$\log(1 + X)$ã¯</p><p>$$
\begin{aligned}
\log(1 + X) = \sum_{k=1}^{\infty} \frac{(-1)^{k+1}}{k} X^{k}
\end{aligned}
$$</p><p>ã§ã™ã€‚</p><p>å®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾</p><p>$$
\begin{aligned}
\log(x)
\end{aligned}
$$</p><p>ã¨ã™ã‚‹ã€‚
åŒå¯¾æ•°$ \left(1 + \frac{y \varepsilon}{x} \right)$ ã¯$\varepsilon^{2} = 0$ã‚ˆã‚Š$k \ge 2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§</p><p>$$
\begin{aligned}
\log \left(1 + \frac{y \varepsilon}{x} \right) = \sum_{k=1}^{\infty} \frac{(-1)^{k+1}}{k} \left( \frac{y \varepsilon}{x} \right) ^{k} = \frac{y \varepsilon}{x}
\end{aligned}
$$</p><p>ã‚ˆã£ã¦</p><p>$$
\begin{aligned}
\log \left( x \times \left(1 + \frac{y \varepsilon}{x} \right) \right) = \log(x) + \frac{y \varepsilon}{x}
\end{aligned}
$$</p><p>ã¾ã¨ã‚ã‚‹ã¨</p><p>$$
\begin{aligned}
\log(x + y \varepsilon) =
\begin{pmatrix}
\log(x) & \frac{y}{x} \\
0 & \log(x)
\end{pmatrix}
\end{aligned}
$$</p><h4 id=ç´¯ä¹—power>ç´¯ä¹—ï¼ˆpowerï¼‰<a hidden class=anchor aria-hidden=true href=#ç´¯ä¹—power>#</a></h4><p>åŒå¯¾æ•°ã®ç´¯ä¹— $X^n$ ã‚’è¨ˆç®—ã™ã‚‹å ´åˆï¼ŒæŒ‡æ•° $n$ ãŒæ•´æ•°ã‹éæ•´æ•°ã‹ã§æ‰±ã„ãŒç•°ãªã‚Šã¾ã™ã€‚</p><hr><p><strong>1. $n$ãŒæ•´æ•°ã®å ´åˆï¼ˆæ•´æ•°ä¹—ï¼‰</strong></p><ul><li>$n = 0$ã®ã¨ã</li></ul><p>$$
\begin{aligned}
X^{0} = I
\end{aligned}
$$</p><p>ï¼ˆå˜ä½è¡Œåˆ—ã‚’è¿”ã™ï¼‰</p><ul><li>$n > 0$ã®ã¨ã</li></ul><p>$$
\begin{aligned}
X^n = \underbrace{X X \cdots X}_{n\ \text{å›}}
\end{aligned}
$$</p><p>ï¼ˆåå¾©ä¹—ç®—ï¼‰</p><ul><li>$n &lt; 0$ ã®ã¨ã</li></ul><p>$$
\begin{aligned}
X^n = (X^{-1})^{|n|}
\end{aligned}
$$</p><p>ï¼ˆé€†è¡Œåˆ—ã‚’ä½¿ã£ã¦æ­£ã®æŒ‡æ•°ã¨åŒæ§˜ã«è¨ˆç®—ï¼‰</p><hr><p><strong>2. $n$ ãŒå®Ÿæ•°ã®ã¨ãï¼ˆå®Ÿæ•°ä¹—ãƒ»éæ•´æ•°æŒ‡æ•°ï¼‰</strong></p><p>ã¾ãšæ¡ä»¶ã¨ã—ã¦ã€åŒå¯¾æ•°</p><p>$$
\begin{aligned}
X = x + y\varepsilon
\end{aligned}
$$</p><p>ã®å®Ÿéƒ¨ $x$ ãŒ$0$ã‚ˆã‚Šå¤§ãã„å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ã™ãªã‚ã¡ã€æŒ‡æ•° $n$ ãŒå®Ÿæ•°</p><p>$$
\begin{aligned}
n \in \mathbb{R}
\end{aligned}
$$</p><p>ã§ã‚ã‚‹å ´åˆã€åŒå¯¾æ•° $X$ ã¯</p><p>$$
\begin{aligned}
X = x + y\varepsilon,\qquad x > 0
\end{aligned}
$$</p><p>ã‚’æº€ãŸã•ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</p><p>ã“ã‚Œã¯ã€å®Ÿæ•°ã«ãŠã‘ã‚‹ç´¯ä¹—</p><p>$$
\begin{aligned}
x^n = \exp(n\log x)
\end{aligned}
$$</p><p>ãŒ $x>0$ ã®ã‚‚ã¨ã§å®šç¾©ã•ã‚Œã‚‹ã“ã¨ã¨å®Œå…¨ã«ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚</p><p>ä¸€èˆ¬ã®å®Ÿæ•°æŒ‡æ•° $n$ ã«å¯¾ã—ã¦ã¯ï¼ŒæŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ä½¿ã£ã¦</p><p>$$
\begin{aligned}
X^n = \exp\bigl(n \log X\bigr)
\end{aligned}
$$</p><p>ã¨å®šç¾©ã—ã¾ã™ã€‚</p><p>ã“ã‚Œã¯å®Ÿæ•°ã®ä¸–ç•Œã«ãŠã‘ã‚‹å®šç¾©</p><p>$$
\begin{aligned}
x^n = \exp\bigl(n\log x\bigr)
\end{aligned}
$$</p><p>ã®è¡Œåˆ—ç‰ˆã§ã™ã€‚</p><p>åŒå¯¾æ•°ã¯è¡Œåˆ—ã§è¡¨ã›ã‚‹ã®ã§</p><ul><li><code>log(X)</code>ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®å¯¾æ•°ï¼‰</li><li><code>exp(n log(X))</code>ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®æŒ‡æ•°ï¼‰</li></ul><p>ãŒã™ã¹ã¦è¨ˆç®—å¯èƒ½ã«ãªã‚Šã€ä»»æ„å®Ÿæ•°æŒ‡æ•°ã®ç´¯ä¹—ã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚</p><hr><h4 id=å¹³æ–¹æ ¹square-root>å¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰<a hidden class=anchor aria-hidden=true href=#å¹³æ–¹æ ¹square-root>#</a></h4><p>å¹³æ–¹æ ¹ã¯ç´¯ä¹—ã®ç‰¹åˆ¥ãªå ´åˆã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚<br>ã™ãªã‚ã¡</p><p>$$
\begin{aligned}
\sqrt{X} = X^{\frac{1}{2}}
\end{aligned}
$$</p><p>ãŸã ã—ã€åŒå¯¾æ•° $X$ ã®å®Ÿéƒ¨ãŒ$0$ã‚ˆã‚Šå¤§ãã„ã“ã¨ã€‚ã¤ã¾ã‚Š</p><p>$$
\begin{aligned}
X = x + y\varepsilon,\qquad x > 0
\end{aligned}
$$</p><p>ã‚’æº€ãŸã™ã“ã¨ãŒæ¡ä»¶ã§ã™ã€‚<br>å‰ç¯€ã§å®šç¾©ã—ãŸç´¯ä¹—æ¼”ç®— $X^n$ ã‚’æŒ‡æ•° $n = \frac{1}{2}$ ã¨ã—ã¦è©•ä¾¡ã™ã‚Œã°å¹³æ–¹æ ¹ãŒè¨ˆç®—ã§ãã¾ã™ã€‚</p><hr><h4 id=è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹>è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹<a hidden class=anchor aria-hidden=true href=#è¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹>#</a></h4><p>åŒå¯¾æ•°ã®è¡Œåˆ—è¡¨ç¾</p><p>$$
\begin{aligned}
X =
\begin{pmatrix}
x & y \\
0 & x
\end{pmatrix}
,\qquad x > 0
\end{aligned}
$$</p><p>ã«å¯¾ã—ã¦ã¯ï¼Œ</p><p>$$
\begin{aligned}
\sqrt{X}
=
\begin{pmatrix}
\sqrt{x} & \frac{y}{2\sqrt{x}} \\
0 & \sqrt{x}
\end{pmatrix}
\end{aligned}
$$</p><p>ã¨ãªã‚Šï¼Œã“ã‚Œã¯é€šå¸¸ã®å¹³æ–¹æ ¹ã®å¾®åˆ†æ³•å‰‡</p><p>$$
\begin{aligned}
\frac{d}{dx} \sqrt{x} = \frac{1}{2\sqrt{x}}
\end{aligned}
$$</p><p>ã¨ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚</p><hr><h4 id=å®Ÿè£…ä¸Šã®å‡¦ç†>å®Ÿè£…ä¸Šã®å‡¦ç†<a hidden class=anchor aria-hidden=true href=#å®Ÿè£…ä¸Šã®å‡¦ç†>#</a></h4><ul><li>$n = \frac{1}{2}$ ã¨ã—ã¦ç´¯ä¹—æ¼”ç®— <code>pow(X, n)</code> ã‚’å‘¼ã³å‡ºã™ã ã‘ã§ã‚ˆã„</li><li>ç´¯ä¹—ã®ç¯€ã§ç¤ºã—ãŸã‚ˆã†ã«<ul><li>æŒ‡æ•°$n$ãŒæ•´æ•°ã‹ã©ã†ã‹ã‚’åˆ¤å®š</li><li>éæ•´æ•°ã®å ´åˆã¯ã€å®Ÿéƒ¨ãŒ$0$ã‚ˆã‚Šå¤§ãã„ã‹$(x > 0)$ã‚’åˆ¤å®š</li><li>å®Ÿéƒ¨ãŒ0ã‚ˆã‚Šå¤§ãã„ã®ã§ã‚ã‚Œã°ã€æŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ç”¨ã„ã¦<br>$$
\begin{aligned}
\sqrt{X} = X^{\frac{1}{2}} = \exp \left(\frac{1}{2} \log X\right)
\end{aligned}
$$
ã®å½¢ã§å‡¦ç†ã•ã‚Œã‚‹</li></ul></li></ul><p>ã“ã‚Œã«ã‚ˆã‚Šï¼ŒåŒå¯¾æ•°ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹ãŒè‡ªç„¶ã«è¨ˆç®—ã§ãã¾ã™ã€‚</p><hr><h2 id=python-flintã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†>Python-FLINTã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†<a hidden class=anchor aria-hidden=true href=#python-flintã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†>#</a></h2><p>ã“ã‚Œã¯ã€<code>arb-FLINT</code>ã®<code>arb</code>ã§åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ãŸç²¾åº¦ä¿è¨¼ä»˜ãã®è‡ªå‹•å¾®åˆ†ã§ã™ã€‚<br>ã“ã“ã§ã¯ <strong>åŒå¯¾æ•°ã®$ 2 \times 2$ è¡Œåˆ—ã«ã‚ˆã‚‹è¡¨ç¾ã¯ä½¿ã‚ãš</strong> <code>(å€¤, å¾®åˆ†)</code> ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¼”ç®—ã§ä¼æ’­ã•ã›ã‚‹ã“ã¨ã§è‡ªå‹•å¾®åˆ†ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flint</span> <span class=kn>import</span> <span class=n>arb</span><span class=p>,</span> <span class=n>ctx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>require_pos</span><span class=p>(</span><span class=n>v</span><span class=p>:</span> <span class=n>arb</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>what</span><span class=o>=</span><span class=s2>&#34;x&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    v ãŒã€ç¢ºå®Ÿã«æ­£ã€ã§ã‚ã‚‹ã“ã¨ã‚’è¦æ±‚ã™ã‚‹ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>    ï¼ˆåŒºé–“ãŒ 0 ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚Œã°å®šç¾©åŸŸå¤–ã¨ã—ã¦æ­¢ã‚ã‚‹ï¼‰
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>v</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>what</span><span class=si>}</span><span class=s2> must be strictly positive (interval must not include 0). got </span><span class=si>{</span><span class=n>v</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DualArb</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Dual number over Arb:
</span></span></span><span class=line><span class=cl><span class=s2>        x + eps * dx  (eps^2 = 0)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    val: arb  â€” å®Ÿæ•°éƒ¨ x
</span></span></span><span class=line><span class=cl><span class=s2>    der: arb  â€” å¾®åˆ†å€¤ dx
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=vm>__slots__</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&#34;val&#34;</span><span class=p>,</span> <span class=s2>&#34;der&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>val</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>der</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>=</span> <span class=n>arb</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>der</span> <span class=o>=</span> <span class=n>arb</span><span class=p>(</span><span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>lift</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;ã‚¹ã‚«ãƒ©ãƒ¼ or DualArb ã‚’ DualArb ã«æŒã¡ä¸Šã’ã‚‹ã€‚&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>DualArb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>copy</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;DualArb(val=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span><span class=si>}</span><span class=s2>, der=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>der</span><span class=si>}</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># --- å››å‰‡æ¼”ç®— ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__add__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>other</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>+</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span> <span class=o>+</span> <span class=n>other</span><span class=o>.</span><span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=fm>__radd__</span> <span class=o>=</span> <span class=fm>__add__</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__sub__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>other</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>-</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span> <span class=o>-</span> <span class=n>other</span><span class=o>.</span><span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__rsub__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>other</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>other</span><span class=o>.</span><span class=n>val</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>der</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__neg__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=o>-</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=o>-</span><span class=bp>self</span><span class=o>.</span><span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__mul__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>other</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># (x + eps dx)(y + eps dy) = xy + eps (x dy + y dx)</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>*</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span>
</span></span><span class=line><span class=cl>        <span class=n>der</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>*</span> <span class=n>other</span><span class=o>.</span><span class=n>der</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=fm>__rmul__</span> <span class=o>=</span> <span class=fm>__mul__</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__truediv__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>other</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># (x + eps dx) / (y + eps dy)</span>
</span></span><span class=line><span class=cl>        <span class=c1># = (x / y) + eps * ( (dx*y - x*dy) / y^2 )</span>
</span></span><span class=line><span class=cl>        <span class=n>inv</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>*</span> <span class=n>inv</span>
</span></span><span class=line><span class=cl>        <span class=n>der</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>*</span> <span class=n>other</span><span class=o>.</span><span class=n>der</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>inv</span> <span class=o>*</span> <span class=n>inv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__rtruediv__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># (a) / (x + eps dx)</span>
</span></span><span class=line><span class=cl>        <span class=n>other</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>inv</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span> <span class=o>*</span> <span class=n>inv</span>
</span></span><span class=line><span class=cl>        <span class=n>der</span> <span class=o>=</span> <span class=p>(</span><span class=n>other</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>-</span> <span class=n>other</span><span class=o>.</span><span class=n>val</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>inv</span> <span class=o>*</span> <span class=n>inv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># --- ç´¯ä¹— ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__pow__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        (x + eps dx)^n
</span></span></span><span class=line><span class=cl><span class=s2>        - n ãŒ intï¼ˆæ•´æ•°ï¼‰ãªã‚‰ã€é€šå¸¸ã®æ•´æ•°ä¹—ã¨ã—ã¦æ‰±ã†
</span></span></span><span class=line><span class=cl><span class=s2>        - ãã‚Œä»¥å¤–ï¼ˆå®Ÿæ•°æŒ‡æ•°ï¼‰ã¯ x&gt;0 ã‚’è¦æ±‚ï¼ˆå®Ÿæ•°ã® log ãŒå¿…è¦ï¼‰
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>DualArb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&#34;DualArb ** DualArb ã¯æœªå®Ÿè£…ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼æŒ‡æ•°ã ã‘å¯¾å¿œï¼‰ã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># --- 1) æ•´æ•°æŒ‡æ•°ï¼ˆPython intï¼‰ ---</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># (x + eps dx)^0 = 1, å¾®åˆ†ã¯ 0</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>n</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 0 ã®è² æ•´æ•°ä¹—ã¯ä¸å¯</span>
</span></span><span class=line><span class=cl>                <span class=c1># arb ã®ã€Œ0ã¨ç­‰ã—ã„ã€åˆ¤å®šã¯æ›–æ˜§ã«ãªã‚Šå¾—ã‚‹ã®ã§å®‰å…¨å´ã«å€’ã™</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>raise</span> <span class=ne>ZeroDivisionError</span><span class=p>(</span><span class=s2>&#34;0 ã®è² æ•´æ•°ä¹—ã¯å®šç¾©ã§ãã¾ã›ã‚“ã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 0 ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚‹åŒºé–“ãªã‚‰ã‚¢ã‚¦ãƒˆ</span>
</span></span><span class=line><span class=cl>                    <span class=k>raise</span> <span class=ne>ZeroDivisionError</span><span class=p>(</span><span class=s2>&#34;0 ã‚’å«ã‚€åŒºé–“ã®è² æ•´æ•°ä¹—ã¯å®šç¾©ã§ãã¾ã›ã‚“ã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>val</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>**</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>            <span class=n>der</span> <span class=o>=</span> <span class=n>arb</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>**</span> <span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># --- 2) éæ•´æ•°æŒ‡æ•°ï¼ˆå®Ÿæ•°æŒ‡æ•°ï¼‰ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>n_arb</span> <span class=o>=</span> <span class=n>arb</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># å®Ÿæ•°ã¨ã—ã¦ã® x^n ã‚’ exp(n log x) ã§å®šç¾©ã™ã‚‹ã®ã§ x&gt;0 ãŒå¿…è¦</span>
</span></span><span class=line><span class=cl>        <span class=n>require_pos</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=n>what</span><span class=o>=</span><span class=s2>&#34;pow real-part (non-integer exponent)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>**</span> <span class=n>n_arb</span>
</span></span><span class=line><span class=cl>        <span class=n>der</span> <span class=o>=</span> <span class=n>n_arb</span> <span class=o>*</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>val</span> <span class=o>**</span> <span class=p>(</span><span class=n>n_arb</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__rpow__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>base</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        base ** (x + eps dx)
</span></span></span><span class=line><span class=cl><span class=s2>        = exp((x + eps dx) * log(base))
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>base_arb</span> <span class=o>=</span> <span class=n>arb</span><span class=p>(</span><span class=n>base</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>base_arb</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;base ã¯æ­£ã®å®Ÿæ•°ã«ã—ã¦ã­ï¼ˆlog ãŒå¿…è¦ã«ãªã‚‹ã®ã§ï¼‰ã€‚&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># f(x) = base^x, f&#39;(x) = base^x * log(base)</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=n>base_arb</span> <span class=o>**</span> <span class=bp>self</span><span class=o>.</span><span class=n>val</span>
</span></span><span class=line><span class=cl>        <span class=n>der</span> <span class=o>=</span> <span class=n>val</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=n>base_arb</span><span class=o>.</span><span class=n>log</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --- elementary functions on DualArb ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dual_exp</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    exp(x + eps dx) = exp(x) + eps * dx * exp(x)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>exp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>x</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dual_log</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    log(x + eps dx) = log(x) + eps * dx / x
</span></span></span><span class=line><span class=cl><span class=s2>    å®šç¾©åŸŸï¼ˆå®Ÿæ•°ï¼‰ï¼šå®Ÿéƒ¨ãŒ strictly positive
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>require_pos</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=n>what</span><span class=o>=</span><span class=s2>&#34;log real-part&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>log</span><span class=p>(),</span> <span class=n>x</span><span class=o>.</span><span class=n>der</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dual_sin</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    sin(x + eps dx) = sin(x) + eps * dx * cos(x)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>sin</span><span class=p>(),</span> <span class=n>x</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>cos</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dual_cos</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    cos(x + eps dx) = cos(x) - eps * dx * sin(x)
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>cos</span><span class=p>(),</span> <span class=o>-</span><span class=n>x</span><span class=o>.</span><span class=n>der</span> <span class=o>*</span> <span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>sin</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dual_tan</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    tan = sin / cos ã§å®Ÿè£…ï¼ˆå®‰ç›´ç‰ˆï¼‰
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dual_sin</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>/</span> <span class=n>dual_cos</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>dual_sqrt</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    sqrt(x + eps dx) = sqrt(x) + eps * dx / (2 * sqrt(x))
</span></span></span><span class=line><span class=cl><span class=s2>    å®šç¾©åŸŸï¼ˆå®Ÿæ•°ï¼‰ï¼šå®Ÿéƒ¨ãŒ strictly positive
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>require_pos</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=n>what</span><span class=o>=</span><span class=s2>&#34;sqrt real-part&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>val</span><span class=o>.</span><span class=n>sqrt</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>x</span><span class=o>.</span><span class=n>der</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>v</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>differentiate</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>x0</span><span class=p>,</span> <span class=n>dps</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ctx</span><span class=o>.</span><span class=n>dps</span> <span class=o>=</span> <span class=n>dps</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>DualArb</span><span class=p>(</span><span class=n>x0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>f</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>DualArb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>DualArb</span><span class=o>.</span><span class=n>lift</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>y</span><span class=o>.</span><span class=n>val</span><span class=p>,</span> <span class=n>y</span><span class=o>.</span><span class=n>der</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>flint</span> <span class=kn>import</span> <span class=n>arb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># f(x) ã‚’ DualArb ã§æ›¸ã</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>DualArb</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>DualArb</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># f(x) = x^3 + 2 * sin(x) * exp(x)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span><span class=o>**</span><span class=mi>3</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>dual_sin</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>*</span> <span class=n>dual_exp</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># xã®å€¤ã¨ç²¾åº¦ã‚’å…¥åŠ›</span>
</span></span><span class=line><span class=cl>    <span class=n>val</span><span class=p>,</span> <span class=n>der</span> <span class=o>=</span> <span class=n>differentiate</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>x0</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>dps</span><span class=o>=</span><span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># çµæœå‡ºåŠ›</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› -------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;f(x)  =&#34;</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;f&#39;(x) =&#34;</span><span class=p>,</span> <span class=n>der</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ã“ã“ã‹ã‚‰ã¯æ¤œç®—ç”¨ï¼ˆæ™®é€šã®arbã§è¨ˆç®—ï¼‰</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æ¤œç®—ç”¨ã® x ã® å€¤ã‚’arbã§å…¥åŠ›</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>arb</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f_exact</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=mi>3</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>x</span><span class=o>.</span><span class=n>sin</span><span class=p>()</span> <span class=o>*</span> <span class=n>x</span><span class=o>.</span><span class=n>exp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># f&#39;(x) = 3x^2 + 2[cos x * e^x + sin x * e^x]</span>
</span></span><span class=line><span class=cl>    <span class=n>fprime_exact</span> <span class=o>=</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>cos</span><span class=p>()</span> <span class=o>*</span> <span class=n>x</span><span class=o>.</span><span class=n>exp</span><span class=p>()</span> <span class=o>+</span> <span class=n>x</span><span class=o>.</span><span class=n>sin</span><span class=p>()</span> <span class=o>*</span> <span class=n>x</span><span class=o>.</span><span class=n>exp</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æ¤œç®—å‡ºåŠ›</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› ---------------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;f(x) (exact-like)  =&#34;</span><span class=p>,</span> <span class=n>f_exact</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;f&#39;(x) (exact-like) =&#34;</span><span class=p>,</span> <span class=n>fprime_exact</span><span class=p>)</span>
</span></span></code></pre></div><p>å®Ÿè¡Œçµæœ</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› -------------------
</span></span><span class=line><span class=cl>f<span class=o>(</span>x<span class=o>)</span>  <span class=o>=</span> <span class=o>[</span>21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79<span class=o>]</span>
</span></span><span class=line><span class=cl>f<span class=s1>&#39;(x) = [19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79]
</span></span></span><span class=line><span class=cl><span class=s1>-------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› ---------------------
</span></span></span><span class=line><span class=cl><span class=s1>f(x) (exact-like)  = [21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79]
</span></span></span><span class=line><span class=cl><span class=s1>f&#39;</span><span class=o>(</span>x<span class=o>)</span> <span class=o>(</span>exact-like<span class=o>)</span> <span class=o>=</span> <span class=o>[</span>19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79<span class=o>]</span>
</span></span></code></pre></div><h2 id=arbãƒ©ã‚¤ãƒ–ãƒ©ãƒªcã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†>Arbãƒ©ã‚¤ãƒ–ãƒ©ãƒª(C++)ã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†<a hidden class=anchor aria-hidden=true href=#arbãƒ©ã‚¤ãƒ–ãƒ©ãƒªcã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†>#</a></h2><p>åŒå¯¾æ•°ã«ã‚ˆã‚‹å¾®åˆ†ã¯ã€$\varepsilon^2 = 0$ ã‚’æº€ãŸã™å…ƒ $\varepsilon$ ã‚’ç”¨ã„ã¦</p><p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x)
\end{aligned}
$$</p><p>ã¨è¡¨ã•ã‚Œã¾ã™ã€‚</p><p>ã“ã‚Œã‚’</p><p>$$
\begin{aligned}
x + \varepsilon =
\begin{pmatrix}
x & 1 \\
0 & x
\end{pmatrix}
\end{aligned}
$$</p><p>ã¨ã„ã† $2 \times 2$ ä¸Šä¸‰è§’è¡Œåˆ—ã¨ã—ã¦è¡¨ç¾ã—ï¼Œ
Arb ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã¦ 1 éšã®è‡ªå‹•å¾®åˆ†ã‚’
ç²¾åº¦ä¿è¨¼ä»˜ãã§å®Ÿè£…ã—ãŸä¾‹ã¯ï¼Œæ¬¡ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚</p><p><a href=https://github.com/ungeho/arb-diff>ğŸ“¦<strong>åŒå¯¾æ•°ã‚’ä½¿ã£ãŸç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†</strong></a></p><h2 id=pythonç‰ˆã§ã¯ãªãœè¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã—ãªã‹ã£ãŸã‹>Pythonç‰ˆã§ã¯ãªãœè¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã—ãªã‹ã£ãŸã‹<a hidden class=anchor aria-hidden=true href=#pythonç‰ˆã§ã¯ãªãœè¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã—ãªã‹ã£ãŸã‹>#</a></h2><p>C++ç‰ˆã§ã¯åŒå¯¾æ•°$x+\varepsilon$ã‚’</p><p>$$
\begin{aligned}
\begin{pmatrix}
x & \varepsilon \\
0 & x
\end{pmatrix}
\end{aligned}
$$</p><p>ã¨ã„ã† $2\times2$ ä¸Šä¸‰è§’è¡Œåˆ—ã§è¡¨ç¾ã—ã€è¡Œåˆ—ç©ã«ã‚ˆã£ã¦å¾®åˆ†ã‚’è‡ªå‹•çš„ã«ä¼æ’­ã•ã›ã¦ã„ã‚‹ã€‚</p><p>ä¸€æ–¹ã€Python ç‰ˆã§ã¯ã“ã®è¡Œåˆ—è¡¨ç¾ã‚’æ¡ç”¨ã›ãšã€<code>(å€¤, å¾®åˆ†å€¤)</code> ã‚’æ˜ç¤ºçš„ã«ä¿æŒã™ã‚‹è‡ªå‹•å¾®åˆ†ã®å®Ÿè£…ã‚’é¸æŠã—ãŸã€‚<br>ãã®ç†ç”±ã¯ä¸»ã«æ¬¡ã®ç‚¹ã«ã‚ã‚‹ã€‚</p><hr><h3 id=1pythonã§ã¯è¡Œåˆ—æ¼”ç®—ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„>1.Pythonã§ã¯è¡Œåˆ—æ¼”ç®—ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„<a hidden class=anchor aria-hidden=true href=#1pythonã§ã¯è¡Œåˆ—æ¼”ç®—ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„>#</a></h3><p><code>arb_mat</code>ã‚’ç”¨ã„ãŸè¡Œåˆ—æ¼”ç®—ã¯ã€ã‚¹ã‚«ãƒ©ãƒ¼<code>arb</code>ã®æ¼”ç®—ã¨æ¯”ã¹ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„ã€‚</p><p>åŒå¯¾æ•°ã«ã‚ˆã‚‹1éšå¾®åˆ†ã§ã¯æœ¬è³ªçš„ã«</p><ul><li>å€¤ã€€ã€€ï¼š$x$</li><li>å¾®åˆ†å€¤ï¼š$dx$</li></ul><p>ã®2ã¤ã®ã‚¹ã‚«ãƒ©ãƒ¼ã ã‘ã‚’æ‰±ãˆã°ååˆ†ã§ã‚ã‚Šã€å¸¸ã«$2 \times 2$ è¡Œåˆ—ã‚’æ§‹æˆãƒ»æ¼”ç®—ã™ã‚‹å¿…è¦ãŒãªã„ã€‚</p><p>Pythonã§ã¯ã“ã®å·®ãŒç‰¹ã«é¡•è‘—ã«ãªã‚‹ãŸã‚ã€ã‚¹ã‚«ãƒ©ãƒ¼2å€‹ã‚’ç›´æ¥ä¼æ’­ã•ã›ã‚‹æ–¹ãŒå®Ÿç”¨çš„ã€‚</p><hr><h3 id=2è¡Œåˆ—é–¢æ•°ã¯å¿…è¦ä»¥ä¸Šã«ä¸€èˆ¬çš„>2.è¡Œåˆ—é–¢æ•°ã¯ã€Œå¿…è¦ä»¥ä¸Šã«ä¸€èˆ¬çš„ã€<a hidden class=anchor aria-hidden=true href=#2è¡Œåˆ—é–¢æ•°ã¯å¿…è¦ä»¥ä¸Šã«ä¸€èˆ¬çš„>#</a></h3><p><code>arb_mat_exp</code>ã‚„<code>arb_mat_log</code>ãªã©ã®è¡Œåˆ—é–¢æ•°ã¯ã€<strong>ä¸€èˆ¬è¡Œåˆ—</strong>ã‚’å¯¾è±¡ã¨ã—ãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p>ã—ã‹ã—åŒå¯¾æ•°ã«å¯¾å¿œã™ã‚‹è¡Œåˆ—ã¯å¸¸ã«</p><ul><li><strong>ä¸Šä¸‰è§’è¡Œåˆ—</strong></li><li><strong>ç‰¹æ®Šãªå†ªé›¶æ§‹é€ $(\varepsilon^{2} = 0)$</strong></li></ul><p>ã‚’æŒã¡ã¾ã™ã€‚</p><p>ã“ã®ç‰¹æ®Šæ§‹é€ ã‚’ç”Ÿã‹ã™ãªã‚‰</p><p>$$
\begin{aligned}
\exp(x + \epsilon) = \exp(x) + \varepsilon \exp(x)
\end{aligned}
$$</p><p>ã®ã‚ˆã†ãªç°¡æ½”ãªå¼ã§ååˆ†ã§ã€ä¸€èˆ¬è¡Œåˆ—ã®åˆç­‰é–¢æ•°ã‚’è¨ˆç®—ã™ã‚‹ã®ã¯éå‰°ã§ã™ã€‚</p><p>Pythonç‰ˆã§ã¯ã€åŒå¯¾æ•°ã¨ã—ã¦å¿…è¦ãªå¾®åˆ†å‰‡ã®ã¿ã‚’æ˜ç¤ºçš„ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€è¨ˆç®—ã¨å®Ÿè£…ã®ä¸¡é¢ã§ç°¡æ½”ã•ã‚’ä¿ã£ã¦ã„ã¾ã™ã€‚</p><hr><h3 id=3æ‹¡å¼µæ€§é«˜éšå¾®åˆ†ã¨ã®ç›¸æ€§>3.æ‹¡å¼µæ€§(é«˜éšå¾®åˆ†)ã¨ã®ç›¸æ€§<a hidden class=anchor aria-hidden=true href=#3æ‹¡å¼µæ€§é«˜éšå¾®åˆ†ã¨ã®ç›¸æ€§>#</a></h3><p>1éšã®ã‚¹ã‚«ãƒ©ãƒ¼å¾®åˆ†ã«é™ã‚Œã°ã€$2 \times 2$ã®è¡¨ç¾ã¯éå¸¸ã«æœ‰åŠ¹ã§ã™ã€‚</p><p>ã—ã‹ã—<strong>é«˜éšå¾®åˆ†</strong>ã¸æ‹¡å¼µã™ã‚‹å ´åˆã€è¡Œåˆ—ã‚µã‚¤ã‚ºã‚„æ§‹é€ ã¯æ€¥é€Ÿã«è¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚</p><p>ãŸã¨ãˆã°ã€$(n \ge 2)$ã¨ã—ã¦ <strong>$n$éšå¾®åˆ†(é«˜éšå¾®åˆ†)ã¸ã®æ‹¡å¼µ</strong> ã‚’è¡Œã†å ´åˆã€ <strong>è¶…åŒå¯¾æ•°(Hyper Dual Numbers)</strong> ã‚’ç”¨ã„ã‚‹æ–¹æ³•ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚<br>ã—ã‹ã—ã€$n$éšå¾®åˆ†ã‚’è¶…åŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹å ´åˆ</p><ul><li><strong>è¡Œåˆ—ã‚µã‚¤ã‚ºï¼š$2^{n} \times 2^{n}$</strong></li><li><strong>è¡Œåˆ—ã®æ•°ã€€ï¼š$2^{n-1}$å€‹</strong></li></ul><p>ã®ã‚ˆã†ã«ã€æ€¥é€Ÿã«ã‚µã‚¤ã‚ºã‚„æ•°ãŒå¢—ãˆã¦ã„ãã€æ§‹é€ ã‚‚è¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚</p><p>Pythonç‰ˆã®<code>(val, der)</code>å½¢å¼ã¯</p><ul><li><strong><code>der</code>ã‚’ã•ã‚‰ã«dualã«ã™ã‚Œã°é«˜éšã«å¯¾å¿œ</strong></li></ul><p>ã¨ã„ã£ãŸã‚ˆã†ãªæ‹¡å¼µãŒè‡ªç„¶ã§ã‚ã‚Šã€è‡ªå‹•å¾®åˆ†ã®ä¸€èˆ¬çš„ãªè¨­è¨ˆã¨è¦ªå’Œæ€§ãŒé«˜ã„ã¨æ€ã„ã¾ã™ã€‚</p><hr><h3 id=4è¡¨ç¾ã®é•ã„ã§ã‚ã£ã¦æœ¬è³ªã¯åŒã˜>4.è¡¨ç¾ã®é•ã„ã§ã‚ã£ã¦ã€æœ¬è³ªã¯åŒã˜<a hidden class=anchor aria-hidden=true href=#4è¡¨ç¾ã®é•ã„ã§ã‚ã£ã¦æœ¬è³ªã¯åŒã˜>#</a></h3><p>ãªãŠã€Pythonç‰ˆãŒè¡Œåˆ—è¡¨ç¾ã‚’ç”¨ã„ãªã„ã‹ã‚‰ã¨ã„ã£ã¦ã€åŒå¯¾æ•°ãã®ã‚‚ã®ã‚’ä½¿ã£ã¦ã„ãªã„ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p><p><code>(å€¤, å¾®åˆ†å€¤)</code>ã‚’æ¼”ç®—ã”ã¨ã«ä¼æ’­ã•ã›ã‚‹æ–¹æ³•ã¯</p><p>$$
\begin{aligned}
f(x + \varepsilon) = f(x) + \varepsilon f^{\prime}(x)
\end{aligned}
$$</p><p>ã‚’å†…éƒ¨çš„ã«æ‰±ã£ã¦ã„ã‚‹ã®ã¨ç­‰ä¾¡ã§ã™ã€‚</p><p>ã“ã‚Œã¯å®Ÿè£…ä¸Šã®è¡¨ç¾ã®é•ã„ã§ã‚ã‚Šã€æ•°å­¦çš„ãªæ„å‘³ã§ã®è‡ªå‹•å¾®åˆ†ã®æœ¬è³ªã¯C++ç‰ˆã¨å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚</p><hr><p>ã¾ã¨ã‚ã‚‹ã¨</p><ul><li><strong>Pythonç‰ˆ</strong><br><code>(å€¤, å¾®åˆ†å€¤)</code>ã‚’æ˜ç¤ºçš„ã«ä¼æ’­ã—ã€è»½é‡ã§æ‹¡å¼µã—ã‚„ã™ã„å®Ÿè£…ã‚’æ¡ç”¨</li><li><strong>C++ç‰ˆ</strong><br>è¡Œåˆ—è¡¨ç¾ã«ã‚ˆã‚‹åŒå¯¾æ•°ã‚’æ´»ã‹ã—ã€Arbã®è¡Œåˆ—æ¼”ç®—ã§è‡ªå‹•å¾®åˆ†ã‚’å®Ÿè£…</li></ul><p>ä¸¡è€…ã¯ç•°ãªã‚‹å®Ÿè£…æˆ¦ç•¥ã‚’å–ã£ã¦ã„ã¾ã™ãŒã€ã„ãšã‚Œã‚‚åŒå¯¾æ•°ã«åŸºã¥ãè‡ªå‹•å¾®åˆ†ã¨ã„ã†ç‚¹ã§æœ¬è³ªçš„ã«åŒã˜ã§ã™ã€‚</p><h2 id=ã¾ã¨ã‚>ã¾ã¨ã‚<a hidden class=anchor aria-hidden=true href=#ã¾ã¨ã‚>#</a></h2><p>æœ¬è¨˜äº‹ã§ã¯ã€<strong>åŒå¯¾æ•°ï¼ˆDual numbersï¼‰</strong> ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã®ä»•çµ„ã¿ã«ã¤ã„ã¦</p><ul><li><strong>åŒå¯¾æ•°ã®å®šç¾©ã¨ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŸç†</strong></li><li><strong>åŒå¯¾æ•°ã‚’ 2Ã—2 ä¸Šä¸‰è§’è¡Œåˆ—è¡¨ç¾ã«è½ã¨ã—è¾¼ã‚€æ–¹æ³•</strong></li><li><strong>å››å‰‡æ¼”ç®—ï¼ˆåŠ ç®—ãƒ»æ¸›ç®—ãƒ»ä¹—ç®—ãƒ»é™¤ç®—ï¼‰ã®å…·ä½“çš„ãªå¼</strong></li><li><strong>exp, log, sin, cos, tan, ç´¯ä¹—ï¼Œå¹³æ–¹æ ¹ã¨ã„ã£ãŸåˆç­‰é–¢æ•°ã®æ‹¡å¼µæ–¹æ³•</strong></li><li><strong>ãã‚Œã‚‰ã‚’åœŸå°ã«ã—ãŸå®Ÿè£…ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong></li></ul><p>ã¨ã„ã£ãŸæµã‚Œã§æ•´ç†ã—ã¾ã—ãŸã€‚</p><hr><p>åŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§</p><ul><li>é–¢æ•°å€¤ $f(x)$ ã¨å°é–¢æ•° $f^{\prime}(x)$ ã‚’ <strong>1 å›ã®è©•ä¾¡ã§åŒæ™‚ã«å¾—ã‚‰ã‚Œã‚‹</strong></li><li>å·®åˆ†å¹… $h$ ã®èª¿æ•´ãŒä¸è¦ã§ï¼Œ<strong>æ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚µã‚¤ã‚ºèµ·å› ã®èª¤å·®ãŒãªã„</strong></li><li>å®Ÿè£…ã¯ã€Œã„ã¤ã‚‚ã®å®Ÿæ•°æ¼”ç®—ã€ã‚’ãã®ã¾ã¾åŒå¯¾æ•°ï¼ˆè¡Œåˆ—ï¼‰ã«æ‹¡å¼µã™ã‚‹ã ã‘</li></ul><p>ã¨ã„ã£ãŸåˆ©ç‚¹ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p><hr><p>ã•ã‚‰ã«ï¼ŒPython-FLINT ã® <code>arb</code> å‹ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ï¼Œ</p><ul><li>å®Ÿæ•°éƒ¨ãƒ»å¾®åˆ†å€¤ã®ã©ã¡ã‚‰ã‚‚ <strong>ã€ŒçœŸå€¤ã‚’å«ã‚€åŒºé–“ã€</strong> ã¨ã—ã¦è¡¨ç¾ã§ãã‚‹</li><li>ä¸¸ã‚èª¤å·®ã‚’å«ã‚ãŸ <strong>ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ†</strong> ãŒå®Ÿç¾ã§ãã‚‹</li></ul><p>ã¨ã„ã†ã¨ã“ã‚ã¾ã§åˆ°é”ã—ã¾ã—ãŸã€‚</p><hr><p>æ•°å€¤å¾®åˆ†ãƒ»è‡ªå‹•å¾®åˆ†ã‚’ä¸¦ã¹ã¦è¦‹ãŸã¨ã</p><ul><li><strong>æ•°å€¤å¾®åˆ†ï¼šå®Ÿè£…ã¯ç°¡å˜ã ãŒï¼Œèª¤å·®ã¨ $h$ ã®é¸ã³æ–¹ã«æ‚©ã¾ã•ã‚Œã‚‹</strong></li><li><strong>è‡ªå‹•å¾®åˆ†ï¼šç²¾åº¦ä¿è¨¼ã«ã¯åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§è‰¯ã„</strong></li></ul><p>ã¨ã„ã†æ€§è³ªã®é•ã„ãŒã‚ã‚Šã€ã¨ã¦ã‚‚æ°—æŒã¡ã®ã‚ˆã„æ‰‹æ³•ã ã¨æ„Ÿã˜ã¦ã‚‚ã‚‰ãˆãŸã‚‰å¬‰ã—ã„ã§ã™ã€‚<br>ç‰¹ã«ã€<strong>åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§ç²¾åº¦ãŒä¿è¨¼ã•ã‚Œã‚‹(æ•°å¼ä¸Šã®èª¤å·®ãŒãªã„)</strong> ã¯åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã®å¤§ããªåˆ©ç‚¹ã§ã™ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ungeho.netlify.app/tags/float/>Float</a></li><li><a href=https://ungeho.netlify.app/tags/ieee754/>IEEE754</a></li><li><a href=https://ungeho.netlify.app/tags/%E6%95%B0%E5%80%A4%E8%A8%88%E7%AE%97/>æ•°å€¤è¨ˆç®—</a></li><li><a href=https://ungeho.netlify.app/tags/%E8%AA%A4%E5%B7%AE/>èª¤å·®</a></li><li><a href=https://ungeho.netlify.app/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</a></li><li><a href=https://ungeho.netlify.app/tags/%E8%87%AA%E5%8B%95%E5%BE%AE%E5%88%86/>è‡ªå‹•å¾®åˆ†</a></li><li><a href=https://ungeho.netlify.app/tags/%E5%8F%8C%E5%AF%BE%E6%95%B0/>åŒå¯¾æ•°</a></li></ul><nav class=paginav><a class=prev href=https://ungeho.netlify.app/posts/regularstarpolygon/><span class=title>Â« å‰ã¸</span><br><span>æ˜Ÿå½¢æ­£å¤šè§’å½¢</span>
</a><a class=next href=https://ungeho.netlify.app/posts/numericaldifferentiation/><span class=title>æ¬¡ã¸ Â»</span><br><span>æ•°å€¤å¾®åˆ†</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share è‡ªå‹•å¾®åˆ† on x" href="https://x.com/intent/tweet/?text=%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86&amp;url=https%3a%2f%2fungeho.netlify.app%2fposts%2fautodiff%2f&amp;hashtags=Float%2cIEEE754%2c%e6%95%b0%e5%80%a4%e8%a8%88%e7%ae%97%2c%e8%aa%a4%e5%b7%ae%2c%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%9f%e3%83%b3%e3%82%b0%2c%e8%87%aa%e5%8b%95%e5%be%ae%e5%88%86%2c%e5%8f%8c%e5%af%be%e6%95%b0"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ungeho.netlify.app/>ungehoBlog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="ã‚³ãƒ”ãƒ¼";function s(){t.innerHTML="ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸ!",setTimeout(()=>{t.innerHTML="ã‚³ãƒ”ãƒ¼"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>