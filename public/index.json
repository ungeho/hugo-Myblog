[{"content":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°\n2. åŒºé–“æ¼”ç®—\n3. æ•°å€¤ç©åˆ†\n4. æ•°å€¤å¾®åˆ†\n5. è‡ªå‹•å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“\nè‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD) ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚\nç‰¹ã«åŒå¯¾æ•°(Dual numbers) ã‚’ç”¨ã„ãŸæ‰‹æ³•ã§ã¯ã€å…¥åŠ›ã‚’$x+\\varepsilon$ ã¨ã—ã¦è¨ˆç®—ã™ã‚‹ã ã‘ã§ã€é–¢æ•°å€¤$f(x)$ ã¨å°é–¢æ•°$f^{\\prime}(x)$ ãŒåŒæ™‚ã«å¾—ã‚‰ã‚Œã€æ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªèª¤å·®ãŒãªã$h$ ã®é¸æŠãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚\nåŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ† åŒå¯¾æ•°ï¼ˆDual Numbersï¼‰ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã§ã¯ã€å…¥åŠ›ã‚’\n$$ \\begin{aligned} x + \\varepsilon \\end{aligned} $$\nã¨ã—ãŸã¨ãã®é–¢æ•°ã®å€¤ãŒ\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) \\end{aligned} $$\nã¨ã„ã†å½¢ã«ãªã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã¦å¾®åˆ†å€¤ã‚’å¾—ã¾ã™ã€‚\nã“ã“ã§$\\varepsilon$ã¯æ¬¡ã®æ€§è³ªã‚’ã‚‚ã¤ç‰¹åˆ¥ãªå…ƒã§ã™\n$$ \\begin{aligned} \\varepsilon \u0026amp;\\neq 0\\\\ \\varepsilon^{2} \u0026amp;= 0 \\end{aligned} $$\nã“ã‚Œã¯ã€Œ$\\varepsilon$ ã¯äºŒä¹—ã™ã‚‹ã¨å®Œå…¨ã«æ¶ˆãˆã‚‹ã€ã¨ã„ã†æ„å‘³ã‚’è¡¨ã—ã¾ã™ã€‚\nãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŒå¯¾æ•°ã®åŸç† ã“ã“ã§ã€æ¬¡ã®ãƒ†ã‚¤ãƒ©ãƒ¼ç´šæ•°ã‚’è€ƒãˆã¾ã™ã€‚\n$$ \\begin{aligned} f(x + a) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)} (x)}{n!}(a)^{n} \\end{aligned} $$\nã«$a=\\varepsilon$ã‚’ä»£å…¥ã™ã‚‹ã¨\n$$ \\begin{aligned} f(x + \\varepsilon) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)} (x)}{n!}(\\varepsilon)^{n} \\end{aligned} $$\nã“ã‚Œã‚’å±•é–‹ã™ã‚‹ã¨\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) + \\varepsilon^{2} \\frac{f^{\\prime\\prime}(x)}{2!} +\\varepsilon^{3}\\frac{ f^{(3)}(x)}{3!} + \\dots \\end{aligned} $$\nã—ã‹ã—ã€åŒå¯¾æ•°ã®å®šç¾©ã‚ˆã‚Š\n$$ \\begin{aligned} \\varepsilon^{2} = 0 \\end{aligned} $$\nã§ã‚ã‚‹ãŸã‚ã€äºŒæ¬¡ä»¥é™ã®é …ãŒå…¨ã¦æ¶ˆãˆã¾ã™ã€‚\nã‚ˆã£ã¦\n$$ \\begin{aligned} f(x + \\varepsilon) = f(x) + \\varepsilon f^{\\prime}(x) \\end{aligned} $$\nã¨ã„ã†éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªå½¢ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\nã“ã“ã§\nå®Ÿæ•°éƒ¨ï¼š$f(x)$ $\\varepsilon$ã®ä¿‚æ•°ï¼š$f^{\\prime}(x)$ ãŒå¾—ã‚‰ã‚Œã‚‹ãŸã‚ã€åŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§é–¢æ•°å€¤ã¨å°é–¢æ•°ãŒåŒæ™‚ã«è¨ˆç®—ã§ãã‚‹ã‚ã‘ã§ã™ã€‚\nåŒå¯¾æ•°ã‚’è¡Œåˆ—ã§è¡¨ç¾ã™ã‚‹ $$ \\begin{aligned} x + \\varepsilon y \\end{aligned} $$\nã¯2 x 2 ã®ä¸Šä¸‰è§’è¡Œåˆ—\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} \\end{aligned} $$\nã¨å…¨ãåŒã˜æŒ¯ã‚‹èˆã„ã‚’ã—ã¾ã™ã€‚\nã“ã®ã¨ãã€åŒå¯¾æ•°$\\varepsilon$ ã¯\n$$ \\varepsilon = \\begin{aligned} \\begin{pmatrix} 0 \u0026amp; 1 \\\\ 0 \u0026amp; 0 \\end{pmatrix} \\end{aligned} $$\nã§ã‚ã‚Šã€è¡Œåˆ—ã®ç©ã‚’ã¨ã‚‹ã¨\n$$ \\varepsilon^{2} = \\begin{aligned} \\begin{pmatrix} 0 \u0026amp; 1 \\\\ 0 \u0026amp; 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \u0026amp; 1 \\\\ 0 \u0026amp; 0 \\end{pmatrix} = \\begin{pmatrix} 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \\end{pmatrix} \\end{aligned} $$\nã—ãŸãŒã£ã¦\n$$ \\begin{aligned} \\varepsilon \u0026amp;\\neq 0\\\\ \\varepsilon^{2} \u0026amp;= 0 \\end{aligned} $$\nã¨ã„ã†åŒå¯¾æ•°ã®æ€§è³ªãŒè¡Œåˆ—ã§æ­£ã—ãå†ç¾ã•ã‚Œã¦ã„ã¾ã™ã€‚\nå®Ÿè£…ä¸Šã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  åŒå¯¾æ•°ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã¯ã€åŒå¯¾æ•°\n$$ \\begin{aligned} x + \\varepsilon y \\end{aligned} $$\nã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ã€åŠ ç®—ãƒ»ä¹—ç®—ãƒ»åˆç­‰é–¢æ•°ãªã©ã®åŸºæœ¬çš„ãªæ¼”ç®—ã‚’ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å†å®šç¾©ã™ã‚‹ ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚\nå…·ä½“çš„ã«ã¯ã€ã»ã¨ã‚“ã©è¡Œåˆ—æ¼”ç®—ã®å®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚\nä»£å…¥æ¼”ç®—å­(+=,-=,*=,/=)ã‚„ç¬¦å·-ã¯æ¼”ç®—å­ã‚’ä¸Šæ›¸ãã—ãŸå››å‰‡æ¼”ç®—ã‚’ä½¿ã£ã¦æ¼”ç®—ã—ã¾ã™ã€‚\nä¸€éƒ¨ã®ç‰¹æ®Šé–¢æ•°ã¯å®šç¾©ã—ãŸç‰¹æ®Šé–¢æ•°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nåŠ ç®— + $$ \\begin{aligned} \\begin{pmatrix} a \u0026amp; b \\\\ c \u0026amp; d \\end{pmatrix} + \\begin{pmatrix} e \u0026amp; f \\\\ g \u0026amp; h \\end{pmatrix} = \\begin{pmatrix} a+e \u0026amp; b+f \\\\ c+g \u0026amp; d+h \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) + (v + w \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} + \\begin{pmatrix} v \u0026amp; w \\\\ 0 \u0026amp; v \\end{pmatrix} = \\begin{pmatrix} x+v \u0026amp; y+w \\\\ 0 \u0026amp; x+v \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) + (v + w \\varepsilon) = \\begin{pmatrix} x+v \u0026amp; y+w \\\\ 0 \u0026amp; x+v \\end{pmatrix} \\end{aligned} $$\næ¸›ç®— - $$ \\begin{aligned} \\begin{pmatrix} a \u0026amp; b \\\\ c \u0026amp; d \\end{pmatrix} - \\begin{pmatrix} e \u0026amp; f \\\\ g \u0026amp; h \\end{pmatrix} = \\begin{pmatrix} a-e \u0026amp; b-f \\\\ c-g \u0026amp; d-h \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) + (v + w \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} - \\begin{pmatrix} v \u0026amp; w \\\\ 0 \u0026amp; v \\end{pmatrix} = \\begin{pmatrix} x-v \u0026amp; y-w \\\\ 0 \u0026amp; x-v \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) + (v + w \\varepsilon) = \\begin{pmatrix} x-v \u0026amp; y-w \\\\ 0 \u0026amp; x-v \\end{pmatrix} \\end{aligned} $$\nã‚¹ã‚«ãƒ©ãƒ¼å€ $$ \\begin{aligned} k(x + y \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} k \\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} = \\begin{pmatrix} kx \u0026amp; ky \\\\ 0 \u0026amp; kx \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} k(x + y \\varepsilon) = \\begin{pmatrix} kx \u0026amp; ky \\\\ 0 \u0026amp; kx \\end{pmatrix} \\end{aligned} $$\nä¹—ç®— * $$ \\begin{aligned} \\begin{pmatrix} a \u0026amp; b \\\\ c \u0026amp; d \\end{pmatrix} \\times \\begin{pmatrix} e \u0026amp; f \\\\ g \u0026amp; h \\end{pmatrix} = \\begin{pmatrix} ae + bg \u0026amp; af + bh \\\\ ce + dg \u0026amp; cf + dh \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) \\times (v + w \\varepsilon) \\end{aligned} $$\nã¯\n$$ \\begin{aligned} \\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} \\times \\begin{pmatrix} v \u0026amp; w \\\\ 0 \u0026amp; v \\end{pmatrix} = \\begin{pmatrix} xv \u0026amp; xw + yv \\\\ 0 \u0026amp; xv \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) \\times (v + w \\varepsilon) = \\begin{pmatrix} xv \u0026amp; xw + yv \\\\ 0 \u0026amp; xv \\end{pmatrix} \\end{aligned} $$\né€†è¡Œåˆ—(é™¤ç®— /) $$ \\begin{aligned} A = \\begin{pmatrix} a \u0026amp; b \\\\ c \u0026amp; d \\end{pmatrix}, \\qquad \\det(A) = ad - bc \\neq 0 \\end{aligned} $$\n$$ \\begin{aligned} A^{-1} = \\frac{1}{ad - bc} \\begin{pmatrix} d \u0026amp; -b \\\\ -c \u0026amp; a \\end{pmatrix} \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} (x + y \\varepsilon) \\div (v + w \\varepsilon) \\end{aligned} $$\nã¯$(v + w \\varepsilon)$ ã®é€†è¡Œåˆ—ã‚’æ±‚ã‚ã¦\n$$ \\begin{aligned} v^{2} \\neq 0 \\end{aligned} $$\nã‚ˆã‚Šå®Ÿéƒ¨$v \\neq 0$ ã®ã¨ã\n$$ \\begin{aligned} \u0026amp;\\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} \\times \\frac{1}{v^{2}} \\begin{pmatrix} v \u0026amp; -w \\\\ 0 \u0026amp; v \\end{pmatrix}\\\\ = \u0026amp;\\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} \\times \\begin{pmatrix} \\frac{1}{v} \u0026amp; -\\frac{w}{v^{2}} \\\\ 0 \u0026amp; \\frac{1}{v} \\end{pmatrix}\\\\ = \u0026amp;\\begin{pmatrix} \\frac{x}{v} \u0026amp; -\\frac{xw}{v^{2}}+\\frac{y}{v} \\\\ 0 \u0026amp; \\frac{x}{v} \\end{pmatrix}\\\\ = \u0026amp;\\begin{pmatrix} \\frac{x}{v} \u0026amp; \\frac{yv-xw}{v^{2}} \\\\ 0 \u0026amp; \\frac{x}{v} \\end{pmatrix} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} (x + y \\varepsilon) \\div (v + w \\varepsilon) = \\begin{pmatrix} \\frac{x}{v} \u0026amp; \\frac{yv-xw}{v^{2}} \\\\ 0 \u0026amp; \\frac{x}{v} \\end{pmatrix} \\end{aligned} $$\næŒ‡æ•°é–¢æ•° ä¸ãˆã‚‰ã‚ŒãŸ$x + \\varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\exp(x + \\varepsilon y) = \\exp(x) \\times \\exp(\\varepsilon y) \\end{aligned} $$\næŒ‡æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã$\\exp(X)$ã¯\n$$ \\begin{aligned} \\exp(X) = \\sum_{k=0}^{\\infty} \\frac{X^{k}}{k!} \\end{aligned} $$\nã§ã™ã€‚\nå®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾\n$$ \\exp(x) $$\nã¨ã™ã‚‹ã€‚\nåŒå¯¾æ•°$\\varepsilon y$ ã¯$\\varepsilon^{2} = 0$ã‚ˆã‚Š$k\\ge2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§\n$$ \\begin{aligned} \\exp(\\varepsilon y) = \\sum_{k=0}^{\\infty} \\frac{(\\varepsilon y)^{k}}{k!} = 1 + \\varepsilon y \\end{aligned} $$\nã«ãªã‚‹ã€‚\nã“ã‚Œã‚’ã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} \\exp(x + \\varepsilon y) = \\exp(x) \\times (1 + \\varepsilon y) = \\exp(x) + \\varepsilon y \\exp(x) \\end{aligned} $$\nã«ãªã‚Š\n$$ \\begin{aligned} \\exp(x + \\varepsilon y) = \\begin{pmatrix} \\exp(x) \u0026amp; y \\exp(x) \\\\ 0 \u0026amp; \\exp(x) \\end{pmatrix} \\end{aligned} $$\nã§ã‚ã‚‹ã€‚\nä¸‰è§’é–¢æ•°(sin,cos) ä¸ãˆã‚‰ã‚ŒãŸ$x + \\varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\næ­£å¼¦é–¢æ•°(sin)ã®å ´åˆ $$ \\begin{aligned} \\sin(x + \\varepsilon y) = \\sin(x)\\times\\cos(\\varepsilon y) + \\cos(x) \\times \\sin(\\varepsilon y) \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã®å ´åˆ $$ \\begin{aligned} \\cos(x + \\varepsilon y) = \\cos(x)\\times\\cos(\\varepsilon y) - \\sin(x) \\times \\sin(\\varepsilon y) \\end{aligned} $$\nä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$X$ã¨ã—ãŸã¨ã\næ­£å¼¦é–¢æ•°(sin)ã¯ $$ \\begin{aligned} \\sin(X) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k + 1)!} X^{2k+1} \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã¯ $$ \\begin{aligned} \\cos(X) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k)!} X^{2k} \\end{aligned} $$\næŒ‡æ•°é–¢æ•°ã®æ™‚ã¨åŒã˜ã‚ˆã†ã«ã€å®Ÿéƒ¨$x$ã¯ãã®ã¾ã¾\næ­£å¼¦é–¢æ•°(sin) $$ \\sin(x) $$\nä½™å¼¦é–¢æ•°(cos) $$ \\cos(x) $$\nã¨ã™ã‚‹ã€‚\nåŒå¯¾æ•°$\\varepsilon y$ ã¯$\\varepsilon^{2} = 0$ã‚ˆã‚Š$k\\ge1$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§\næ­£å¼¦é–¢æ•°(sin)ã¯ $$ \\begin{aligned} \\sin(\\varepsilon y) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k + 1)!} (\\varepsilon y)^{2k+1}=\\varepsilon y \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã¯ $$ \\begin{aligned} \\cos(\\varepsilon y) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(2k)!} (\\varepsilon y)^{2k} = 1 \\end{aligned} $$\nã‚ˆã£ã¦\næ­£å¼¦é–¢æ•°(sin)ã¯ $$ \\begin{aligned} \u0026amp;\\sin(x + \\varepsilon y)\\\\ = \u0026amp;\\sin(x)\\times\\cos(\\varepsilon y) + \\cos(x) \\times \\sin(\\varepsilon y)\\\\ = \u0026amp;\\sin(x) \\times 1 + \\cos(x) \\times \\varepsilon y \\\\ = \u0026amp;\\sin(x) + \\varepsilon y \\cos(x) \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos)ã¯ $$ \\begin{aligned} \u0026amp;\\cos(x + \\varepsilon y)\\\\ = \u0026amp;\\cos(x) \\times \\cos(\\varepsilon y) - \\sin(x) \\times \\sin(\\varepsilon y)\\\\ = \u0026amp;\\cos(x) \\times 1 - \\sin(x) \\times \\varepsilon y\\\\ = \u0026amp;\\cos(x) - \\varepsilon y \\sin(x) \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\næ­£å¼¦é–¢æ•°(sin) $$ \\begin{aligned} \\sin(x + \\varepsilon y) = \\begin{pmatrix} \\sin(x) \u0026amp; y \\cos(x) \\\\ 0 \u0026amp; \\sin(x) \\end{pmatrix} \\end{aligned} $$\nä½™å¼¦é–¢æ•°(cos) $$ \\begin{aligned} \\cos(x + \\varepsilon y) = \\begin{pmatrix} \\cos(x) \u0026amp; - y \\sin(x) \\\\ 0 \u0026amp; \\cos(x) \\end{pmatrix} \\end{aligned} $$\nä¸‰è§’é–¢æ•°(tan) $$ \\begin{aligned} \\tan(x + y \\varepsilon) = \\frac{\\sin(x + y\\varepsilon)}{\\cos(x + y\\varepsilon)} \\end{aligned} $$\nã«ã‚ˆã‚Šã€ä¸‰è§’é–¢æ•°(sin,cos)ã¨ä¹—ç®—ã¨é€†è¡Œåˆ—(é™¤ç®—)ã‚’å®Ÿè£…ã—ã¦ã€ãã‚Œã‚‰ã‚’åˆ©ç”¨ã“ã¨ã§æ¼”ç®—å¯èƒ½ã«ãªã‚‹ã€‚\nå¯¾æ•°é–¢æ•°(log) ä¸ãˆã‚‰ã‚ŒãŸ$x + \\varepsilon y$ã‚’æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\n$$ \\begin{aligned} x + y \\varepsilon = x \\times (1 + \\frac{y \\varepsilon}{x}) \\end{aligned} $$\nã‚ˆã‚Š\n$$ \\begin{aligned} \\log(x \\times (1 + \\frac{y \\varepsilon}{x})) = \\log(x) + \\log(1 + \\frac{y \\varepsilon} {x}) \\end{aligned} $$\nå¯¾æ•°é–¢æ•°ã¯ä¸ãˆã‚‰ã‚ŒãŸè¡Œåˆ—ã‚’$1 + X$ã¨ã—ãŸã¨ã$\\log(1 + X)$ã¯\n$$ \\begin{aligned} \\log(1 + X) = \\sum_{k=1}^{\\infty} \\frac{(-1)^{k+1}}{k} X^{k} \\end{aligned} $$\nã§ã™ã€‚\nå®Ÿæ•°éƒ¨åˆ†$x$ã¯ãã®ã¾ã¾\n$$ \\begin{aligned} \\log(x) \\end{aligned} $$\nã¨ã™ã‚‹ã€‚ åŒå¯¾æ•°$(1 + \\frac{y \\varepsilon}{x})$ ã¯$\\varepsilon^{2} = 0$ã‚ˆã‚Š$k \\ge 2$ã®ã¨ãã®é …ãŒ$0$ã«ãªã‚‹ã®ã§\n$$ \\begin{aligned} \\log(1 + \\frac{y \\varepsilon}{x}) = \\sum_{k=1}^{\\infty} \\frac{(-1)^{k+1}}{k} (\\frac{y \\varepsilon}{x})^{k} = \\frac{y \\varepsilon}{x} \\end{aligned} $$\nã‚ˆã£ã¦\n$$ \\begin{aligned} \\log(x \\times (1 + \\frac{y \\varepsilon}{x})) = \\log(x) + \\frac{y \\varepsilon}{x} \\end{aligned} $$\nã¾ã¨ã‚ã‚‹ã¨\n$$ \\begin{aligned} \\log(x + y \\varepsilon) = \\begin{pmatrix} \\log(x) \u0026amp; \\frac{y}{x} \\\\ 0 \u0026amp; \\log(x) \\end{pmatrix} \\end{aligned} $$\nç´¯ä¹—ï¼ˆpowerï¼‰ åŒå¯¾æ•°ã®ç´¯ä¹— $X^n$ ã‚’è¨ˆç®—ã™ã‚‹å ´åˆï¼ŒæŒ‡æ•° $n$ ãŒæ•´æ•°ã‹éæ•´æ•°ã‹ã§æ‰±ã„ãŒç•°ãªã‚Šã¾ã™ã€‚\n1. $n$ãŒæ•´æ•°ã®å ´åˆï¼ˆæ•´æ•°ä¹—ï¼‰\n$n = 0$ã®ã¨ã $$ \\begin{aligned} X^{0} = I \\end{aligned} $$\nï¼ˆå˜ä½è¡Œåˆ—ã‚’è¿”ã™ï¼‰\n$n \u0026gt; 0$ã®ã¨ã $$ \\begin{aligned} X^n = \\underbrace{X X \\cdots X}_{n\\ \\text{å›}} \\end{aligned} $$\nï¼ˆåå¾©ä¹—ç®—ï¼‰\n$n \u0026lt; 0$ ã®ã¨ã $$ \\begin{aligned} X^n = (X^{-1})^{|n|} \\end{aligned} $$\nï¼ˆé€†è¡Œåˆ—ã‚’ä½¿ã£ã¦æ­£ã®æŒ‡æ•°ã¨åŒæ§˜ã«è¨ˆç®—ï¼‰\n2. $n$ ãŒæ•´æ•°ã§ãªã„å ´åˆï¼ˆå®Ÿæ•°ä¹—ãƒ»éæ•´æ•°æŒ‡æ•°ï¼‰\nä¸€èˆ¬ã®å®Ÿæ•°æŒ‡æ•° $n$ ã«å¯¾ã—ã¦ã¯ï¼ŒæŒ‡æ•°é–¢æ•°ã¨å¯¾æ•°é–¢æ•°ã‚’ä½¿ã£ã¦\n$$ \\begin{aligned} X^n = \\exp\\bigl(n \\log X\\bigr) \\end{aligned} $$\nã¨å®šç¾©ã—ã¾ã™ã€‚\nã“ã‚Œã¯å®Ÿæ•°ã®ä¸–ç•Œã«ãŠã‘ã‚‹å®šç¾©\n$$ \\begin{aligned} x^n = \\exp\\bigl(n\\log x\\bigr) \\end{aligned} $$\nã®è¡Œåˆ—ç‰ˆã§ã™ã€‚\nåŒå¯¾æ•°ã¯è¡Œåˆ—ã§è¡¨ã›ã‚‹ã®ã§\nlog(X)ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®å¯¾æ•°ï¼‰ exp(n log(X))ï¼ˆä¸Šä¸‰è§’è¡Œåˆ—ã®æŒ‡æ•°ï¼‰ ãŒã™ã¹ã¦è¨ˆç®—å¯èƒ½ã«ãªã‚Šã€ä»»æ„å®Ÿæ•°æŒ‡æ•°ã®ç´¯ä¹—ã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚\nå¹³æ–¹æ ¹ï¼ˆSquare rootï¼‰ å¹³æ–¹æ ¹ã¯ç´¯ä¹—ã®ç‰¹åˆ¥ãªå ´åˆã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚\nã™ãªã‚ã¡\n$$ \\begin{aligned} \\sqrt{X} = X^{1/2} \\end{aligned} $$\nã§ã‚ã‚‹ãŸã‚ã€å‰ç¯€ã§å®šç¾©ã—ãŸç´¯ä¹—æ¼”ç®— $X^n$ ã‚’æŒ‡æ•° $n = 0.5$ ã¨ã—ã¦è©•ä¾¡ã™ã‚Œã°å¹³æ–¹æ ¹ãŒè¨ˆç®—ã§ãã¾ã™ã€‚\nè¡Œåˆ—è¡¨ç¾ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹ åŒå¯¾æ•°ã®è¡Œåˆ—è¡¨ç¾\n$$ \\begin{aligned} X = \\begin{pmatrix} x \u0026amp; y \\\\ 0 \u0026amp; x \\end{pmatrix} \\end{aligned} $$\nã«å¯¾ã—ã¦ã¯ï¼Œ\n$$ \\begin{aligned} X^{1/2} = \\begin{pmatrix} x^{1/2} \u0026amp; \\frac{1}{2} x^{-1/2} y \\\\ 0 \u0026amp; x^{1/2} \\end{pmatrix} \\end{aligned} $$\nã¨ãªã‚Šï¼Œã“ã‚Œã¯é€šå¸¸ã®å¹³æ–¹æ ¹ã®å¾®åˆ†æ³•å‰‡\n$$ \\begin{aligned} \\frac{d}{dx} \\sqrt{x} = \\frac{1}{2\\sqrt{x}} \\end{aligned} $$\nã¨ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚\nå®Ÿè£…ä¸Šã®å‡¦ç† $n = 0.5$ ã¨ã—ã¦ç´¯ä¹—æ¼”ç®— pow(X, n) ã‚’å‘¼ã³å‡ºã™ã ã‘ã§ã‚ˆã„ å†…éƒ¨ã§ã¯ æ•´æ•°æŒ‡æ•°ã‹ã©ã†ã‹ã‚’åˆ¤å®š éæ•´æ•°ãªã®ã§\n$$ \\begin{aligned} X^{0.5} = \\exp!\\left(0.5 \\log X\\right) \\end{aligned} $$ ã®å½¢ã§å‡¦ç†ã•ã‚Œã‚‹ ã“ã‚Œã«ã‚ˆã‚Šï¼ŒåŒå¯¾æ•°ã«å¯¾ã™ã‚‹å¹³æ–¹æ ¹ãŒè‡ªç„¶ã«è¨ˆç®—ã§ãã¾ã™ã€‚\nPython-FLINTã‚’ä½¿ã£ãŸåŒå¯¾æ•°ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ† åŒå¯¾æ•°ã‚’ä½¿ã£ãŸè‡ªå‹•å¾®åˆ†ã§ã¯\n$$ \\begin{aligned} x + \\varepsilon y \\end{aligned} $$\nã¨ã„ã†å½¢ã®æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€é–¢æ•°å€¤ã¨ãã®å¾®åˆ†å€¤ã‚’åŒæ™‚ã«è¨ˆç®—å‡ºæ¥ã¾ã™ã€‚\nã•ã‚‰ã«ã€å®Ÿæ•°éƒ¨ãƒ»å¾®åˆ†å€¤ã®è¨ˆç®—ã«**Python-FLINTã®arbå‹(å®Ÿæ•°ã®ãŸã‚ã®åŒºé–“æ¼”ç®—)**ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ä¸¸ã‚èª¤å·®ã‚’å«ã‚ãŸ ã€ŒçœŸã®å€¤ã‚’å¿…ãšå«ã‚€åŒºé–“ã€ã¨ã—ã¦ã®è‡ªå‹•å¾®åˆ†ã®çµæœ ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\næ¬¡ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€Python-FLINTã‚’ç”¨ã„ã¦ã€åŒå¯¾æ•°ã«ã‚ˆã‚Šè‡ªå‹•å¾®åˆ†ã‚’è¡Œã„ã¤ã¤ã€arbã«ã‚ˆã‚‹åŒºé–“ã§ç²¾åº¦ä¿è¨¼ã‚’è¡Œã†å®Ÿè£…ä¾‹ã§ã™ã€‚\nfrom flint import arb, ctx class DualArb: \u0026#34;\u0026#34;\u0026#34; Dual number over Arb: x + eps * dx (eps^2 = 0) val: arb â€” å®Ÿæ•°éƒ¨ x der: arb â€” å¾®åˆ†å€¤ dx \u0026#34;\u0026#34;\u0026#34; __slots__ = (\u0026#34;val\u0026#34;, \u0026#34;der\u0026#34;) def __init__(self, val=0, der=0): self.val = arb(val) self.der = arb(der) # --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ --- @staticmethod def lift(x): \u0026#34;\u0026#34;\u0026#34;ã‚¹ã‚«ãƒ©ãƒ¼ or DualArb ã‚’ DualArb ã«æŒã¡ä¸Šã’ã‚‹ã€‚\u0026#34;\u0026#34;\u0026#34; if isinstance(x, DualArb): return x return DualArb(x, 0) def copy(self): return DualArb(self.val, self.der) def __repr__(self): return f\u0026#34;DualArb(val={self.val}, der={self.der})\u0026#34; # --- å››å‰‡æ¼”ç®— --- def __add__(self, other): other = DualArb.lift(other) return DualArb(self.val + other.val, self.der + other.der) __radd__ = __add__ def __sub__(self, other): other = DualArb.lift(other) return DualArb(self.val - other.val, self.der - other.der) def __rsub__(self, other): other = DualArb.lift(other) return DualArb(other.val - self.val, other.der - self.der) def __neg__(self): return DualArb(-self.val, -self.der) def __mul__(self, other): other = DualArb.lift(other) # (x + eps dx)(y + eps dy) = xy + eps (x dy + y dx) val = self.val * other.val der = self.val * other.der + self.der * other.val return DualArb(val, der) __rmul__ = __mul__ def __truediv__(self, other): other = DualArb.lift(other) # (x + eps dx) / (y + eps dy) # = (x / y) + eps * ( (dx*y - x*dy) / y^2 ) inv = 1 / other.val val = self.val * inv der = (self.der * other.val - self.val * other.der) * (inv * inv) return DualArb(val, der) def __rtruediv__(self, other): # (a) / (x + eps dx) other = DualArb.lift(other) inv = 1 / self.val val = other.val * inv der = (other.der * self.val - other.val * self.der) * (inv * inv) return DualArb(val, der) # --- ç´¯ä¹— --- def __pow__(self, n): \u0026#34;\u0026#34;\u0026#34; (x + eps dx)^n, n ã¯ã‚¹ã‚«ãƒ©ãƒ¼ï¼ˆint/float/arbï¼‰ã ã‘å¯¾å¿œã€‚ d/dx x^n = n x^(n-1) ã‚’ä½¿ã†ã€‚ \u0026#34;\u0026#34;\u0026#34; if isinstance(n, DualArb): raise TypeError(\u0026#34;DualArb ** DualArb ã¯æœªå®Ÿè£…ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼æŒ‡æ•°ã ã‘å¯¾å¿œï¼‰ã€‚\u0026#34;) n_arb = arb(n) val = self.val ** n_arb der = n_arb * (self.val ** (n_arb - 1)) * self.der return DualArb(val, der) def __rpow__(self, base): \u0026#34;\u0026#34;\u0026#34; base ** (x + eps dx) = exp((x + eps dx) * log(base)) \u0026#34;\u0026#34;\u0026#34; base_arb = arb(base) if base_arb \u0026lt;= 0: raise ValueError(\u0026#34;base ã¯æ­£ã®å®Ÿæ•°ã«ã—ã¦ã­ï¼ˆlog ãŒå¿…è¦ã«ãªã‚‹ã®ã§ï¼‰ã€‚\u0026#34;) # f(x) = base^x, f\u0026#39;(x) = base^x * log(base) val = base_arb ** self.val der = val * self.der * base_arb.log() return DualArb(val, der) # --- elementary functions on DualArb --- def dual_exp(x): \u0026#34;\u0026#34;\u0026#34; exp(x + eps dx) = exp(x) + eps * dx * exp(x) \u0026#34;\u0026#34;\u0026#34; x = DualArb.lift(x) v = x.val.exp() return DualArb(v, x.der * v) def dual_log(x): \u0026#34;\u0026#34;\u0026#34; log(x + eps dx) = log(x) + eps * dx / x \u0026#34;\u0026#34;\u0026#34; x = DualArb.lift(x) return DualArb(x.val.log(), x.der / x.val) def dual_sin(x): \u0026#34;\u0026#34;\u0026#34; sin(x + eps dx) = sin(x) + eps * dx * cos(x) \u0026#34;\u0026#34;\u0026#34; x = DualArb.lift(x) return DualArb(x.val.sin(), x.der * x.val.cos()) def dual_cos(x): \u0026#34;\u0026#34;\u0026#34; cos(x + eps dx) = cos(x) - eps * dx * sin(x) \u0026#34;\u0026#34;\u0026#34; x = DualArb.lift(x) return DualArb(x.val.cos(), -x.der * x.val.sin()) def dual_tan(x): \u0026#34;\u0026#34;\u0026#34; tan = sin / cos ã§å®Ÿè£…ï¼ˆå®‰ç›´ç‰ˆï¼‰ \u0026#34;\u0026#34;\u0026#34; return dual_sin(x) / dual_cos(x) def dual_sqrt(x): \u0026#34;\u0026#34;\u0026#34; sqrt(x + eps dx) = sqrt(x) + eps * dx / (2 * sqrt(x)) \u0026#34;\u0026#34;\u0026#34; x = DualArb.lift(x) v = x.val.sqrt() return DualArb(v, x.der / (2 * v)) def differentiate(f, x0, dps=50): ctx.dps = dps x = DualArb(x0, 1) y = f(x) if not isinstance(y, DualArb): y = DualArb.lift(y) return y.val, y.der if __name__ == \u0026#34;__main__\u0026#34;: from flint import arb # f(x) ã‚’ DualArb ã§æ›¸ã def f(x: DualArb) -\u0026gt; DualArb: # f(x) = x^3 + 2 * sin(x) * exp(x) return x**3 + 2 * dual_sin(x) * dual_exp(x) # xã®å€¤ã¨ç²¾åº¦ã‚’å…¥åŠ› val, der = differentiate(f, x0=2, dps=80) # çµæœå‡ºåŠ› print(\u0026#34;-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› -------------------\u0026#34;) print(\u0026#34;f(x) =\u0026#34;, val) print(\u0026#34;f\u0026#39;(x) =\u0026#34;, der) # ã“ã“ã‹ã‚‰ã¯æ¤œç®—ç”¨ï¼ˆæ™®é€šã®arbã§è¨ˆç®—ï¼‰ # æ¤œç®—ç”¨ã® x ã® å€¤ã‚’arbã§å…¥åŠ› x = arb(2) f_exact = x**3 + 2 * x.sin() * x.exp() # f\u0026#39;(x) = 3x^2 + 2[cos x * e^x + sin x * e^x] fprime_exact = 3 * x**2 + 2 * (x.cos() * x.exp() + x.sin() * x.exp()) # æ¤œç®—å‡ºåŠ› print(\u0026#34;-------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› ---------------------\u0026#34;) print(\u0026#34;f(x) (exact-like) =\u0026#34;, f_exact) print(\u0026#34;f\u0026#39;(x) (exact-like) =\u0026#34;, fprime_exact) å®Ÿè¡Œçµæœ\n-------------- è‡ªå‹•å¾®åˆ†ã®çµæœå‡ºåŠ› ------------------- f(x) = [21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79] f\u0026#39;(x) = [19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79] -------------- æ¤œç®—ç”¨ã®çµæœå‡ºåŠ› --------------------- f(x) (exact-like) = [21.437699394856499942536605542730404247329089189979126594003547131771280961691209 +/- 4.59e-79] f\u0026#39;(x) (exact-like) = [19.287834753577782208311647433138084351108611465818774471674468084248344679936378 +/- 5.27e-79] ã¾ã¨ã‚ æœ¬è¨˜äº‹ã§ã¯ï¼ŒåŒå¯¾æ•°ï¼ˆDual numbersï¼‰ã‚’ç”¨ã„ãŸè‡ªå‹•å¾®åˆ†ã®ä»•çµ„ã¿ã«ã¤ã„ã¦\nåŒå¯¾æ•°ã®å®šç¾©ã¨ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã‹ã‚‰è¦‹ãŸåŸç† åŒå¯¾æ•°ã‚’ 2Ã—2 ä¸Šä¸‰è§’è¡Œåˆ—è¡¨ç¾ã«è½ã¨ã—è¾¼ã‚€æ–¹æ³• å››å‰‡æ¼”ç®—ï¼ˆåŠ ç®—ãƒ»æ¸›ç®—ãƒ»ä¹—ç®—ãƒ»é™¤ç®—ï¼‰ã®å…·ä½“çš„ãªå¼ exp, log, sin, cos, tan, ç´¯ä¹—ï¼Œå¹³æ–¹æ ¹ã¨ã„ã£ãŸåˆç­‰é–¢æ•°ã®æ‹¡å¼µæ–¹æ³• ãã‚Œã‚‰ã‚’åœŸå°ã«ã—ãŸå®Ÿè£…ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  ã¨ã„ã£ãŸæµã‚Œã§æ•´ç†ã—ã¾ã—ãŸã€‚\nåŒå¯¾æ•°ã‚’ä½¿ã†ã“ã¨ã§\né–¢æ•°å€¤ $f(x)$ ã¨å°é–¢æ•° $f\u0026rsquo;(x)$ ã‚’ 1 å›ã®è©•ä¾¡ã§åŒæ™‚ã«å¾—ã‚‰ã‚Œã‚‹ å·®åˆ†å¹… $h$ ã®èª¿æ•´ãŒä¸è¦ã§ï¼Œæ•°å€¤å¾®åˆ†ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚µã‚¤ã‚ºèµ·å› ã®èª¤å·®ãŒãªã„ å®Ÿè£…ã¯ã€Œã„ã¤ã‚‚ã®å®Ÿæ•°æ¼”ç®—ã€ã‚’ãã®ã¾ã¾åŒå¯¾æ•°ï¼ˆè¡Œåˆ—ï¼‰ã«æ‹¡å¼µã™ã‚‹ã ã‘ ã¨ã„ã£ãŸåˆ©ç‚¹ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\nã•ã‚‰ã«ï¼ŒPython-FLINT ã® arb å‹ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ï¼Œ\nå®Ÿæ•°éƒ¨ãƒ»å¾®åˆ†å€¤ã®ã©ã¡ã‚‰ã‚‚ ã€ŒçœŸå€¤ã‚’å«ã‚€åŒºé–“ã€ ã¨ã—ã¦è¡¨ç¾ã§ãã‚‹ ä¸¸ã‚èª¤å·®ã‚’å«ã‚ãŸ ç²¾åº¦ä¿è¨¼ä»˜ãè‡ªå‹•å¾®åˆ† ãŒå®Ÿç¾ã§ãã‚‹ ã¨ã„ã†ã¨ã“ã‚ã¾ã§åˆ°é”ã—ã¾ã—ãŸã€‚\næ•°å€¤å¾®åˆ†ãƒ»è‡ªå‹•å¾®åˆ†ã‚’ä¸¦ã¹ã¦è¦‹ãŸã¨ã\næ•°å€¤å¾®åˆ†ï¼šå®Ÿè£…ã¯ç°¡å˜ã ãŒï¼Œèª¤å·®ã¨ $h$ ã®é¸ã³æ–¹ã«æ‚©ã¾ã•ã‚Œã‚‹ è‡ªå‹•å¾®åˆ†ï¼šç²¾åº¦ä¿è¨¼ã«ã¯åŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã®ã¿ã§è‰¯ã„ ã¨ã„ã†æ€§è³ªã®é•ã„ãŒã‚ã‚Šã€ã¨ã¦ã‚‚æ°—æŒã¡ã®ã‚ˆã„æ‰‹æ³•ã ã¨æ„Ÿã˜ã¦ã‚‚ã‚‰ãˆãŸã‚‰å¬‰ã—ã„ã§ã™ã€‚\nã¾ãŸåŒå¯¾æ•°ã‚’ä½¿ã£ãŸè‡ªå‹•å¾®åˆ†ã¯\n$n$æ¬¡ã®è¶…åŒå¯¾æ•°ã«ã‚ˆã‚‹$n$éšå¾®åˆ†ã®è¨ˆç®— ã«ã‚‚ç™ºå±•ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n","permalink":"http://localhost:1313/posts/autodiff/","summary":"\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ’¡ \u003cstrong\u003eã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../float\"\u003e\u003cstrong\u003e1. æµ®å‹•å°æ•°ç‚¹æ•°\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../interval\"\u003e\u003cstrong\u003e2. åŒºé–“æ¼”ç®—\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalIntegration\"\u003e\u003cstrong\u003e3. æ•°å€¤ç©åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalDifferentiation\"\u003e\u003cstrong\u003e4. æ•°å€¤å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../autoDiff\"\u003e\u003cstrong\u003e5. è‡ªå‹•å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e \u003cstrong\u003eğŸ‘ˆ ä»Šã“ã“\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eè‡ªå‹•å¾®åˆ†(Automatic Differentiation,AD)\u003c/strong\u003e ã¯ã€é–¢æ•°ã‚’æ§‹æˆã™ã‚‹æ¼”ç®—ã‚’ãã®ã¾ã¾å¾®åˆ†ã¸æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã¨åŒæ™‚ã«å¾®åˆ†å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚\u003c/p\u003e","title":"è‡ªå‹•å¾®åˆ†"},{"content":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°\n2. åŒºé–“æ¼”ç®—\n3. æ•°å€¤ç©åˆ†\n4. æ•°å€¤å¾®åˆ† ğŸ‘ˆ ä»Šã“ã“\n5. è‡ªå‹•å¾®åˆ†\nã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚’ç”¨ã„ãŸå…·ä½“çš„ãªè¨ˆç®—ã«ã‚ˆã£ã¦é–¢æ•°ã®å‚¾ãã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã‚’æ•°å€¤å¾®åˆ†(numerical differentiation) ã¨å‘¼ã³ã¾ã™ã€‚\nå¾®åˆ†ã®å®šç¾©ãã®ã‚‚ã®ã¯æ¥µé™ã‚’ç”¨ã„ã¦è¡¨ã•ã‚Œã¾ã™ãŒã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã§ã¯ç„¡é™ã«å°ã•ã„å¤‰åŒ–é‡ã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚\nãã®ãŸã‚ã€æœ‰é™ã®å·®åˆ†ã‚’ç”¨ã„ã¦ã€Œå¾®åˆ†ã‚’è¿‘ä¼¼ã™ã‚‹ã€ æ–¹æ³•ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚\næ•°å€¤å¾®åˆ† ã¾ãšã€å¾®åˆ†ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚\n$$ \\begin{aligned} f^{\\prime}(x) = \\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h} \\end{aligned} $$\nã—ã‹ã—ã€å®Ÿéš›ã®è¨ˆç®—ã§ã¯$h$ã‚’ç„¡é™ã«å°ã•ãã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\nãã®ãŸã‚ã€æœ‰é™ã®å°ã•ãª$h$ã‚’ç”¨ã„ã¦å·®åˆ†ã«ã‚ˆã£ã¦è¿‘ä¼¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\næ•°å€¤å¾®åˆ†ã§ã‚ˆãç”¨ã„ã‚‰ã‚Œã‚‹å·®åˆ†è¿‘ä¼¼ã¨ã—ã¦\nå‰é€²å·®åˆ†(Forward Difference) å¾Œé€€å·®åˆ†(Backward Difference) ä¸­å¿ƒå·®åˆ†(Central Difference) ãŒã‚ã‚Šã¾ã™ã€‚\nhã®é¸ã³æ–¹ æ•°å€¤å¾®åˆ†ã§ã¯\n$h$ ãŒå¤§ãã„ $\\to$ é›¢æ•£åŒ–èª¤å·®ãŒå¤§ãã„ $h$ ãŒå°ã•ã™ãã‚‹ $\\to$ æµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã®ä¸¸ã‚ã«ã‚ˆã‚Šæƒ…å ±è½ã¡ãŒç™ºç”Ÿã—ã‚„ã™ã„ ã¨ã„ã†ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒã‚ã‚Šã¾ã™ã€‚\nãã“ã§ã€IEEE 754 ã®å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ã®æ©Ÿæ¢°ã‚¤ãƒ—ã‚·ãƒ­ãƒ³ $\\epsilon$ ã‚’ç”¨ã„ã‚‹ã¨ã€ ä¸¸ã‚èª¤å·®ã¨é›¢æ•£åŒ–èª¤å·®ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã¨ã‚‹ä»£è¡¨çš„ãªã‚¹ãƒ†ãƒƒãƒ—å¹…ã®é¸ã³æ–¹ã¨ã—ã¦\n$$ \\begin{aligned} h = \\sqrt{\\epsilon}\\max(1, |x|) \\end{aligned} $$\nãŒã‚ˆãç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚å€ç²¾åº¦ï¼ˆä»®æ•°éƒ¨ 52 bitï¼‰ã®å ´åˆã¯\n$$ \\begin{aligned} \\epsilon = 2^{-52} \\end{aligned} $$\nã¨ãªã‚Šã¾ã™ã€‚\nã“ã‚Œã¯ï¼Œ$x+h$ ã‚„ $x-h$ ã‚’è¨ˆç®—ã—ãŸã¨ãã«ï¼Œ ä¸¸ã‚èª¤å·®ã¨é›¢æ•£åŒ–èª¤å·®ã®å½±éŸ¿ãŒé‡£ã‚Šåˆã†ã‚ˆã†ã«é¸ã°ã‚ŒãŸã‚¹ãƒ†ãƒƒãƒ—å¹…ã§ã‚ã‚Šï¼Œ æ•°å€¤å¾®åˆ†ã«ãŠã„ã¦èª¤å·®ã‚’å°ã•ãæŠ‘ãˆã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚\nã•ã‚‰ã«é«˜ç²¾åº¦ã®æµ®å‹•å°æ•°ç‚¹æ•°ã‚’ç”¨ã„ã‚‹å ´åˆã«ã¯ã€ãã®ä»®æ•°éƒ¨ãƒ“ãƒƒãƒˆæ•°ã«å¿œã˜ã¦ã€$ x \\neq 0$ã®ã¨ã$\\epsilon = 2^{-52}$ã®$-52$ã®éƒ¨åˆ†ã‚’èª¿æ•´ã™ã‚Œã°ã‚ˆã„ã§ã™ã€‚\nã¾ãŸã€ã“ã®ã¨ãã®$x = 0$ã®ã¨ãã®$h = 2^{-52}$ ã«ã¤ã„ã¦ã‚‚ã€ä»»æ„ã§èª¿æ•´ã—ã¦ãã ã•ã„ã€‚\nå‰é€²å·®åˆ†(Forward Difference) $$ \\begin{aligned} f^{\\prime}(x) \u0026amp;\\approx \\frac{f(x + h) - f(x)}{h} \\\\ h \u0026amp;= \\sqrt{\\epsilon}\\max(1, |x|) \\end{aligned} $$\nå‰é€²å·®åˆ†ã®èª¤å·®ã¯$O(h)$ã§ã™ã€‚\nå¾Œé€€å·®åˆ†(Backward Difference) $$ \\begin{aligned} f^{\\prime}(x) \u0026amp;\\approx \\frac{f(x) - f(x - h)}{h} \\\\ h \u0026amp;= \\sqrt{\\epsilon}\\max(1, |x|) \\end{aligned} $$\nå¾Œé€€å·®åˆ†ã®èª¤å·®ã¯$O(h)$ã§ã™ã€‚\nä¸­å¿ƒå·®åˆ†(Central Difference) $$ \\begin{aligned} f^{\\prime}(x) \u0026amp;\\approx \\frac{f(x + h) - f(x - h)}{2h} \\\\ h \u0026amp;= \\sqrt{\\epsilon}\\max(1, |x|) \\end{aligned} $$\nä¸­å¿ƒå·®åˆ†ã®èª¤å·®ã¯$O(h^{2})$ã§ã‚ã‚Šã€å‰é€²å·®åˆ†ã‚„å¾Œé€€å·®åˆ†ã‚ˆã‚Šç²¾åº¦ãŒé«˜ãã€é€šå¸¸ã‚‚ã£ã¨ã‚‚ã‚ˆãåˆ©ç”¨ã•ã‚Œã‚‹å·®åˆ†è¿‘ä¼¼ã§ã™ã€‚\næ•°å€¤å¾®åˆ†ã®å®Ÿè£…ä¾‹ ã“ã“ã§ã¯ã€ç´¹ä»‹ã—ãŸä¸­ã§ã‚‚ã£ã¨ã‚‚ç²¾åº¦ã®è‰¯ã„ä¸­å¿ƒå·®åˆ†ã‚’ç”¨ã„ãŸæ•°å€¤å¾®åˆ†ã®å®Ÿè£…ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\nimport math # æµ®å‹•å°æ•°ç‚¹æ•°ã®æ©Ÿæ¢°ã‚¤ãƒ—ã‚·ãƒ­ãƒ³ # æµ®å‹•å°æ•°ç‚¹æ•°ã®ç²¾åº¦ã‚’ä¸Šã’ãŸå ´åˆã¯ã“ã“ã‚’å¤‰æ›´ EPS = 2.0**-52 # hã®å®šç¾© def step_size(x: float) -\u0026gt; float: return math.sqrt(EPS) * max(1.0, abs(x)) # æ•°å€¤å¾®åˆ†f\u0026#39;(x) def diff(f, x: float) -\u0026gt; float: h = step_size(x) # å‰é€²å·®åˆ† # return ((f(x + h)) - f(x)) / h # å¾Œé€€å·®åˆ† # return (f(x) - f(x - h)) / h # ä¸­å¿ƒå·®åˆ† return (f(x + h) - f(x - h)) / (2.0 * h) # f(x) ã®å®šç¾© def func(x) -\u0026gt; float: return x**2 + 3.0 x = 2.0 # f(x) ã¨ f\u0026#39;(x) ã®è¡¨ç¤º print(f\u0026#34;f({x:5.2f}) = {func(x):10.6f}\u0026#34;) print(f\u0026#34;f\u0026#39;({x:5.2f}) = {diff(func, x):10.6f}\u0026#34;) å®Ÿè¡Œçµæœ\nf( 2.00) = 7.000000 f\u0026#39;( 2.00) = 4.000000 ã¾ã¨ã‚ æ•°å€¤å¾®åˆ†ã¯ã€å¾®åˆ†ã®å®šç¾©ã«åŸºã¥ããªãŒã‚‰ã‚‚ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§ã¯æ‰±ãˆãªã„ã€Œæ¥µé™ã€ã‚’æœ‰é™å·®åˆ†ã§è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚\nç‰¹ã«ä¸­å¿ƒå·®åˆ†ã¯èª¤å·®ãŒå°ã•ãã€å®Ÿç”¨çš„ãªç²¾åº¦ã‚’å¾—ã‚„ã™ã„ãŸã‚ã‚ˆãç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚\nã¾ãŸã€ã‚¹ãƒ†ãƒƒãƒ—å¹…$h$ã¯æ•°å€¤å¾®åˆ†ã®ç²¾åº¦ã‚’æ±ºã‚ã‚‹é‡è¦ãªè¦ç´ ã§ã‚ã‚Šã€å¤§ãã™ãã¦ã‚‚å°ã•ã™ãã¦ã‚‚èª¤å·®ãŒå¢—ãˆã¦ã—ã¾ã„ã¾ã™ã€‚\nIEEE754ã®æ©Ÿæ¢°ã‚¤ãƒ—ã‚·ãƒ­ãƒ³ã‚’ç”¨ã„ãŸ\n$$ \\begin{aligned} h = \\sqrt{\\epsilon}\\max(1, |x|) \\end{aligned} $$\nã¨ã„ã†é¸ã³æ–¹ã¯ã€ä¸¸ã‚èª¤å·®ã¨é›¢æ•£åŒ–èª¤å·®ã®ãƒãƒ©ãƒ³ã‚¹ãŒã‚ˆãã€å¤šãã®å¿œç”¨ã§å®Ÿç”¨çš„ã§ã™ã€‚\nå®Ÿè£…ä¾‹ã¨ã—ã¦ä¸­å¿ƒå·®åˆ†ã‚’Pythonã§ç¤ºã—ã¾ã—ãŸãŒã€ã“ã‚Œã¯ä»–ã®è¨€èªã§ã‚‚åŒæ§˜ã®è€ƒãˆæ–¹ã§ä½¿ãˆã¾ã™ã€‚\næ•°å€¤å¾®åˆ†ã¯æ•°å€¤è§£æ³•ãƒ»æœ€é©åŒ–ãƒ»å¾®åˆ†æ–¹ç¨‹å¼ã®è¨ˆç®—ãªã©ã€å¤šãã®åˆ†é‡ã®åŸºç›¤ã¨ãªã‚‹é‡è¦ãªæŠ€æ³•ã§ã™ã€‚\n","permalink":"http://localhost:1313/posts/numericaldifferentiation/","summary":"\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ’¡ \u003cstrong\u003eã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../float\"\u003e\u003cstrong\u003e1. æµ®å‹•å°æ•°ç‚¹æ•°\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../interval\"\u003e\u003cstrong\u003e2. åŒºé–“æ¼”ç®—\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalIntegration\"\u003e\u003cstrong\u003e3. æ•°å€¤ç©åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalDifferentiation\"\u003e\u003cstrong\u003e4. æ•°å€¤å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e \u003cstrong\u003eğŸ‘ˆ ä»Šã“ã“\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../autoDiff\"\u003e\u003cstrong\u003e5. è‡ªå‹•å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003eã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚’ç”¨ã„ãŸå…·ä½“çš„ãªè¨ˆç®—ã«ã‚ˆã£ã¦é–¢æ•°ã®å‚¾ãã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã‚’\u003cstrong\u003eæ•°å€¤å¾®åˆ†(numerical differentiation)\u003c/strong\u003e ã¨å‘¼ã³ã¾ã™ã€‚\u003c/p\u003e","title":"æ•°å€¤å¾®åˆ†"},{"content":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°\n2. åŒºé–“æ¼”ç®—\n3. æ•°å€¤ç©åˆ† ğŸ‘ˆ ä»Šã“ã“\n4. æ•°å€¤å¾®åˆ†\n5. è‡ªå‹•å¾®åˆ†\nå¤šãã®ç©åˆ†ã¯ã€Œç´™ã¨ãƒšãƒ³ã€ã§ç°¡å˜ã«è¨ˆç®—ã§ãã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚\nå®Ÿéš›ã€ç©åˆ†ã®ä¸­ã«ã¯\nåŸå§‹é–¢æ•°ã‚’åˆç­‰é–¢æ•°ã§è¡¨ã›ãªã„ ã¨ã„ã£ãŸç†ç”±ã§ã€è§£æçš„ã«è§£ãã“ã¨ãŒé›£ã—ã„ã‚‚ã®ãŒå¤šæ•°å­˜åœ¨ã—ã¾ã™ã€‚\nãã®ãŸã‚ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚’ç”¨ã„ã¦ç©åˆ†ã‚’æ•°å€¤çš„ã«è¿‘ä¼¼ã—ã¦æ±‚ã‚ã‚‹æ‰‹æ³•(æ•°å€¤ç©åˆ†) ãŒé‡è¦ã«ãªã‚Šã¾ã™ã€‚\næ•°å€¤ç©åˆ†ã§ã¯ã€é–¢æ•°ã®å€¤ã‚’é›¢æ•£çš„ã«è©•ä¾¡ã—ã€ãã‚Œã‚‰ã‚’å°ã•ãªé¢ç©ã®ç·å’Œã¨ã—ã¦ç©ã¿ä¸Šã’ã‚‹ã“ã¨ã§ç©åˆ†ã‚’è¿‘ä¼¼ã—ã¾ã™ã€‚\næ•°å€¤ç©åˆ†(Numerical Integration) ä¸ãˆã‚‰ã‚ŒãŸé–¢æ•°ã®å®šç©åˆ†ã®å€¤ã‚’ã€è§£æçš„(ç´™ã¨ãƒšãƒ³ã‚’ä½¿ã£ã¦å¼å¤‰å½¢ãªã©ã‚’è¡Œã†å³å¯†ãªè¨ˆç®—) ã§ã¯ãªãã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚’ä½¿ã£ã¦æ•°å€¤çš„ã«è¿‘ä¼¼å€¤ã‚’æ±‚ã‚ã‚‹æ–¹æ³•ã‚’æ•°å€¤ç©åˆ†(Numerical Integration) ã¨å‘¼ã³ã¾ã™ã€‚\nç‰¹ã«æ¬¡ã®ã‚ˆã†ãªå ´åˆã«æœ‰åŠ¹ã§ã™\nè§£æçš„ã«ç©åˆ†ã§ããªã„é–¢æ•°ã‚’æ‰±ã„ãŸã„ã¨ã é–¢æ•°ãŒè¤‡é›‘ã§å³å¯†ãªè§£ã‚’æ±‚ã‚ã‚‹ã®ãŒå›°é›£ãªã¨ã é–¢æ•°ã®å¼ãŒãªãã€é›¢æ•£çš„ãªãƒ‡ãƒ¼ã‚¿ç‚¹ã—ã‹å­˜åœ¨ã—ãªã„ã¨ã ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¯ç¹°ã‚Šè¿”ã—ã®è¨ˆç®—ã‚’é«˜é€Ÿã‹ã¤æ­£ç¢ºã«è¡Œã†ã“ã¨ãŒå¾—æ„ã§ã™ã€‚\nç©åˆ†åŒºé–“ã‚’ç´°ã‹ã„åŒºé–“ã«åˆ†å‰²ã—ã€ãã‚Œãã‚Œã®éƒ¨åˆ†ã®é¢ç©ã‚’æ±‚ã‚ã¦è¶³ã—åˆã‚ã›ã‚‹å‡¦ç†ã‚‚ç´ æ—©ãè¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚\nè§£æçš„ã«ç©åˆ†ãŒå‡ºæ¥ãªã„ä¾‹ è§£æçš„ã«ç©åˆ†ã™ã‚‹ã“ã¨ãŒå›°é›£ãªä¾‹ã¨ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªç©åˆ†ãŒã‚ã‚Šã¾ã™ã€‚\n$$ \\begin{aligned} \\int^{\\frac{\\pi}{2}}_{0} \\frac{d \\theta}{\\sqrt{1 - 0.5 \\sin^{2} \\theta }} \\end{aligned} $$\nã“ã®ç©åˆ†ã®è¢«ç©åˆ†é–¢æ•°ã¯ã€åˆç­‰é–¢æ•°ã§è¡¨ç¾ã§ãã‚‹åŸå§‹é–¢æ•°ã‚’æŒã¡ã¾ã›ã‚“ã€‚\nã“ã®ã‚¿ã‚¤ãƒ—ã®ç©åˆ†ã¯æ•°å­¦çš„ã«ç‰¹åˆ¥ãªå½¢ã‚’ã—ã¦ãŠã‚Šã€å®Ÿã¯æ¥•å††ç©åˆ†(Elliptic Integral) ã¨å‘¼ã°ã‚Œã‚‹ã€Œç‰¹æ®Šé–¢æ•°ã€ã«åˆ†é¡ã•ã‚Œã‚‹ã‚‚ã®ã§ã™ã€‚\nã¤ã¾ã‚Šã€æ™®é€šã®é–¢æ•°(å¤šé …å¼ãƒ»æŒ‡æ•°é–¢æ•°ãƒ»ä¸‰è§’é–¢æ•°ãªã©)ã‚’ã©ã‚Œã ã‘çµ„ã¿åˆã‚ã›ã¦ã‚‚ã€åŸå§‹é–¢æ•°ã‚’è¡¨ç¾ã™ã‚‹ã“ã¨ã¯ã§ããªã„ãŸã‚ã€è§£æçš„ã«è§£ãã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚\nãã®ãŸã‚ã€å€¤ã‚’æ±‚ã‚ã‚‹æ–¹æ³•ã®ä¸€ã¤ã¨ã—ã¦\næ•°å€¤ç©åˆ†ã‚’ç”¨ã„ã¦è¿‘ä¼¼å€¤ã‚’æ±‚ã‚ã‚‹ ãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nè§£æçš„ã«ç©åˆ†ã§ãã‚‹é–¢æ•°ã¯æ„å¤–ã¨é™ã‚‰ã‚Œã¦ãŠã‚Šã€ç¾ä»£ã§ã¯æ•°å€¤ç©åˆ†ãŒæ¥µã‚ã¦é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚\næ•°å€¤ç©åˆ†æ³• ã“ã®è¨˜äº‹ã§ã¯æ¬¡ã®æ•°å€¤ç©åˆ†æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\nå°å½¢å…¬å¼(Trapezoidal Rule) äºŒé‡æŒ‡æ•°é–¢æ•°å‹ç©åˆ†å…¬å¼(DoubleExponentialFormula) å°å½¢å…¬å¼ã¯æœ€ã‚‚åŸºæœ¬çš„ã§ç†è§£ã—ã‚„ã™ã„æ•°å€¤ç©åˆ†æ³•ã§ã‚ã‚Šã€å¤šãã®æ‰‹æ³•ã®åŸºç¤ã¨ãªã‚Šã¾ã™ã€‚\nä¸€æ–¹ã€DEæ³•(äºŒé‡æŒ‡æ•°é–¢æ•°å‹ç©åˆ†å…¬å¼)ã¯ã€ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ã«ç‰¹ç•°ç‚¹(é–¢æ•°å€¤ãŒç„¡é™å¤§ã«ç™ºæ•£ã™ã‚‹ç‚¹) ã‚’æŒã¤é–¢æ•°ã«å¯¾ã—ã¦ã‚‚é«˜ç²¾åº¦ãªçµæœã‚’å¾—ã‚‰ã‚Œã‚‹å¼·åŠ›ãªæ‰‹æ³•ã§ã™ã€‚\nãã‚Œãã‚Œã®æ‰‹æ³•ã®ç‰¹å¾´ãƒ»åˆ©ç‚¹ã«ã¤ã„ã¦ã€ã‚ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¦ã„ãã¾ã™ã€‚\nå°å½¢å…¬å¼(Trapezoidal Rule) å°å½¢å…¬å¼ã¯ã€å°å½¢ã®é¢ç©ã‚’æ±‚ã‚ã‚‹å…¬å¼\n$$ \\begin{aligned} \\frac{(\\text{ä¸Šåº•} + \\text{ä¸‹åº•}) \\times \\text{é«˜ã•}}{2} \\end{aligned} $$\nã«åŸºã¥ã„ã¦ã€å®šç©åˆ†ã®å€¤ã‚’å°å½¢ã®é¢ç©ã®å’Œã¨ã—ã¦è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚\nç©åˆ†åŒºé–“ã‚’ã„ãã¤ã‹ã®å°ã•ãªåŒºé–“ã«åˆ†å‰²ã—ã€å„åŒºé–“ã§é–¢æ•°ã®å€¤ã‚’ã€Œä¸Šåº•ã€ã¨ã€Œä¸‹åº•ã€ ã€å°åŒºé–“ã®åŒºé–“å¹…ã‚’ã€Œé«˜ã•ã€ ã¨ã¿ãªã™ã“ã¨ã§ã€æ›²ç·šã®ã‚ã‚‹é¢ç©ã‚’å°å½¢ã®é›†ã¾ã‚Šã¨ã—ã¦è¿‘ä¼¼ã—ã¾ã™ã€‚\nè¤‡åˆå°å½¢å…¬å¼(Composite Trapezoidal Rule) ç©åˆ†åŒºé–“$[a,b]$ã‚’ç­‰é–“éš”ã®å°åŒºé–“ã«åˆ†å‰²ã—ã€ãã®å„åŒºé–“ã«ç©åˆ†å‰‡ã‚’é©ç”¨ã™ã‚‹æ–¹æ³•ã‚’è¤‡åˆå‰‡ã¨å‘¼ã³ã¾ã™ã€‚\nç‰¹ã«ã€å„å°åŒºé–“ã«å°å½¢å…¬å¼ã‚’é©ç”¨ã—ã€ãã‚Œã‚‰ã‚’è¶³ã—åˆã‚ã›ãŸã‚‚ã®ã‚’è¤‡åˆå°å½¢å…¬å¼(Composite Trapezoidal Rule) ã¨ã„ã„ã¾ã™ã€‚\nç©åˆ†åŒºé–“ã‚’$n$å€‹ã®ç­‰é–“éš”ã®å°åŒºé–“ã«åˆ†å‰²ã—ã€å„åŒºé–“ã«å°å½¢å…¬å¼ã‚’é©ç”¨ã—ã¦å¾—ã‚‰ã‚Œã‚‹è¿‘ä¼¼å€¤ã‚’$T_{n}$ã¨ã™ã‚‹ã¨\n$$ \\begin{aligned} \\int_{a}^{b} f(x)dx \\approx T_{n} \\end{aligned} $$\nã¨ãªã‚Šã¾ã™ã€‚\n$T_{n}$ã®å…·ä½“çš„ãªå¼ å°åŒºé–“(åˆ»ã¿å¹…)ã‚’\n$$ \\begin{aligned} h = \\frac{b - a}{ n } \\end{aligned} $$\nã¨ã™ã‚‹ã¨ã€è¤‡åˆå°å½¢å…¬å¼ã¯æ¬¡ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™ã€‚\n$$ \\begin{aligned} T_{n} \\approx h \\times ( \\frac{f(a)}{2} + \\sum_{i=1}^{n-1}f( a + hi ) + \\frac{f(b)}{2} ) \\end{aligned} $$\nã“ã“ã§\n$$ \\begin{aligned} \\frac{f(a)}{2} + \\sum_{i=1}^{n-1}f( a + hi ) + \\frac{f(b)}{2} \\end{aligned} $$\nã¯å…¨ã¦ã®å°å½¢ã®ä¸Šåº•ã¨ä¸‹åº•ã®ç·å’Œã«å¯¾å¿œã—\n$$ \\begin{aligned} h \\end{aligned} $$\nã¯å°å½¢ã®é«˜ã•ã«å¯¾å¿œã—ã¾ã™ã€‚\né›¢æ•£åŒ–(Discretization) ã“ã®ã‚ˆã†ã«ã€å…ƒã€…é€£ç¶šçš„ãªå€¤ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹é–¢æ•°$f(x)$ã‚’\n$$ \\begin{aligned} f(a) \\quad,\\quad f(a + h) \\quad,\\quad f(a + 2h) \\quad,\\quad \\dots \\quad,\\quad f(b) \\end{aligned} $$\nã¨ã„ã†é›¢æ•£çš„ãªç‚¹ã«ã‚ˆã£ã¦è¿‘ä¼¼çš„ã«æ‰±ã†ã“ã¨ã‚’é›¢æ•£åŒ–(Discretization) ã¨å‘¼ã³ã¾ã™ã€‚\nå°å½¢å…¬å¼ã®å®Ÿè£… æ¬¡ã®Pythonã®ä¾‹ã¯ã€è¤‡åˆå°å½¢å…¬å¼ã‚’ç”¨ã„ã¦\n$$ \\begin{aligned} \\int_{0}^{1} x\\exp(x)dx = 1 \\end{aligned} $$\nã®å®šç©åˆ†ã‚’è¿‘ä¼¼ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ãŸã‚‚ã®ã§ã™ã€‚\nimport numpy as np # è¢«ç©åˆ†é–¢æ•° f(x) = x * exp(x) def f(x): return x * np.exp(x) # è¤‡åˆå°å½¢å…¬å¼ def trapezoidal_rule(f, a, b, n): h = (b - a) / n # aã‹ã‚‰bã¾ã§n+1å€‹ã®ç­‰é–“éš”ã®ç‚¹ã‚’ç”Ÿæˆ x = np.linspace(a, b, n + 1) y = f(x) # y[0]ã¨y[-1]ã¯ç«¯ç‚¹ã®é–¢æ•°å€¤ã€f(a)ã¨f(b) # [1:-1](a\u0026lt;b)ã®ç¯„å›²ã®ç‚¹ã§ã®é–¢æ•°å€¤ã®å’Œã‚’è¨ˆç®— approx = h * (0.5 * y[0] + y[1:-1].sum() + 0.5 * y[-1]) return approx def main(): a, b = 0.0, 1.0 # ç©åˆ†åŒºé–“ # çœŸå€¤ (è§£æçš„ã«æ±‚ã‚ãŸã¨ãã®å€¤) true_value = 1.0 # åˆ†å‰²æ•°nã®ãƒªã‚¹ãƒˆ n_values = [2, 4, 8, 16, 32, 64, 128] print(\u0026#34;f(x) = x * exp(x) on [0, 1]\u0026#34;) print(\u0026#34;n\\t approx\\t\\t error\u0026#34;) print(\u0026#34;-\u0026#34; * 35) for n in n_values: approx = trapezoidal_rule(f, a, b, n) error = abs(true_value - approx) print(f\u0026#34;{n}\\t {approx:.10f}\\t {error:.2e}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() å®Ÿè¡Œçµæœ\nf(x) = x * exp(x) on [0, 1] n approx error ----------------------------------- 2 1.0917507748 9.18e-02 4 1.0230644791 2.31e-02 8 1.0057741074 5.77e-03 16 1.0014440271 1.44e-03 32 1.0003610380 3.61e-04 64 1.0000902615 9.03e-05 128 1.0000225655 2.26e-05 åˆ†ç‚¹æ•°$n$ã‚’å¢—ã‚„ã—åˆ»ã¿å¹…$h$ã‚’ç´°ã‹ãã™ã‚‹ã«ã¤ã‚Œã¦ã€å°å½¢å…¬å¼ã®è¿‘ä¼¼å€¤ãŒçœŸå€¤1ã«åæŸã—ã¦ã„ãæ§˜å­ãŒã‚ˆãã‚ã‹ã‚Šã¾ã™ã€‚\næ•°å€¤ç©åˆ†ã§ã¯ã€ä¸€èˆ¬ã«åˆ†ç‚¹æ•°ã‚’å¢—ã‚„ã™ã“ã¨ã§ç²¾åº¦ã‚’ä¸Šã’ã‚‹ã¨ã„ã†ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ã¨ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€åˆ†å‰²æ•°ã‚’å¢—ã‚„ã›ã°ãã®åˆ†ã ã‘è¨ˆç®—å›æ•°ã‚‚å¢—åŠ ã—ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã§ã¯ä¸¸ã‚èª¤å·®ãŒè“„ç©ã—ã¦ã—ã¾ã„ã¾ã™ã€‚\nã—ãŸãŒã£ã¦ã€å˜ç´”ã«åˆ†å‰²æ•°ã‚’å¢—ã‚„ã™ã ã‘ã§ã¯é™ç•ŒãŒã‚ã‚Šã€åˆ†ç‚¹æ•°ã‚’å¢—ã‚„ã—ãŸæ™‚ã«é«˜é€Ÿã«åæŸã™ã‚‹é«˜ç²¾åº¦ãªç©åˆ†æ³•ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚\nãã®ä»£è¡¨çš„ãªæ‰‹æ³•ãŒDEå…¬å¼(Double Exponential Formula, äºŒé‡æŒ‡æ•°é–¢æ•°å‹ç©åˆ†å…¬å¼) ã§ã™ã€‚\näºŒé‡æŒ‡æ•°é–¢æ•°å‹ç©åˆ†å…¬å¼(Double Exponential Formula) äºŒé‡æŒ‡æ•°é–¢æ•°å‹ç©åˆ†å…¬å¼(DEå…¬å¼)ã¯ã€å°å½¢å…¬å¼ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãªãŒã‚‰ã‚‚ã€ç‰¹åˆ¥ãªå¤‰æ•°å¤‰æ›ã‚’è¡Œã†ã“ã¨ã§éå¸¸ã«é«˜é€ŸãªåæŸ ã‚’å®Ÿç¾ã™ã‚‹ç©åˆ†æ³•ã§ã™ã€‚\nå¾“æ¥ã®æ•°å€¤ç©åˆ†æ³•ã¨æ¯”ã¹ã€æ¬¡ã®ã‚ˆã†ãªå¤§ããªãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚\nåˆ†ç‚¹æ•°ã‚’å¢—ã‚„ã—ãŸéš›ã®åæŸãŒéå¸¸ã«é€Ÿãã€é«˜ç²¾åº¦ãªçµæœãŒå¾—ã‚‰ã‚Œã‚‹ è¢«ç©åˆ†é–¢æ•°ãŒç©åˆ†åŒºé–“ã®ç«¯ç‚¹(ç„¡é™ã«ç™ºæ•£ã™ã‚‹ç‚¹)ã‚’æŒã£ã¦ã„ã¦ã‚‚é©ç”¨ã§ãã‚‹ ç„¡é™åŒºé–“ã‚„åŠç„¡é™åŒºé–“ã®ç©åˆ†ã«ã‚‚è‡ªç„¶ã«æ‹¡å¼µã§ãã‚‹ ã“ã‚Œã‚‰ã®ç‰¹æ€§ã«ã‚ˆã‚Šã€DEå…¬å¼ã¯ç¾ä»£ã®æ•°å€¤ç©åˆ†æ‰‹æ³•ã®ä¸­ã§ã‚‚ç‰¹ã«å¼·åŠ›ã§ã€ç§‘å­¦æŠ€è¡“è¨ˆç®—ã‚„çµ±è¨ˆã€è¨ˆç®—ç‰©ç†ãªã©å¹…åºƒã„åˆ†é‡ã§ç”¨ã„ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\nDEå…¬å¼(Double Exponential Formula)ã®è¨ˆç®—æ‰‹é † DEå…¬å¼ã¯ã€ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ã«ç‰¹ç•°æ€§ã‚’æŒã¤é–¢æ•°ã‚„ã€ç„¡é™åŒºé–“ã®ç©åˆ†ã‚’é«˜ç²¾åº¦ã§è¨ˆç®—ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªæ‰‹æ³•ã§ã™ã€‚\nãã®è¨ˆç®—ã¯æ¬¡ã®2æ®µéšã§è¡Œã‚ã‚Œã¾ã™ã€‚\nå…ƒã®ç©åˆ†ã«å¯¾ã—ã¦å¤‰æ•°å¤‰æ›ï¼ˆDEå¤‰æ›ï¼‰ã‚’è¡Œã†\nå¤‰æ•°å¤‰æ› $x = \\phi(t)$ ã«ã‚ˆã‚Šã€ç©åˆ†åŒºé–“ã‚’ $(-\\infty, \\infty)$ ã«å†™ã™ã€‚ ã‚‚ã¨ã®ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ã«ã‚ã‚‹ç‰¹ç•°æ€§ã¯ã€å¤‰æ•°å¤‰æ›å¾Œã«ã¯ã€Œç„¡é™é ç‚¹ï¼ˆéå¸¸ã«é ã„ä½ç½®ï¼‰ã€ã¸æŠ¼ã—å‡ºã•ã‚Œã‚‹ã€‚ å¤‰æ•°å¤‰æ›å¾Œã®ç©åˆ†ã«å°å½¢å‰‡ã‚’é©ç”¨ã™ã‚‹\nå¤‰æ›å¾Œã®è¢«ç©åˆ†é–¢æ•°ã¯ã€$|t|$ ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ äºŒé‡æŒ‡æ•°çš„ã«æ¸›è¡°ï¼ˆæ€¥æ¿€ã« 0 ã«è¿‘ã¥ãï¼‰ ã€‚ ã“ã®ãŸã‚ã€å°å½¢å‰‡ã«ã‚ˆã‚‹æ•°å€¤ç©åˆ†ã®åæŸãŒéå¸¸ã«é€Ÿããªã‚‹ã€‚ å¤‰æ•°å¤‰æ›ã«ã‚ˆã£ã¦ç©åˆ†ã¯æ¬¡ã®å½¢ã«ãªã‚‹\n$$ \\begin{aligned} \\int_{a}^{b} f(x)dx = \\int_{-\\infty}^{\\infty} f(\\phi(t))\\phi^{\\prime}(t) dt \\end{aligned} $$\nã“ã®ç©åˆ†ã«å°å½¢å‰‡ã‚’é©ç”¨ã™ã‚‹ã¨\n$$ \\begin{aligned} \\int_{a}^{b} f(x)dx \u0026amp;\\approx h \\sum_{i=-n}^{n} f(\\phi(ih))\\phi^{\\prime}(ih)\\\\ h \u0026amp;= \\frac{\\log(3n)}{n} \\end{aligned} $$\nå¤‰æ›å¾Œã®å¤‰æ•°ã®é«˜é€Ÿãªæ¸›è¡°ã«ã‚ˆã£ã¦æ¥µã‚ã¦ç²¾åº¦ã®é«˜ã„æ•°å€¤ç©åˆ† ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\nDEå¤‰æ› æœ‰é™åŒºé–“$[a,b]$ ç©åˆ†åŒºé–“ãŒæœ‰é™ãªåŒºé–“$[a,b]$ã§ã‚ã‚‹å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«å¤‰æ›ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\int_{a}^{b} f(x)dx \u0026amp;= \\int_{-\\infty}^{\\infty} f(\\phi(t))\\phi^{\\prime}(t) dt\\\\ \\phi(t) \u0026amp;= \\frac{b - a}{2} \\tanh(\\frac{\\pi}{2}\\sinh(t)) + \\frac{a + b}{2}\\\\ \\phi^{\\prime}(t) \u0026amp;= \\frac{b - a}{4} \\frac{\\pi \\cosh(t)}{\\cosh^{2}(\\frac{\\pi}{2}\\sinh(t))} \\end{aligned} $$\n$\\phi(t)$ ã¯\n$$ \\begin{aligned} \\phi(t) \\to a\\qquad \u0026amp;,\\qquad(t \\to -\\infty)\\\\ \\phi(t) \\to b\\qquad \u0026amp;,\\qquad(t \\to \\infty) \\end{aligned} $$\nã®ã‚ˆã†ã«ã€$ t \\to -\\infty $ ã§ $a$ã€$ t \\to +\\infty $ ã§ $b$ ã«è¿‘ã¥ãã¾ã™ã€‚\nã¾ãŸã€è¢«ç©åˆ†é–¢æ•°ã®ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ã«ã‚ã‚‹ç‰¹ç•°ç‚¹ã‚’ã€Œç„¡é™é ã¸æŠ¼ã—å‡ºã™ã€æœ¬å½“ã®ç†ç”±ã¯ $\\phi^{\\prime}(t)$ ã«ã‚ã‚Šã¾ã™ã€‚\n$\\phi^{\\prime}(t)$ ã¯ $|t| \\to \\infty$ ã§äºŒé‡æŒ‡æ•°çš„(ã‹ãªã‚Šæ€¥æ¿€) ã« $0$ ã«æ¸›è¡°ã—ã¾ã™ã€‚\nãã®ãŸã‚ã€å…ƒã€…ã¯ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ $(a, b)$ ã«å­˜åœ¨ã—ã¦ã„ãŸç‰¹ç•°æ€§ã¯ã€å¤‰æ›å¾Œã®ç©åˆ†ã§ã¯ã€Œç„¡é™é ã«æŠ¼ã—å‡ºã•ã‚Œã€ç©åˆ†ã«ã»ã¨ã‚“ã©å¯„ä¸ã—ãªã„ã€ã¨ã„ã†æ‰±ã„ã‚„ã™ã„å½¢ã¸å¤‰æ›ã•ã‚Œã¾ã™ã€‚\næ¡è½ã¡ã§çµæœãŒNaNã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ ã“ã®å¼ã¯$t \\to -\\infty$ã§äºŒé‡æŒ‡æ•°çš„(ã‹ãªã‚Šæ€¥æ¿€)ã« $-1$ã¸è¿‘ã¥ã„ã¦ã€$t \\to \\infty$ã§äºŒé‡æŒ‡æ•°çš„(ã‹ãªã‚Šæ€¥æ¿€)ã« $1$ã¸è¿‘ã¥ã„ã¦ã„ãã¾ã™ã€‚\n$$ \\begin{aligned} \\tanh(\\frac{\\pi}{2}\\sinh(t)) \\end{aligned} $$\nãã®ãŸã‚\n$$ \\begin{aligned} \\tanh(u) \u0026amp;- 1\\\\ \\tanh(u) \u0026amp;+ 1 \\end{aligned} $$\nã®ã‚ˆã†ãªå¼ãŒ æµ®å‹•å°æ•°ç‚¹ã®æ¡è½ã¡ ã‚’å¼•ãèµ·ã“ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nå°å½¢æ¸¬ã®ãƒ«ãƒ¼ãƒ—ã®ä¸­ã§ãƒ«ãƒ¼ãƒ—ã®ç«¯ç‚¹ä»˜è¿‘ã§æ¡è½ã¡ãŒç™ºç”Ÿã—ãŸã“ã¨ã§ã€çµæœãŒNaNã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚\næ¡è½ã¡ãŒç™ºç”Ÿã—ãŸå ´åˆã®å¯¾å‡¦æ³•ã¨ã—ã¦ã€$\\tanh(\\frac{\\pi}{2}\\sinh(t))-1$ã¾ãŸã¯$\\tanh(\\frac{\\pi}{2}\\sinh(t))+1$ã®ã‚ˆã†ãªå½¢ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€å¼å¤‰å½¢ã‚’è¡Œã†ã“ã¨ã§å¯¾å‡¦ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nã¾ãŸã€ã“ã“ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ç‰¹æ®Šé–¢æ•°$\\sinh(x)$ã€$\\cosh(x)$ã€$\\tanh(x)$ã¯åŒæ›²ç·šé–¢æ•°(hyperbolic function) ã¨ã‚ˆã°ã‚Œã€ãã‚Œãã‚Œæ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚\n$$ \\begin{aligned} \\sinh(x) \u0026amp;= \\frac{\\exp(x) - \\exp(-x)}{2}\\\\ \\cosh(x) \u0026amp;= \\frac{\\exp(x) + \\exp(-x)}{2}\\\\ \\tanh(x) \u0026amp;= \\frac{\\sinh(x)}{\\cosh(x)} = \\frac{\\exp(x) - \\exp(-x)}{\\exp(x) + \\exp(-x)} \\end{aligned} $$\nåŠç„¡é™åŒºé–“$[a,\\infty)$ ç©åˆ†åŒºé–“ãŒåŠç„¡é™åŒºé–“$[a,\\infty)$ã§ã‚ã‚‹å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«å¤‰æ›ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\int_{a}^{\\infty} f(x)dx \u0026amp;= \\int_{-\\infty}^{\\infty} f(\\phi(t))\\phi^{\\prime}(t) dt\\\\ \\phi(t) \u0026amp;= a + \\exp(\\frac{\\pi}{2}\\sinh(t))\\\\ \\phi^{\\prime}(t) \u0026amp;= \\frac{\\pi}{2}\\cosh(t)\\exp(\\frac{\\pi}{2}\\sinh(t)) \\end{aligned} $$\n$\\phi(t)$ ã¯\n$$ \\begin{aligned} \\phi(t) \\to a\\qquad \u0026amp;,\\qquad(t \\to -\\infty)\\\\ \\phi(t) \\to \\infty\\qquad \u0026amp;,\\qquad(t \\to \\infty) \\end{aligned} $$\nã®ã‚ˆã†ã«ã€$ t \\to -\\infty $ ã§ $a$ã€$ t \\to +\\infty $ ã§ $\\infty$ ã«è¿‘ã¥ãã¾ã™ã€‚\nç©åˆ†åŒºé–“ãŒ$(\\infty,b]$ã®å ´åˆ $$ \\begin{aligned} \\int_{a}^{b} f(x)dx = -\\int_{b}^{a} f(x) dx \\end{aligned} $$\nã‚’ä½¿ã„ã¾ã™ã€‚ã¤ã¾ã‚Š\n$$ \\begin{aligned} \\int_{-\\infty}^{b} f(x)dx = -\\int_{b}^{\\infty} f(x) dx \\end{aligned} $$\nã¨ã—ã¦å…¬å¼ã‚’é©ç”¨ã—ã¦è¨ˆç®—ã‚’è¡Œã„ã¾ã™ã€‚\nå¤‰æ•°å¤‰æ›å‰ã®è¢«ç©åˆ†é–¢æ•°ãŒæŒ‡æ•°çš„æ¸›è¡°ã‚’æŒã¤å ´åˆ å¤‰æ•°å¤‰æ›å‰ã®ç©åˆ†ãŒæ—¢ã«æŒ‡æ•°çš„æ¸›è¡°ç‰¹å¾´ã‚’æŒã¤å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«å¤‰æ›ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\phi(t) = \\exp(t - \\exp( -t)) \\end{aligned} $$\nç©åˆ†åŒºé–“ãŒ$(-\\infty, \\infty)$ã®å ´åˆ ç©åˆ†åŒºé–“ãŒåŠç„¡é™åŒºé–“$(-\\infty,\\infty)$ã§ã‚ã‚‹å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«å¤‰æ›ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\int_{-\\infty}^{\\infty} f(x)dx \u0026amp;= \\int_{-\\infty}^{\\infty} f(\\phi(t))\\phi^{\\prime}(t) dt\\\\ \\phi(t) \u0026amp;= \\sinh(\\frac{\\pi}{2}\\sinh(t))\\\\ \\phi^{\\prime}(t) \u0026amp;= \\frac{\\pi}{2}\\cosh(t)\\cosh(\\frac{\\pi}{2}\\sinh(t)) \\end{aligned} $$\n$\\phi(t)$ ã¯\n$$ \\begin{aligned} \\phi(t) \\to \\infty\\qquad \u0026amp;,\\qquad(t \\to -\\infty)\\\\ \\phi(t) \\to \\infty\\qquad \u0026amp;,\\qquad(t \\to \\infty) \\end{aligned} $$\nã®ã‚ˆã†ã«ã€$ t \\to -\\infty $ ã§ $-\\infty$ã€$ t \\to +\\infty $ ã§ $\\infty$ ã«äºŒé‡æŒ‡æ•°çš„ã«è¿‘ã¥ãã¾ã™ã€‚\nDEå…¬å¼ã®å…·ä½“ä¾‹ æ¬¡ã®ç©åˆ†\n$$ \\begin{aligned} \\int_{0}^{1} \\frac{dx}{\\sqrt{x}} = 2 \\end{aligned} $$\nã«DEå…¬å¼ã‚’é©ç”¨ã—ã¾ã™ã€‚\nã“ã®ç©åˆ†ã®çœŸå€¤ã¯$2$ã§ã‚ã‚Šã€è¢«ç©åˆ†é–¢æ•°$\\frac{1}{\\sqrt{x}}$ã¯ç©åˆ†åŒºé–“ã®ç«¯ç‚¹$x=0$ã§ç‰¹ç•°æ€§ã‚’æŒã¡ã¾ã™ã€‚\nã“ã®ç”»åƒã®ã‚ˆã†ã«ã€$x$ãŒ$0$ã«è¿‘ã¥ãã«ã¤ã‚Œã¦$f(x)$ãŒç™ºæ•£ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\nå°å½¢å…¬å¼ã§ã¯ã€$x$ãŒ$0$ã«è¿‘ã¥ãã«ã¤ã‚Œã¦$f(x)$ãŒ$\\infty$ã«ç™ºæ•£ã™ã‚‹ã“ã¨ã§ã€æ‰±ãˆã‚‹ç¯„å›²ã®å€¤ã‚’è¶…ãˆã¦ã—ã¾ã„ã€ã“ã®ã‚ˆã†ãªç©åˆ†ã‚’ã†ã¾ãè¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚\nã“ã®ç©åˆ†\n$$ \\begin{aligned} \\int_{0}^{1} f(x)dx \\end{aligned} $$\n$$ \\begin{aligned} f(x) = \\frac{1}{\\sqrt{x}} \\end{aligned} $$\nã«DEå¤‰æ›ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§\n$$ \\begin{aligned} \\int_{-\\infty}^{\\infty} \u0026amp;g(t) dt\\\\ g(t) \u0026amp;= \\frac{\\phi^{\\prime}(t)}{\\sqrt{\\phi(t)}}\\\\ \\phi(t) \u0026amp;= \\frac{1}{2} (\\tanh(\\frac{\\pi}{2}\\sinh(t)) + 1)\\\\ \\phi^{\\prime}(t) \u0026amp;= \\frac{\\pi \\cosh(t)}{4 \\cosh^{2}(\\frac{\\pi}{2}\\sinh(t))} \\end{aligned} $$\nã®ã‚ˆã†ãªç©åˆ†ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚\nDEå¤‰æ›å¾Œã®ã“ã®è¢«ç©åˆ†é–¢æ•°ã‚’ã‚°ãƒ©ãƒ•ã«ã™ã‚‹ã¨\nã®ã‚ˆã†ã«$|t| \\to \\infty$ ã§æ€¥æ¿€ã«0ã«è¿‘ã¥ã(äºŒé‡æŒ‡æ•°çš„ã«æ¸›è¡°) ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\nã“ã‚Œã«ã€å°å½¢å‰‡ã‚’æ¬¡ã®ã‚ˆã†ã«é©ç”¨ã—ã¾ã™ã€‚\n$$ \\begin{aligned} h\\sum_{i=-n}^{n} g(ih) \\end{aligned} $$\n$$ \\begin{aligned} g(ih) = \\frac{\\pi \\cosh(ih)}{4 \\cosh^{2}(\\frac{\\pi}{2}\\sinh(ih))\\sqrt{\\frac{1}{2} (\\tanh(\\frac{\\pi}{2}\\sinh(ih)) + 1)}} \\end{aligned} $$\n$$ \\begin{aligned} h \u0026amp;= \\frac{\\log(3n)}{n} \\end{aligned} $$\nã“ã®ã‚ˆã†ã«DEå¤‰æ›ã‚’ã—ãŸå¾Œã«ã€å°å½¢å‰‡ã‚’é©ç”¨ã—ã¦ã€åˆ†ç‚¹æ•°$n$ã‚’å¤§ããã—ãªãŒã‚‰è¨ˆç®—ã‚’è¡Œã†æ§˜å­ã‚’ã‚°ãƒ©ãƒ•ã«ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nä¸Šã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€DEå¤‰æ›å¾Œã«é©ç”¨ã™ã‚‹å°å½¢å‰‡ã¯ã€é€šå¸¸ã®å°å½¢å‰‡ã¨ã¾ã£ãŸãåŒã˜å‹•ä½œã‚’ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\nåˆ†ç‚¹æ•° $n$ ã‚’å¢—ã‚„ã™ã¨ãã€å°å½¢å‰‡ã®åˆ†å‰²ãŒç´°ã‹ããªã‚‹ã ã‘ã§ãªãã€æ•°å€¤ç©åˆ†ã‚’è¡Œã†åŒºé–“ãã®ã‚‚ã®ãŒå¾ã€…ã«åºƒãŒã£ã¦ã„ã¾ã™ ã€‚\nã“ã‚Œã¯ã€DEå¤‰æ›ã«ã‚ˆã£ã¦ç©åˆ†ãŒ\n$$ \\begin{aligned} \\int_{-\\infty}^{\\infty} g(t),dt \\end{aligned} $$\nã¨ã„ã†ç„¡é™åŒºé–“ã®ç©åˆ†ã«å¤‰æ›ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã§ã€å®Ÿéš›ã®æ•°å€¤è¨ˆç®—ã§ã¯\n$$ \\begin{aligned} t \\in [-nh,\\ nh] \\end{aligned} $$\nã®æœ‰é™åŒºé–“ã‚’åˆ‡ã‚Šå‡ºã—ã¦å°å½¢å‰‡ã‚’é©ç”¨ã—ã¦ã„ã¾ã™ã€‚\nåˆ†ç‚¹æ•°$n$ãŒå¢—ãˆã‚‹ã¨ã¨ã‚‚ã«ã“ã®åŒºé–“ãŒå¤–å´ã¸åºƒãŒã‚‹ãŸã‚ã€DEå…¬å¼ã®åæŸã«ã¯ã€Œåˆ»ã¿å¹…ãŒå°ã•ããªã‚‹åŠ¹æœã€(é›¢æ•£åŒ–èª¤å·®ã®æ¸›å°‘)ã¨ã€Œç„¡é™åŒºé–“ã‚’ã‚ˆã‚Šåºƒãå«ã‚ã‚‹åŠ¹æœã€(åˆ‡ã‚Šæ¨ã¦èª¤å·®ã®æ¸›å°‘)ã®ä¸¡æ–¹ãŒå¯„ä¸ã—ã¦ã„ã¾ã™ã€‚\nDEå…¬å¼ã§ã¯ã€åˆ†ç‚¹æ•°$n$ã‚’å¢—ã‚„ã™ã¨ ã€Œåˆ»ã¿å¹…ãŒå°ã•ããªã‚‹ï¼ˆé›¢æ•£åŒ–èª¤å·®ãŒæ¸›ã‚‹ï¼‰ã€ ã¨ ã€Œç©åˆ†åŒºé–“ãŒåºƒãŒã‚‹ï¼ˆåˆ‡ã‚Šæ¨ã¦èª¤å·®ãŒæ¸›ã‚‹ï¼‰ã€ ã®2ã¤ã®åŠ¹æœãŒåŒæ™‚ã«é€²ã¿ã¾ã™ã€‚\nã“ã®2ã¤ã®èª¤å·®ã¯ã€DEå¤‰æ›å¾Œã®è¢«ç©åˆ†é–¢æ•°$g(t)$ã®äºŒé‡æŒ‡æ•°çš„ãªæ¸›è¡° ã«ã‚ˆã£ã¦ã€ å¸¸ã«åŒã˜ãã‚‰ã„ã®å¤§ãã• ã«ä¿ãŸã‚Œã‚‹ã‚ˆã†è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚\nãã®çµæœã€èª¤å·®å…¨ä½“ãŒ $\\exp(-cn)$ã®ã‚ˆã†ã«æŒ‡æ•°çš„ã«æ¸›è¡°ã—ã€é€šå¸¸ã®å°å½¢å…¬å¼ã¨æ¯”ã¹ã¦åœ§å€’çš„ã«é€Ÿã„åæŸ ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚\nDEå…¬å¼ã®å®Ÿè£…ä¾‹ æ¬¡ã®ç©åˆ†ã‚’DE(Double Exponential)å…¬å¼ã§è¨ˆç®—ã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\int_{0}^{1} \\frac{dx}{\\sqrt{x}} = 2 \\end{aligned} $$\nã“ã®ç©åˆ†ã®è¢«ç©åˆ†é–¢æ•°\n$$ \\begin{aligned} f(x) = \\frac{1}{\\sqrt{x}} \\end{aligned} $$\nã¯ã€åŒºé–“ã®ç«¯ç‚¹$x=0$ã«ç‰¹ç•°æ€§ã‚’æŒã¤ãŸã‚ã€é€šå¸¸ã®å°å½¢å…¬å¼ã§ã¯æ­£ã—ãæ‰±ã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚\nDEå…¬å¼ã§ã¯\nå¤‰æ•°å¤‰æ›$x = \\phi(t)$ã«ã‚ˆã‚Šã€ç«¯ç‚¹ã®ç‰¹ç•°æ€§ã‚’ç„¡é™é ã«ã¨ã°ã™ äºŒé‡æŒ‡æ•°çš„ã«æ¸›è¡°ã™ã‚‹é–¢æ•°ã«å¤‰æ›ã•ã‚ŒãŸå¾Œã§å°å½¢æ¸¬ã‚’é©ç”¨ ã¨ã„ã†æµã‚Œã§åŠ¹ç‡çš„ã«æ•°å€¤ç©åˆ†ã‚’è¡Œã„ã¾ã™ã€‚\næ¡è½ã¡ã‚’é¿ã‘ã‚‹ãŸã‚ã®å¼å¤‰å½¢ DEå¤‰æ›ã‚’é©ç”¨ã—ã¦ãã®ã¾ã¾è¨ˆç®—ã‚’ã™ã‚‹ã¨\n$\\tanh(\u0026hellip;) - 1$ã®ã‚ˆã†ãªå±é™ºãªå·®ã«ã‚ˆã‚‹æ¡è½ã¡ éƒ¨åˆ†çš„ã«å·¨å¤§ãªå€¤ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ ãªã©ã®åŸå› ã«ã‚ˆã£ã¦ã€çµæœãŒNaNã‚„Infã«ãªã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nä»Šå›ã®å®Ÿè£…ä¾‹ã¯ãã®å…¸å‹ä¾‹ã§ã™ã€‚\nãã“ã§ã€æ­£è² ã§å ´åˆåˆ†ã‘ã—ãŸãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯é–¢æ•°\n$$ \\begin{aligned} \\sigma(x) = \\frac{1}{1+e^{-x}} \\end{aligned} $$\nã‚’ç”¨ã„ã¦å®‰å…¨ã«è¨ˆç®—ã—ã¦ã„ã¾ã™ã€‚\npythonã§å®Ÿè£…ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nimport numpy as np # ---- è¢«ç©åˆ†é–¢æ•° f(x) = 1/sqrt(x) ---- def f(x): return 1.0 / np.sqrt(x) # ---- ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯é–¢æ•°ï¼ˆç¬¦å·ã§å®‰å®šåŒ–ï¼‰ ---- def logistic(z): # Ïƒ(z) = 1 / (1 + exp(-z)) ã‚’æ¡è½ã¡ãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã—ãªã„ã‚ˆã†ã«è¨ˆç®— out = np.empty_like(z) pos = z \u0026gt;= 0 neg = ~pos # z \u0026gt;= 0 ã®ã¨ã: exp(-z) ã¯ 0ï½1 ã«åã¾ã‚‹ã®ã§å®‰å…¨ out[pos] = 1.0 / (1.0 + np.exp(-z[pos])) # z \u0026lt; 0 ã®ã¨ã: exp(z) ã¯ 0ï½1 ã«åã¾ã‚‹ã®ã§å®‰å…¨ ez = np.exp(z[neg]) out[neg] = ez / (1.0 + ez) return out # ---- DEå¤‰æ› Ï†(t) ã¨ Ï†\u0026#39;(t)ï¼ˆä¸¡æ–¹ã¨ã‚‚å®‰å®šç‰ˆï¼‰ ---- def phi_and_phi_prime(t): # u = (Ï€/2) sinh(t) u = (np.pi / 2.0) * np.sinh(t) z = 2.0 * u # = Ï€ sinh(t) s = logistic(z) # s = Ïƒ(z) = Ï†(t) phi = s # Ï†(t) è‡ªä½“ãŒ Ïƒ(z) # Ï†\u0026#39;(t) = Ï€ cosh(t) * s * (1 - s) dphi = np.pi * np.cosh(t) * s * (1.0 - s) return phi, dphi # ---- DEå…¬å¼ã§ç©åˆ†ã‚’è¨ˆç®— ---- def de_integrate(n): # åˆ»ã¿å¹… h = log(3n) / n h = np.log(3.0 * n) / n total = 0.0 for k in range(-n, n + 1): t = k * h x, dphi = phi_and_phi_prime(t) total += f(x) * dphi return h * total def main(): true_value = 2.0 n_values = [4, 8, 16, 32, 64, 128] print(\u0026#34;DE integration of âˆ«0^1 dx/âˆšx (with underflow/cancellation-safe transform)\u0026#34;) print(\u0026#34; n approx error\u0026#34;) print(\u0026#34;-------------------------------------------\u0026#34;) for n in n_values: approx = de_integrate(n) error = abs(approx - true_value) print(f\u0026#34;{n:3d} {approx: .12f} {error:.3e}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() å®Ÿè¡Œçµæœ\nn approx error ------------------------------------------- 4 2.000012041343 1.204e-05 8 2.000000004154 4.154e-09 16 2.000000000000 2.220e-15 32 2.000000000000 4.441e-16 64 2.000000000000 4.441e-16 128 2.000000000000 1.554e-15 å°å½¢å…¬å¼ã¨DEå…¬å¼ã®ç‰¹å¾´ã®æ¯”è¼ƒ å°å½¢å…¬å¼ã¨DEå…¬å¼ã®ç‰¹å¾´ã‚’æ¯”è¼ƒã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\né …ç›® å°å½¢å…¬å¼ DEå…¬å¼ èª¤å·®ã®æ¸›è¡° $O(\\frac{1}{n^{2}})$ å¤šé …å¼åæŸ $O(\\exp(-cn))$ æŒ‡æ•°åæŸ ç„¡é™åŒºé–“ã®ç©åˆ† âŒ ç›´æ¥ã¯ä¸å¯ï¼ˆå¤‰æ›ãŒå¿…è¦ï¼‰ âœ…DEå¤‰æ›ã§è‡ªç„¶ã«å‡¦ç†ã§ãã‚‹ ç«¯ç‚¹ã®ç‰¹ç•°ç‚¹ è¨ˆç®—ä¸èƒ½ï¼ˆç«¯ç‚¹ç™ºæ•£ï¼‰ è¨ˆç®—å¯èƒ½ å®Ÿè£…ã®å®¹æ˜“ã• â— éå¸¸ã«ç°¡å˜ â–³ å¤‰æ•°å¤‰æ›ãƒ»å¾®åˆ†è¨ˆç®—ãŒå¿…è¦ å°å½¢å…¬å¼ã¨DEå…¬å¼ã®èª¤å·®ã®æ¸›è¡°ã‚’æ¯”è¼ƒ æ¬¡ã®å®šç©åˆ†ã‚’ã€å°å½¢å…¬å¼ã¨DEå…¬å¼ã§è¨ˆç®—ã—ã¦èª¤å·®ã®æ¸›è¡°ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚\n$$ \\begin{aligned} \\int_{0}^{1} e^{x} dx = e - 1 \\end{aligned} $$\nTrapezoidal rule(å°å½¢å…¬å¼)ã¨DE rule(äºŒé‡æŒ‡æ•°é–¢æ•°å‹ç©åˆ†å…¬å¼)ã®èª¤å·®ã®æ¸›è¡°ã‚’å¯¾æ•°ã‚°ãƒ©ãƒ•ã§æ¯”è¼ƒã—ã¦ã„ã¾ã™ã€‚\nå°å½¢å…¬å¼(é’)\nåˆ†ç‚¹æ•°$n$ã‚’å¢—ã‚„ã™ã¨å¾ã€…ã«èª¤å·®ãŒæ¸›è¡°ã—ã¦ã„ãã¾ã™ãŒã€ãã®æ¸›è¡°é€Ÿåº¦ã¯é€Ÿãã‚ã‚Šã¾ã›ã‚“ã€‚\nç†è«–çš„ã«ã¯å°å½¢å…¬å¼ã®èª¤å·®ã¯ $$ \\begin{aligned} O(\\frac{1}{n^{2}}) \\end{aligned} $$ ã®å¤šé …å¼çš„ãªåæŸã‚’ç¤ºã—ã€å®Ÿéš›ã‚°ãƒ©ãƒ•ã§ã‚‚ã»ã¼ç›´ç·šçš„ã«ä¸‹ãŒã‚‹ç·©ã‚„ã‹ãªæ¸›è¡° ã«ãªã£ã¦ã„ã¾ã™ã€‚ DEå…¬å¼(æ©™)\nå°ã•ãª$n$ã§ã‚‚èª¤å·®ãŒæ€¥æ¿€ã«æ¸›è¡°ã—ã€$n=16$ã‚’è¶…ãˆãŸã‚ãŸã‚Šã§æ—©ãã‚‚$10^{-15}$(å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ãŒä¿æŒã§ãã‚‹æ¡ã®é™ç•Œä»˜è¿‘) ã«é”ã—ã¦ã„ã¾ã™ã€‚\nã“ã‚Œã¯DEå…¬å¼ã®èª¤å·®ãŒ $$ \\begin{aligned} O(\\exp(-cn)) \\end{aligned} $$ ã®ã‚ˆã†ãªæŒ‡æ•°çš„åæŸ ã‚’ç¤ºã™ãŸã‚ã§ã€å°å½¢å…¬å¼ã¨æ¯”ã¹ã¦åœ§å€’çš„ã«æ—©ãåæŸã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ å…¨ä½“ã®æ¯”è¼ƒ\nå°å½¢å…¬å¼ã¯åˆ†ç‚¹æ•°$n$ã‚’å¢—ã‚„ã™ã»ã©å°‘ã—ãšã¤ç²¾åº¦ãŒä¸ŠãŒã‚‹ã®ã«å¯¾ã—ã€DEå…¬å¼ã¯æ¥µã‚ã¦å°‘ãªã„åˆ†ç‚¹æ•°ã§æ©Ÿæ¢°ç²¾åº¦ã«é”ã™ã‚‹ã»ã©é«˜åŠ¹ç‡ã§ã™ã€‚\næ»‘ã‚‰ã‹ãªé–¢æ•°$e^{x}$ã«å¯¾ã—ã¦ã‚‚ã€DEå…¬å¼ãŒéå¸¸ã«é«˜ã„æ€§èƒ½ã‚’ç™ºæ®ã™ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ åŒºé–“æ¼”ç®—ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ã«ã¤ã„ã¦ å°å½¢å…¬å¼ã‚„DEå…¬å¼ã¯ã„ãšã‚Œã‚‚æ•°å€¤çš„ãªè¿‘ä¼¼æ‰‹æ³•ã§ã‚ã‚Šç©åˆ†å€¤ã‚’å³å¯†ã«æ±‚ã‚ã‚‹éš›ã«ã¯ã€ä½•ã‚‰ã‹ã®èª¤å·®ãŒå«ã¾ã‚Œã¾ã™ã€‚\nå°å½¢å…¬å¼ã§ã¯ä¸»ã«é›¢æ•£åŒ–èª¤å·®(åˆ»ã¿å¹…ã«ã‚ˆã‚‹èª¤å·®) DEå…¬å¼ã§ã¯é›¢æ•£åŒ–èª¤å·®ã«åŠ ãˆã¦å¤‰æ•°å¤‰æ›å¾Œã®å…¨ç„¡é™ã®ç©åˆ†åŒºé–“ã‚’æœ‰é™åŒºé–“ã§ã€Œæ‰“ã¡åˆ‡ã‚‹ã€ã“ã¨ã«ã‚ˆã‚‹æ‰“ã¡åˆ‡ã‚Šèª¤å·® ã“ã‚Œã‚‰ã®èª¤å·®ãŒç†è«–çš„ã«å­˜åœ¨ã—ã¾ã™ã€‚\nç²¾åº¦ä¿è¨¼ä»˜ãæ•°å€¤è¨ˆç®—(Verified Numerics) ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ã“ã‚Œã‚‰ã™ã¹ã¦ã®èª¤å·®è¦å› ã‚’å³å¯†ã«è©•ä¾¡ã—ã€æœ€çµ‚çµæœã‚’åŒºé–“ã¨ã—ã¦åŒ…å«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã—ã‹ã—ã€èª¤å·®é …ã®ç†è«–çš„æ‰±ã„ã¯éå¸¸ã«é«˜åº¦ã§ã‚ã‚Šã€ç‰¹ã«DEå…¬å¼ã®ã‚ˆã†ã«å¤‰æ•°å¤‰æ›ã‚’ä¼´ã†æ‰‹æ³•ã§ã¯ã€èª¤å·®ã®è©•ä¾¡å¼ãã®ã‚‚ã®ãŒè¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚\nãã®ãŸã‚ã€ã“ã“ã§ã¯è©³ç´°ãªç†è«–å±•é–‹ã«ã¯è¸ã¿è¾¼ã¿ã¾ã›ã‚“ã€‚\nç²¾åº¦ä¿è¨¼ä»˜ãæ•°å€¤è¨ˆç®—ã‚’æœ¬æ ¼çš„ã«å­¦ã³ãŸã„æ–¹ã®ãŸã‚ã«ã€å‚è€ƒã¨ãªã‚‹æ›¸ç±ã®ã¿ç´¹ä»‹ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚\nğŸ“˜ç²¾åº¦ä¿è¨¼ä»˜ãæ•°å€¤è¨ˆç®—ã®åŸºç¤\nã¾ã¨ã‚ ã“ã®è¨˜äº‹ã§ã¯ã€æ•°å€¤ç©åˆ†ã®åŸºæœ¬ã§ã‚ã‚‹å°å½¢å…¬å¼ã¨ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ã®ç‰¹ç•°ç‚¹ã‚„ç„¡é™åŒºé–“ã®ç©åˆ†ã«ã‚‚å¯¾å¿œã§ãã‚‹é«˜ç²¾åº¦ãªæ‰‹æ³•ã§ã‚ã‚‹DE(Double Exponential)å…¬å¼ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚\nå°å½¢å…¬å¼ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§å®Ÿè£…ã—ã‚„ã™ã„åé¢ã€åæŸã¯å¤šé …å¼çš„ã§ã€ç‰¹ç•°ç‚¹ã«ã¯å¼±ã„ DEå…¬å¼ã¯å¤‰æ•°å¤‰æ›ã«ã‚ˆã£ã¦ç©åˆ†åŒºé–“ã®ç«¯ç‚¹ã®ç‰¹ç•°ç‚¹ã‚’ç„¡é™é ç‚¹ã¸æŠ¼ã—å‡ºã—ã€æŒ‡æ•°çš„ãªåæŸã‚’å®Ÿç¾ã™ã‚‹éå¸¸ã«å¼·åŠ›ãªæ‰‹æ³• DEå…¬å¼ã‚’å®Ÿè£…ã™ã‚‹éš›ã«ã¯æ¡è½ã¡ã‚„ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’é¿ã‘ã‚‹ãŸã‚ã«å¼å¤‰å½¢ãŒå¿…è¦ãªã“ã¨ãŒã‚ã‚‹ ç²¾åº¦ä¿è¨¼ã‚’è¡Œã†ã«ã¯ã€é›¢æ•£åŒ–èª¤å·®ãƒ»æ‰“åˆ‡ã‚Šèª¤å·®ãªã©ã®ç†è«–çš„ãªèª¤å·®ã‚’æ•°å­¦çš„ã«è©•ä¾¡ã—ã€åŒºé–“æ¼”ç®—ã§åŒ…å«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ ç¾ä»£ã®æ•°å€¤è¨ˆç®—ã§ã¯ã€Œè§£æçš„ã«ç©åˆ†ã§ããªã„é–¢æ•°ã€ã®ã»ã†ãŒä¸€èˆ¬çš„ã§ã™ã€‚\nãã®ãŸã‚ã€æ•°å€¤ç©åˆ†ã®åŸºç¤ã‚’ç†è§£ã—ã€é©åˆ‡ãªæ–¹æ³•ã‚’é¸æŠã§ãã‚‹ã“ã¨ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚\nå°å½¢å…¬å¼ã®ã‚ˆã†ãªåŸºæœ¬çš„ãªæ‰‹æ³•ã ã‘ã§ãªãã€DEå…¬å¼ã®ã‚ˆã†ãªé«˜ç²¾åº¦æ‰‹æ³•ã¾ã§ç†è§£ã—ã¦ãŠãã¨ã€å®Ÿéš›ã®ç§‘å­¦æŠ€è¡“è¨ˆç®—ãƒ»çµ±è¨ˆè¨ˆç®—ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã§å¤§ããªåŠ›ã«ãªã‚Šã¾ã™ã€‚\n","permalink":"http://localhost:1313/posts/numericalintegration/","summary":"\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ’¡ \u003cstrong\u003eã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../float\"\u003e\u003cstrong\u003e1. æµ®å‹•å°æ•°ç‚¹æ•°\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../interval\"\u003e\u003cstrong\u003e2. åŒºé–“æ¼”ç®—\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalIntegration\"\u003e\u003cstrong\u003e3. æ•°å€¤ç©åˆ†\u003c/strong\u003e\u003c/a\u003e \u003cstrong\u003eğŸ‘ˆ ä»Šã“ã“\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../numericalDifferentiation\"\u003e\u003cstrong\u003e4. æ•°å€¤å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../autoDiff\"\u003e\u003cstrong\u003e5. è‡ªå‹•å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003eå¤šãã®ç©åˆ†ã¯ã€Œç´™ã¨ãƒšãƒ³ã€ã§ç°¡å˜ã«è¨ˆç®—ã§ãã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚\u003cbr\u003e\nå®Ÿéš›ã€ç©åˆ†ã®ä¸­ã«ã¯\u003c/p\u003e","title":"æ•°å€¤ç©åˆ†"},{"content":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°\n2. åŒºé–“æ¼”ç®—ğŸ‘ˆ ä»Šã“ã“\n3. æ•°å€¤ç©åˆ†\n4. æ•°å€¤å¾®åˆ†\n5. è‡ªå‹•å¾®åˆ†\næµ®å‹•å°æ•°ç‚¹æ•°ã§è¨ˆç®—ã‚’ã—ã¦ã„ã‚‹ã¨ã€ã€Œã©ã“ã¾ã§ãŒæ­£ã—ã„å€¤ãªã®ã‹ï¼Ÿã€ ã¨ã„ã†ä¸å®‰ãŒå¸¸ã«ã¤ãã¾ã¨ã„ã¾ã™ã€‚\nä¸¸ã‚èª¤å·®ã¯1å›ã®è¨ˆç®—ã§ã¯å°ã•ãã¦ã‚‚ã€1,000å›ã€1,000,000å›ã¨ç¹°ã‚Šè¿”ã•ã‚Œã‚‹ã†ã¡ã«ç„¡è¦–ã§ããªã„å¤§ãã•ã«ãªã£ã¦ã„ãã¾ã™ã€‚\nè¨ˆç®—çµæœã‚’ã²ã¨ã¤ã®å€¤ã¨ã—ã¦æ‰±ã†å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯ã€ä¸¸ã‚èª¤å·®ãŒç´¯ç©ã—ã¦ã—ã¾ã†å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ãã“ã§å½¹ç«‹ã¤ã®ãŒã€åŒºé–“æ¼”ç®—(Interval Arithmetic) ã§ã™ã€‚\nè¨ˆç®—çµæœã‚’ã€Œã²ã¨ã¤ã®å€¤ã€ã§ã¯ãªãã€çœŸå€¤ã‚’å¿…ãšå«ã‚€ç¯„å›²ï¼ˆåŒºé–“ï¼‰ ã¨ã—ã¦æ‰±ã†ã“ã¨ã§ã€å³å¯†ã«æ­£ã—ã„å€¤ã‚’è¨ˆç®—ã—ã¾ã™ã€‚\nã“ã®è¨˜äº‹ã§ã¯ã€åŒºé–“æ¼”ç®—ã®ä»•çµ„ã¿ã¨ã€å®Ÿéš›ã«åˆ©ç”¨ã§ãã‚‹åŒºé–“æ¼”ç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\nåŒºé–“æ¼”ç®—(Interval arithmetic) åŒºé–“æ¼”ç®—ã¨ã¯ã€æ•°å€¤ã‚’1ã¤ã®å€¤ã§ã¯ãªãã€Œãã®å€¤ãŒå­˜åœ¨ã—ã†ã‚‹ç¯„å›²ï¼ˆåŒºé–“ï¼‰ã€ã¨ã—ã¦æ‰±ã†è¨ˆç®—æ‰‹æ³•ã§ã™ã€‚\næµ®å‹•å°æ•°ç‚¹æ•°ã§ã¯ã€ä¸¸ã‚èª¤å·®ã«ã‚ˆã£ã¦è¨ˆç®—çµæœãŒçœŸã®å€¤ã‹ã‚‰ãšã‚Œã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n1å›ã®æ¼”ç®—ã§ã¯å°ã•ãªèª¤å·®ã«æ„Ÿã˜ã‚‹ã‹ã‚‚ã—ã¾ã›ã‚“ãŒã€ä¸¸ã‚èª¤å·®ãŒç™ºç”Ÿã™ã‚‹æ¼”ç®—ã‚’\n1,000å› 10,000å› 1,000,000å› ã¨ç¹°ã‚Šè¿”ã•ã‚Œã‚‹ã¨ã€ä¸¸ã‚èª¤å·®ãŒè“„ç©ã—ã¦ç„¡è¦–ã§ããªã„å¤§ãã•ã«é”ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nãã“ã§ã€å®Ÿæ•°$x$ã‚’1ç‚¹ã§è¿‘ä¼¼ã™ã‚‹ã®ã§ã¯ãªã\næ©Ÿæ¢°çš„ã«è¡¨ç¾ã§ãã‚‹æµ®å‹•å°æ•°ç‚¹æ•°ã‚’ç«¯ç‚¹ã«ã‚‚ã¤é–‰åŒºé–“\n$$ \\begin{aligned} X = [a,b] \\end{aligned} $$\nã¨ã—ã¦è¡¨ç¾ã—ã¾ã™ã€‚\nã“ã‚Œã¯ã€Œå®Ÿæ•°$x$ã¯å¿…ãš$a$ä»¥ä¸Š$b$ä»¥ä¸‹ã®ã©ã“ã‹ã«ã‚ã‚‹ã€ã¨ã„ã†å½¢ã«ã™ã‚‹ã“ã¨ã§å³å¯†ã«æ­£ã—ã„ã‚‚ã®ã«ã—ã¦ã„ã¾ã™ã€‚\n$$ \\begin{aligned} a \\le x \\le b \\end{aligned} $$\nä¸¸ã‚èª¤å·®ã‚’ç„¡è¦–ã™ã‚‹ã“ã¨ãªãã€ã‚€ã—ã‚ä¸¸ã‚èª¤å·®ã”ã¨åŒ…ã¿è¾¼ã‚€å½¢ã§è¡¨ç¾ã™ã‚‹ã®ãŒåŒºé–“æ¼”ç®—ã®ç‰¹å¾´ã§ã™ã€‚\nåŒºé–“æ¼”ç®—ã®ç¨®é¡ åŒºé–“æ¼”ç®—ã«ã¯å¤§ããåˆ†ã‘ã¦ä¸Šç«¯ä¸‹ç«¯å‹(inf-sup) ã¨ä¸­å¿ƒåŠå¾„å‹(mid-rad) ã®2ç¨®é¡ãŒã‚ã‚Šã¾ã™ã€‚\n1. ä¸Šç«¯ä¸‹ç«¯å‹(inf-sup å‹ interval = [inf, sup]) æ•°å€¤ã‚’ã€Œä¸‹ç«¯(inf)ã€ã¨ã€Œä¸Šç«¯(sup)ã€ã®ãƒšã‚¢ã§ç›´æ¥è¡¨ç¾ã™ã‚‹æ–¹æ³•ã§ã™ã€‚\n$$ \\begin{aligned} X = [ inf , sup ] \\end{aligned} $$\nä¸Šç«¯ä¸‹ç«¯å‹ã®åŒºé–“æ¼”ç®—ã§ã¯\nä¸‹å‘ãä¸¸ã‚\nä¸‹ç«¯ã‚’è¨ˆç®— ä¸Šå‘ãä¸¸ã‚\nä¸Šç«¯ã‚’è¨ˆç®— ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚\nã“ã‚Œã«ã‚ˆã‚Šã€ä¸¸ã‚èª¤å·®ãŒã‚ã£ã¦ã‚‚å¿…ãš\u0026quot;çœŸã®å€¤ã‚’å«ã‚€åŒºé–“\u0026quot;ã‚’ä¿è¨¼ã§ãã‚‹ã®ãŒæœ€å¤§ã®åˆ©ç‚¹ã§ã™ã€‚\nä¸Šç«¯ä¸‹ç«¯å‹(inf-sup)\næ•°å€¤ã‚’[ä¸‹ç«¯,ä¸Šç«¯]ã®ãƒšã‚¢ã§è¡¨ç¾ã€‚\nä¸‹ç«¯ã‚’è¨ˆç®—ã™ã‚‹ã¨ãã¯ä¸‹å‘ãä¸¸ã‚ã€ä¸Šç«¯ã‚’è¨ˆç®—ã™ã‚‹ã¨ãã¯ä¸Šå‘ãä¸¸ã‚ã§è¨ˆç®—ã™ã‚‹ã“ã¨ã§ã€ä¸¸ã‚ã®å½±éŸ¿ã‚’æŠŠæ¡ã—ã¦çœŸã®å€¤ã‚’åŒºé–“å†…ã«åŒ…å«ã™ã‚‹ã€‚ ä¸­å¿ƒåŠå¾„å‹(mid-rad)\næ•°å€¤ã‚’[ä¸­å¿ƒç‚¹,åŠå¾„]ã§è¡¨ç¾\n$mid \\pm rad$ã®ã‚ˆã†ã«åŒºé–“ã‚’è¡¨ç¾ã™ã‚‹ã€‚ 2. ä¸­å¿ƒåŠå¾„å‹(mid-rad å‹ interval = [mid, rad]) æ•°å€¤ã‚’ã€Œä¸­å¿ƒ(mid)ã€ã¨ã€ŒåŠå¾„(rad)ã€ã§è¡¨ç¾ã—ã¾ã™ã€‚\n$$ \\begin{aligned} X = mid \\pm rad \\end{aligned} $$\nã¤ã¾ã‚ŠåŒºé–“ã¯\n$$ \\begin{aligned} X = [mid - rad , mid + rad] \\end{aligned} $$\nã¨è§£é‡ˆã§ãã¾ã™ã€‚\nåŒºé–“æ¼”ç®—ã«ã‚ˆã‚‹ç²¾åº¦ä¿è¨¼ æµ®å‹•å°æ•°ç‚¹æ•°ã§è¨ˆç®—ã—ã¦ã„ã‚‹ã¨\nã€Œã“ã®çµæœã¯ä½•æ¡ç›®ã¾ã§ä¿¡ã˜ã¦ã‚ˆã„ã®ã‹ï¼Ÿã€\nã¨ã„ã†ç–‘å•ãŒå¸¸ã«ã¤ãã¾ã¨ã„ã¾ã™ã€‚\né€šå¸¸ã®è¨ˆç®—ã§ã¯ã€ä¸¸ã‚èª¤å·®ãŒã©ã®ã‚ˆã†ã«è“„ç©ã—ãŸã®ã‹ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ããªã„ãŸã‚ã€çµæœã®ã©ã“ã¾ã§ãŒæ­£ã—ã„å€¤ãªã®ã‹ã‚’åˆ¤æ–­ã§ãã¾ã›ã‚“ã€‚\nãã“ã§å½¹ã«ç«‹ã¤ã®ãŒåŒºé–“æ¼”ç®—(Interval Arithmetic) ã§ã™ã€‚\nä¾‹ã¨ã—ã¦$\\pi$ã‚’åŒºé–“ã§è¡¨ç¾ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n$$ \\begin{aligned} \\pi = [3.1415 , 3.1416] \\end{aligned} $$\nã“ã‚Œã¯æ¬¡ã®æ„å‘³ã‚’è¡¨ã—ã¾ã™ã€‚\n$$ \\begin{aligned} 3.1415 \\le \\pi \\le 3.1416 \\end{aligned} $$\nã“ã“ã§ã€åŒºé–“ã®ä¸¡ç«¯ã§ä¸€è‡´ã—ã¦ã„ã‚‹æ¡ã‚’è¦‹ã‚‹ã¨\n$$ \\begin{aligned} {\\color{red}3.141}5 \\le \\pi \\le {\\color{red}3.141}6 \\end{aligned} $$\nèµ¤æ–‡å­—ã®${\\color{red}3.141}$ã®æ¡ã¯åŒºé–“ã®ä¸¡ç«¯ã§åŒã˜å€¤ã§ã‚ã‚‹ãŸã‚ã€ã“ã®4æ¡ã¾ã§ã¯å¿…ãšæ­£ã—ã„(ç²¾åº¦ãŒä¿è¨¼ã•ã‚Œã¦ã„ã‚‹) ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\nåŒºé–“æ¼”ç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç´¹ä»‹ åŒºé–“æ¼”ç®—ã‚’å®Ÿéš›ã«æ‰±ã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ä¸Šç«¯ä¸‹ç«¯å‹ï¼ˆinf-sup å‹ï¼‰ ã¨ ä¸­å¿ƒåŠå¾„å‹ï¼ˆmid-rad å‹ï¼‰ ã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ã€‚\nãã‚Œãã‚Œã§ä»£è¡¨çš„ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\nä¸Šç«¯ä¸‹ç«¯å‹ï¼ˆInfâ€“Sup Intervalï¼‰ kv ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆC++ï¼‰\nC++ ã§å®Ÿè£…ã•ã‚ŒãŸç²¾åº¦ä¿è¨¼ä»˜ãæ•°å€¤è¨ˆç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚\nä¸Šç«¯ä¸‹ç«¯ï¼ˆinfâ€“supï¼‰ã§åŒºé–“ã‚’æ‰±ã†ãŸã‚ã€ä¸¸ã‚æ–¹å‘ã‚’æ˜ç¤ºçš„ã«åˆ¶å¾¡ã—ãªãŒã‚‰åŒºé–“ã‚’è¨ˆç®—ã§ãã¾ã™ã€‚\nä½¿ç”¨ã«ã¯ Boost ãŒå¿…è¦ã§ã™ã€‚\nğŸ‘‰ kvãƒ©ã‚¤ãƒ–ãƒ©ãƒªå…¬å¼ã‚µã‚¤ãƒˆ ä¸­å¿ƒåŠå¾„å‹ï¼ˆMidâ€“Rad Intervalï¼‰ Arb ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆCè¨€èª / FLINT çµ±åˆï¼‰\nC/C++ã§ä½¿ãˆã‚‹é«˜é€Ÿãªå¤šå€é•·è¨ˆç®—/ä¸­å¿ƒåŠå¾„å‹ã®åŒºé–“æ¼”ç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚\nç‰¹æ®Šé–¢æ•°ã®é«˜ç²¾åº¦è¨ˆç®—ã«ã‚‚ç”¨ã„ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\nç¾åœ¨ã¯FLINTã«çµ±åˆã•ã‚ŒãŸã‚ˆã†ã§ã™ã€‚\nLinux / macOS ã§å‹•ä½œã—ã¾ã™ã€‚\nğŸ‘‰ Arb Library Setup\nPython-FLINTï¼ˆPython ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼‰\nArb / FLINT ã‚’ Python ã‹ã‚‰åˆ©ç”¨ã§ãã‚‹æ‹¡å¼µãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚\nWindows ã§ã‚‚å‹•ä½œã—ã€Python ã§é«˜ç²¾åº¦ã‹ã¤ç²¾åº¦ä¿è¨¼ä»˜ãã®è¨ˆç®—ã‚’è¡Œã„ãŸã„å ´åˆã«æœ€é©ã§ã™ã€‚\nğŸ‘‰ Python-FLINT Setup\nPython-FLINTã®å°å…¥(Windows) ç¾åœ¨ã®ç­†è€…ã®ç’°å¢ƒãŒwindowsãªç‚ºã€ã“ã“ã§ã¯Python FLINTã®å°å…¥ã‚’ã—ã¦ã„ãã¾ã™ã€‚\nä»–ã®OSã‚’ä½¿ã£ã¦ã„ã‚‹æ–¹ã¯Arbãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒçµ±åˆã•ã‚ŒãŸFLINTã‚„kvãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å°å…¥ã™ã‚‹ã¨è‰¯ã„ã§ã™ã€‚\nãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\npy -m pip install python-flint æ¬¡ã®ã‚ˆã†ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆ\nfrom flint import arb x = arb.pi() print(x) å®Ÿè¡Œçµæœ\n[3.14159265358979 +/- 3.34e-15] ã“ã‚Œã¯ã€æ¬¡ã®ã‚ˆã†ãªæ„å‘³ã«ãªã£ã¦ã„ã¾ã™ã€‚\n$$ \\begin{aligned} 3.14159265358979 \\pm (3.34 \\times 10^{-15}) \\end{aligned} $$\nç¯„å›²ã§è¡¨ã™ã¨\n$$ \\begin{aligned} 3.14159265358979 - (3.34 \\times 10^{-15}) \\le \\pi \\le 3.14159265358979 + (3.34 \\times 10^{-15}) \\end{aligned} $$\nã§ã™ã€‚\nç²¾åº¦ã®å¤‰æ›´ ç²¾åº¦ãŒä¿è¨¼ã•ã‚ŒãŸå€¤ã‚’ã•ã‚‰ã«é«˜ç²¾åº¦ã«æ±‚ã‚ã‚‹ãŸã‚ã«ã€ç²¾åº¦ã®å¤‰æ›´ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚\n1. ç²¾åº¦ã‚’ãƒ“ãƒƒãƒˆæ•°(2é€²æ•°)ã§æŒ‡å®šã™ã‚‹ã€‚\nãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚\nãƒ“ãƒƒãƒˆã§ç²¾åº¦ã‚’æŒ‡å®šã—ãŸã„æ™‚ã¯ctx.precã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nfrom flint import arb, ctx # ç²¾åº¦ã‚’106ãƒ“ãƒƒãƒˆã«è¨­å®š(10é€²ã§ç´„32æ¡ã®ç²¾åº¦) ctx.prec = 106 x = arb.pi() print(x) 106bitã®ç²¾åº¦ã¯ã€10é€²æ•°ã§ã¯æ¬¡ã®ã‚ˆã†ã«æ›ç®—ã•ã‚Œã¾ã™ã€‚\n$$ \\begin{aligned} 106\\times \\log_{10}(2) \\approx 31.9 \\end{aligned} $$\nå®Ÿè¡Œçµæœ\n[3.141592653589793238462643383279 +/- 5.06e-31] 2. ç²¾åº¦ã‚’10é€²æ•°ã§æŒ‡å®šã™ã‚‹ã€‚\nãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚\n10é€²æ•°ã§ç²¾åº¦ã‚’æŒ‡å®šã—ãŸã„ã¨ãã¯ctx.dpsã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\n10é€²ã§50æ¡ç¨‹åº¦ã®ç²¾åº¦ã«è¨­å®šã—ã¾ã™ã€‚\nfrom flint import arb, ctx # 10é€²ã§ãŠã‚ˆã50æ¡åˆ†ã®ç²¾åº¦ ctx.dps = 50 x = arb.pi() print(x) å®Ÿè¡Œçµæœ\n[3.1415926535897932384626433832795028841971693993751 +/- 9.51e-51] ç²¾åº¦ä¿è¨¼ã•ã‚Œã¦ã„ã‚‹æ¡ã ã‘ã‚’å‡ºåŠ›ã™ã‚‹ showgoodé–¢æ•°ã‚’ä½¿ã†ã¨ã€midã®ã†ã¡radiusã®å½±éŸ¿ã‚’å—ã‘ãªã„\nã€ŒåŒºé–“ã®ä¸Šä¸‹ç«¯ãŒä¸€è‡´ã—ã¦ã„ã‚‹æ¡(=good digits,ç²¾åº¦ä¿è¨¼å€¤)ã€ ã ã‘ã‚’è¡¨ç¤ºå‡ºæ¥ã¾ã™ã€‚\nArbã®åŒºé–“è¡¨ç¤ºã¯\n[mid +/- rad] ã¨ã„ã†å½¢ã§ã™ãŒã€ã“ã‚Œã¯æ•°å­¦çš„ã«ã¯æ¬¡ã®ä¸ç­‰å¼ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚\n$$ \\begin{aligned} mid - rad \\le x \\le mid + rad \\end{aligned} $$\nã“ã“ã§\nä¸Šç«¯ $$ \\begin{aligned} hi = mid + rad \\end{aligned} $$\nä¸‹ç«¯ $$ \\begin{aligned} lo = mid - rad \\end{aligned} $$\nã¨ã™ã‚‹ã¨$hi$ã¨$lo$ã‚’ä¸¦ã¹ã¦ã¿ãŸã¨ãã«ã€å…ˆé ­ã‹ã‚‰å…±é€šã—ã¦ã„ã‚‹æ¡ã¯åŒºé–“å†…ã®ã©ã‚“ãªçœŸã®å€¤$x$ã‚’å–ã£ã¦ã‚‚å¤‰ã‚ã‚‰ãªã„æ¡ã«ãªã‚Šã¾ã™ã€‚\nshowgoodã¯ã¾ã•ã«ã“ã®\nä¸Šç«¯$hi$ã¨ä¸‹ç«¯$lo$ãŒä¸€è‡´ã—ã¦ã„ã‚‹éƒ¨åˆ†ã ã‘ã‚’æŠœãå‡ºã—ãŸè¡¨ç¤º ã¤ã¾ã‚Šã€Œç²¾åº¦ãŒä¿è¨¼ã•ã‚Œã¦ã„ã‚‹æ¡ã€ã ã‘ã‚’æŠœãå‡ºã—ãŸmidã®è¡¨ç¾ ã‚’å‡ºåŠ›ã™ã‚‹é–¢æ•°ã§ã™ã€‚\nãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚\nfrom flint import arb, ctx, showgood # è¨ˆç®—ç²¾åº¦ã‚’50æ¡ã«è¨­å®š ctx.dps = 50 x = arb.pi() print(\u0026#34;é€šå¸¸ã®å‡ºåŠ›:\u0026#34;) print(x) print(\u0026#34;showgoodã«ã‚ˆã‚‹å‡ºåŠ›:\u0026#34;) showgood(lambda: arb.pi()) # ctx.dps ã‚’æŒ‡å®šã—ã¦ã„ã‚Œã°ã€dps=50ã¯çœç•¥ã—ã¦ã‚‚è‰¯ã„ã€‚ # showgood(lambda: arb.pi(), dps=50) å®Ÿè¡Œçµæœ\né€šå¸¸ã®å‡ºåŠ›: [3.1415926535897932384626433832795028841971693993751 +/- 9.51e-51] showgoodã«ã‚ˆã‚‹å‡ºåŠ›: 3.1415926535897932384626433832795028841971693993751 â€»ç’°å¢ƒã«ã‚ˆã£ã¦ã¯\n3.1415926535897932384626433832795028841971693993751xxxx\nã®ã‚ˆã†ã«ã€ä¸ç¢ºã‹ãªæ¡ãŒxã§ãƒã‚¹ã‚¯ã•ã‚Œã‚‹å½¢å¼ã§å‡ºåŠ›ã•ã‚Œã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚\nå®Ÿè¡Œä¾‹ã®ã‚ˆã†ã«showgoodã¯ã€åŒºé–“æ¼”ç®—ã®çµæœã‹ã‚‰ã€ç¢ºå®Ÿã«æ­£ã—ã„ã¨ã•ã‚Œã‚‹æ¡ã®ã¿ã‚’è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚\nã“ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ã§ã€è¨ˆç®—çµæœã«ã©ã®ç¨‹åº¦ã®ä¿¡é ¼æ€§ãŒã‚ã‚‹ã‹ã‚’ç°¡å˜ã«ç¢ºèªã§ãã¾ã™ã€‚\nä»–ã«ã‚‚ã€Python-FLINTãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯æ§˜ã€…ãªæ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚\narbã¯å®Ÿæ•°ã®ç²¾åº¦ä¿è¨¼ä»˜ãã®æ•°å€¤è¨ˆç®—ã«ä½¿ç”¨ã•ã‚Œã€acbã¯è™šæ•°ã‚’å«ã‚€è¨ˆç®—ã‚’è¡Œã„ãŸã„å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚è™šæ•°ã®ç²¾åº¦ä¿è¨¼ä»˜ãã®æ•°å€¤è¨ˆç®—ãŒå¿…è¦ãªå ´åˆã«ã€acbã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€è¤‡ç´ æ•°è¨ˆç®—ã‚’é«˜ç²¾åº¦ã«è¡Œãˆã¾ã™ã€‚\nã•ã‚‰ã«è©³ã—ã„ä½¿ã„æ–¹ã‚„APIã«ã¤ã„ã¦ã¯ğŸ‘‰ Python-FLINT ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ ã‚’ã”è¦§ãã ã•ã„ã€‚\nã¾ã¨ã‚ æœ¬è¨˜äº‹ã§ã¯åŒºé–“æ¼”ç®—ï¼ˆInterval Arithmeticï¼‰ ã«ã¤ã„ã¦ã®ç´¹ä»‹ã¨\nå®Ÿéš›ã«ä½¿ãˆã‚‹åŒºé–“æ¼”ç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒª(kv / Arb / Python-FLINT)ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚\næµ®å‹•å°æ•°ç‚¹æ•°ã¯ã€æœ¬è³ªçš„ã«\næœ‰åŠ¹æ¡ãŒæœ‰é™ è¨ˆç®—é‡ãŒå¢—ãˆã‚‹ã»ã©ä¸¸ã‚èª¤å·®ãŒè“„ç©ã™ã‚‹ æ‰±ãˆã‚‹å€¤ã®ç¯„å›²ãŒæœ‰é™ ã¨ã„ã£ãŸã‚ˆã†ãªåˆ¶ç´„ã‚’æŒã£ã¦ã„ã¾ã™ã€‚\nãã‚Œã«å¯¾ã—ã€åŒºé–“æ¼”ç®—ã¯\nã€ŒçœŸå€¤ãŒå¿…ãšå«ã¾ã‚Œã‚‹ç¯„å›²ã€ã‚’è¨ˆç®—ã™ã‚‹ ä¸¸ã‚èª¤å·®ã”ã¨å®‰å…¨ã«åŒ…ã¿è¾¼ã‚€ çµæœã®ã©ã“ã¾ã§ãŒä¿¡é ¼ã§ãã‚‹ã‹(ç²¾åº¦ä¿è¨¼)ãŒå¾—ã‚‰ã‚Œã‚‹ ã¨ã„ã†ç‰¹å¾´ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚\nã“ã“ã§ç´¹ä»‹ã—ãŸArb / Python-FLINTã®ä¸­å¿ƒåŠå¾„å‹(mid-rad) ã¯é«˜é€Ÿãƒ»é«˜ç²¾åº¦ ã§ã‚ã‚Š\næ•°å­¦è¨ˆç®—ãƒ»æ•°å€¤è¨ˆç®—ãƒ»èª¤å·®è©•ä¾¡ãªã©ã§åºƒãåˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚\nâœ”ï¸ æœ¬è¨˜äº‹ã®ãƒã‚¤ãƒ³ãƒˆ\nåŒºé–“æ¼”ç®—ã§ã¯ã€ä¸¸ã‚èª¤å·®ã‚’é¿ã‘ã‚‹ãŸã‚ã«ã€è¨ˆç®—çµæœã‚’å˜ä¸€ã®å€¤ã§ã¯ãªãã€èª¤å·®ã‚’å«ã‚“ã ç¯„å›²ï¼ˆåŒºé–“ï¼‰ã§è¡¨ç¾ã™ã‚‹ã“ã¨ã§ã€çœŸå€¤ã‚’å¿…ãšåŒ…å«ã—ã¦ã„ã‚‹åŒºé–“ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ åŒºé–“æ¼”ç®—ã«ã¯ä¸Šç«¯ä¸‹ç«¯(inf-sup)å‹ã¨ä¸­å¿ƒåŠå¾„(mid-rad)å‹ã®2ç¨®é¡ã®æ–¹æ³•ãŒã‚ã‚‹ã€‚ Pythonã§ã¯Python-FLINTãŒæ‰‹è»½ã§å¼·åŠ› showgoodã‚’ä½¿ã†ã¨ä¿è¨¼ã•ã‚ŒãŸæ¡ã ã‘ã‚’å–ã‚Šå‡ºã›ã‚‹ âœ”ï¸ ä»Šå¾Œã®è¨˜äº‹ã§ã¯\u0026hellip;\næ•°å€¤ç©åˆ† æ•°å€¤å¾®åˆ† ç²¾åº¦ä¿è¨¼ä»˜ãã®è‡ªå‹•å¾®åˆ† ãªã©ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\n","permalink":"http://localhost:1313/posts/interval/","summary":"\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ’¡ \u003cstrong\u003eã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../float\"\u003e\u003cstrong\u003e1. æµ®å‹•å°æ•°ç‚¹æ•°\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../interval\"\u003e\u003cstrong\u003e2. åŒºé–“æ¼”ç®—\u003c/strong\u003e\u003c/a\u003e\u003cstrong\u003eğŸ‘ˆ ä»Šã“ã“\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../numericalIntegration\"\u003e\u003cstrong\u003e3. æ•°å€¤ç©åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalDifferentiation\"\u003e\u003cstrong\u003e4. æ•°å€¤å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../autoDiff\"\u003e\u003cstrong\u003e5. è‡ªå‹•å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003eæµ®å‹•å°æ•°ç‚¹æ•°ã§è¨ˆç®—ã‚’ã—ã¦ã„ã‚‹ã¨ã€\u003cstrong\u003eã€Œã©ã“ã¾ã§ãŒæ­£ã—ã„å€¤ãªã®ã‹ï¼Ÿã€\u003c/strong\u003e ã¨ã„ã†ä¸å®‰ãŒå¸¸ã«ã¤ãã¾ã¨ã„ã¾ã™ã€‚\u003c/p\u003e","title":"åŒºé–“æ¼”ç®—"},{"content":" ğŸ’¡ ã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\n1. æµ®å‹•å°æ•°ç‚¹æ•°ğŸ‘ˆ ä»Šã“ã“\n2. åŒºé–“æ¼”ç®—\n3. æ•°å€¤ç©åˆ†\n4. æ•°å€¤å¾®åˆ†\nãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ä¸­ã« ã€Œ0.1 + 0.2 ãŒ 0.3 ã«ãªã‚‰ãªã„ã€ ã¨ã„ã£ãŸã€æµ®å‹•å°æ•°ç‚¹æ•°ç‰¹æœ‰ã®æŒ™å‹•ã«æˆ¸æƒ‘ã£ãŸçµŒé¨“ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚\nã“ã‚Œã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒæ•°ã‚’æ‰±ã†ã¨ãã«åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹æµ®å‹•å°æ•°ç‚¹æ•°ãŒå®Ÿæ•°ã‚’ãã®ã¾ã¾æ­£ç¢ºã«æ‰±ãˆãªã„ã“ã¨ã«èµ·å› ã—ã¦ã„ã¾ã™ã€‚\næœ¬é¡Œã«å…¥ã‚‹å‰ã«ã€ã‚‚ã†ã²ã¨ã¤ç›´æ„Ÿã«åã™ã‚‹ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n(x - a) + a = x ? æ•°å­¦çš„ã«ã¯ã€æ¬¡ã®ç­‰å¼ã¯å¸¸ã«æˆã‚Šç«‹ã¡ã¾ã™ã€‚\n$$ \\begin{aligned} (x - a) + a = x \\end{aligned} $$\nã¨ã“ã‚ãŒã€ã“ã‚Œã‚’ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã¨ã€ã“ã®ç­‰å¼ãŒæˆã‚Šç«‹ãŸãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚\nä»¥ä¸‹ã® Python ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãã®æ§˜å­ã‚’å®Ÿéš›ã«ç¢ºèªã§ãã¾ã™ã€‚\nï¼ˆ C ãªã©ä»–ã®è¨€èªã§ã‚‚å†ç¾ã§ãã¾ã™ãŒã€æœ€é©åŒ–ã«ã‚ˆã‚ŠæŒ™å‹•ãŒå¤‰ã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ï¼‰\nimport math def calc_a(x): n = math.log2(abs(x)) return 2 ** (n + 53) for x in range(1, 21): a = calc_a(x) # x - a temp = x - a # (x - a) + a result = temp + a # (x - a) + a ã®çµæœã‚’è¡¨ç¤º print(f\u0026#34;({x:2d} - a) + a = {result:5.1f}\u0026#34;,end=\u0026#34;\u0026#34;) # result != x ãªã‚‰ Not Equal! ã‚’è¡¨ç¤º print(\u0026#34;\\n\u0026#34; if result == x else \u0026#34; Not Equal!\\n\u0026#34;, end=\u0026#34;\u0026#34;) å®Ÿè¡Œçµæœï¼š\n\u0026gt; py calc.py ( 1 - a) + a = 1.0 ( 2 - a) + a = 2.0 ( 3 - a) + a = 4.0 Not Equal! ( 4 - a) + a = 4.0 ( 5 - a) + a = 8.0 Not Equal! ( 6 - a) + a = 8.0 Not Equal! ( 7 - a) + a = 8.0 Not Equal! ( 8 - a) + a = 8.0 ( 9 - a) + a = 16.0 Not Equal! (10 - a) + a = 16.0 Not Equal! (11 - a) + a = 16.0 Not Equal! (12 - a) + a = 16.0 Not Equal! (13 - a) + a = 16.0 Not Equal! (14 - a) + a = 16.0 Not Equal! (15 - a) + a = 16.0 Not Equal! (16 - a) + a = 16.0 (17 - a) + a = 32.0 Not Equal! (18 - a) + a = 32.0 Not Equal! (19 - a) + a = 32.0 Not Equal! (20 - a) + a = 32.0 Not Equal! å¤šãã®ã‚±ãƒ¼ã‚¹ã§$(x - a) + a \\neq x$ã¨ãªã£ã¦ã„ã¾ã™ã€‚\næƒ…å ±è½ã¡ æ¼”ç®—ã¯æ­£ç¢ºã«è¡Œã‚ã‚Œã¦ã„ã‚‹ãŒã€å¤‰æ•° $x$ ã®æƒ…å ±ãŒæ¶ˆãˆã¦ã—ã¾ã†\nã“ã®ç¾è±¡ã¯ã€å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ãŒä¿æŒã§ãã‚‹ç²¾åº¦ã«é™ç•ŒãŒã‚ã‚‹ãŸã‚ã«èµ·ã“ã‚Šã¾ã™ã€‚\n$(x - a)$ã®å¼•ãç®—ã‚’è¡Œã†ç¬é–“ã€æœ‰é™ã®æ¡ã«å·¨å¤§ãªæ•°$a$ã¨ãã‚Œã«å¯¾ã—ã¦å°ã•ãªæ•°$x$ã‚’åŒæ™‚ã«åã‚ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚\nã—ã‹ã—ã€æ ã®æ¡æ•°ãŒè¶³ã‚Šãšã€$x$ã®æƒ…å ±ã¯æ¬ è½ã—ã¦ã—ã¾ã„ã¾ã™ã€‚\nã“ã“ã§é‡è¦ãªã®ã¯ã€ã“ã‚Œã¯\nã€Œè¨ˆç®—ãŒãƒã‚°ã£ã¦ã„ã‚‹ã€ ã€Œæ¼”ç®—é€”ä¸­ã§ãŠã‹ã—ãªä¸¸ã‚ãŒèµ·ããŸã€ ã¨ã„ã£ãŸç¨®é¡ã®å•é¡Œã§ã¯ãªã„ã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚\næ¼”ç®—ãã®ã‚‚ã®ã¯ IEEE 754 ã®è¦å®šã©ãŠã‚Šæ­£ã—ãè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚\nãŸã ã—ã€å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ã® æœ‰åŠ¹æ¡æ•°ã¯ 53 ãƒ“ãƒƒãƒˆã—ã‹ãªã„ ãŸã‚ã€\nå·¨å¤§ãªæ•° $a$ ãã‚Œã«æ¯”ã¹ã¦ååˆ†å°ã•ã„æ•° $x$ $(x - a)$ ã®å¼•ãç®—ã‚’è¡Œã†ç¬é–“ã€æœ‰é™ã®æ¡æ•°ã—ã‹ãªã„å™¨ã®ä¸­ã«ã€å·¨å¤§ãªæ•° $a$ ã¨ã€ãã‚Œã«æ¯”ã¹ã¦ååˆ†å°ã•ã„æ•° $x$ ã®ä¸¡æ–¹ã‚’åŒæ™‚ã«åã‚ã‚ˆã† ã¨ã—ã¦ã„ã¾ã™ã€‚\nã“ã®ã‚ˆã†ã«ã€\næ¼”ç®—ã¯ä»•æ§˜ã©ãŠã‚Šã«æ­£ã—ãè¡Œã‚ã‚Œã¦ã„ã‚‹ ã—ã‹ã—ã€Œè¡¨ç¾ã§ãã‚‹æ¡æ•°ãŒè¶³ã‚Šãªã„ã›ã„ã§å°ã•ã„é …ã®æƒ…å ±ãŒæ¶ˆãˆã‚‹ã€ ã¨ã„ã†ç¾è±¡ã‚’ã€ã“ã“ã§ã¯ æƒ…å ±è½ã¡ ã¨å‘¼ã‚“ã§ã„ã¾ã™ã€‚\næ¡è½ã¡ ä¼¼ãŸç¾è±¡ã¨ã—ã¦ æ¡è½ã¡ ãŒã‚ã‚Šã¾ã™ã€‚\næƒ…å ±è½ã¡\nå·¨å¤§ãªæ•° $\\pm$ å°ã•ãªæ•°\nâ†’ å¤§ããªæ•°ã¨å°ã•ãªæ•°ã®ä¸¡æ–¹ã‚’åŒã˜æ ï¼ˆæœ‰åŠ¹æ¡æ•°ï¼‰ã«åã‚ã‚‹ã“ã¨ãŒã§ããšã€\nå°ã•ã„ã»ã†ã®é …ã®æƒ…å ±ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã†ç¾è±¡ã€‚\næ¡è½ã¡\nå·¦è¾º $a$ ã¨å³è¾º $b$ ãŒã»ã¼ç­‰ã—ã„ï¼ˆ$a \\approx b$ï¼‰ã¨ãã€\n$a - b$ ã®å¼•ãç®—ã‚’ã™ã‚‹ã¨æœ‰åŠ¹æ¡æ•°ãŒæ¥µç«¯ã«å°‘ãªããªã£ã¦ã—ã¾ã†ç¾è±¡ã€‚\næ¡è½ã¡ã®å ´åˆã¯\n$$ \\begin{aligned} (a - b) \\times c \\end{aligned} $$\nã®ã‚ˆã†ã«å¾Œç¶šã®è¨ˆç®—ã§èª¤å·®ãŒå¤§ããå¢—å¹…ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nç‰¹ã«ã€å¤‰æ•°$c$ãŒå·¨å¤§ãªå€¤ã ã£ãŸã¨ãã€èª¤å·®ãŒå¤§ããå¢—å¹…ã—ã¾ã™ã€‚\næƒ…å ±è½ã¡ãƒ»æ¡è½ã¡ã®å¯¾ç­– æƒ…å ±è½ã¡ã‚„æ¡è½ã¡ã¯ ã€Œæ¼”ç®—ãã®ã‚‚ã®ã®ãƒŸã‚¹ã€ã§ã¯ãªãã€æ¼”ç®—ã‚’è¡Œã†å‰ã®æ•°å€¤è¡¨ç¾ï¼ˆãƒ“ãƒƒãƒˆã®é™ç•Œï¼‰ã«ã‚ˆã£ã¦å•é¡ŒãŒç”Ÿã˜ã‚‹ç¾è±¡ã§ã™ã€‚\nã—ã‹ã—ã€æ•°å­¦çš„ã«ç­‰ä¾¡ãªåˆ¥ã®è¨ˆç®—æ–¹æ³•ã‚’é¸ã¶ã“ã¨ã§å›é¿ã§ãã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚\næƒ…å ±è½ã¡ã®å¯¾ç­–\nè¨ˆç®—é †åºã‚’å·¥å¤«ã™ã‚‹ã€‚\næƒ…å ±è½ã¡ãŒèµ·ãã‚„ã™ã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦ã€(ã€Œå¤§ããªå€¤ã€+ã€Œä¸­ãã‚‰ã„ã®å€¤ã€) + ã€Œå°ã•ãªå€¤ã€ã®ã‚ˆã†ãªè¨ˆç®—é †åºã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nã€Œå°ã•ãªå€¤ã€ï¼‹ã€Œå¤§ããªå€¤ã€ã¨ã„ã†è¨ˆç®—ã‚’é¿ã‘ã‚‹ãŸã‚ã«ã€ï¼ˆã€Œå°ã•ãªå€¤ã€ï¼‹ã€Œä¸­ãã‚‰ã„ã®å€¤ã€ï¼‰ï¼‹ã€Œå¤§ããªå€¤ã€ã®é †ã§è¨ˆç®—ã™ã‚‹ã“ã¨ã§ã€å°ã•ãªå€¤ã®æƒ…å ±ãŒå¤±ã‚ã‚Œã«ãããªã‚Šã¾ã™ã€‚\nç‰¹ã«ã€åŠ ç®—ã‚’ãŸãã•ã‚“ç¹°ã‚Šè¿”ã™å‡¦ç†ã§ã¯ã€Œã“ã‚Œã¾ã§ã®åˆè¨ˆã€ï¼‹ã€Œæ¬¡ã®é …ã€ã¨ã„ã†å½¢ã«ãªã‚ŠãŒã¡ã§ã€ã€Œå¤§ããªå€¤ã€ï¼‹ã€Œå°ã•ãªå€¤ã€ã®çŠ¶æ…‹ã‚’ä½œã‚Šã‚„ã™ã„ãŸã‚æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ æ¡è½ã¡ã®å¯¾ç­–\næ•°å¼ã‚’å¤‰å½¢ã™ã‚‹ã€‚\nã»ã¼ç­‰ã—ã„å€¤åŒå£«ã®å¼•ãç®—ã«ã‚ˆã£ã¦æœ‰åŠ¹æ¡æ•°ãŒå¤±ã‚ã‚Œã‚‹ã“ã¨ãŒå•é¡Œãªã®ã§ã€å·®ã‚’ç›´æ¥è¨ˆç®—ã™ã‚‹ã“ã¨ã‚’é¿ã‘ã‚‹ãŸã‚ã«å¼å¤‰å½¢ã‚’è¡Œã†ã“ã¨ã§å¯¾ç­–ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ ã“ã®è¨˜äº‹ã§ã¯ã“ã®ã‚ˆã†ãªç¾è±¡ã®æ­£ä½“ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«\nã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒå®Ÿæ•°ã‚’æ­£ç¢ºã«æ‰±ãˆãªã„ç†ç”± IEEE754 ã«åŸºã¥ãæµ®å‹•å°æ•°ç‚¹æ•°ã®ä»•çµ„ã¿ ã©ã®ã‚ˆã†ãªæ•°ãŒèª¤å·®ãªãè¡¨ç¾ã§ãã‚‹ã®ã‹ decimal å‹ã‚„å›ºå®šå°æ•°ç‚¹æ•°ã§ã¯ã©ã†ãªã‚‹ã®ã‹ ç²¾åº¦ã‚’ä¿è¨¼ã™ã‚‹è¨ˆç®—æ–¹æ³•ã®ä¸€ä¾‹ã¨ã—ã¦ã®ã€ŒåŒºé–“æ¼”ç®—ã€ ã«ã¤ã„ã¦é †ã«è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚\nè¨ˆç®—æ©Ÿï¼ˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ï¼‰ã®æ•°å€¤è¡¨ç¾ å…¨ã¦ã®å®Ÿæ•°ã‚’æ­£ç¢ºã«è¡¨ç¾ã™ã‚‹ã“ã¨ã¯ã§ããªã„ æ•°å­¦ã«ãŠã‘ã‚‹å®Ÿæ•°ã¯ã€æ•°ç›´ç·šä¸Šã«å­˜åœ¨ã™ã‚‹ã™ã¹ã¦ã®æ•°ã‚’æŒ‡ã—ã€ç„¡é™ã«é•·ã„æ¡ã‚’æŒã¤ã‚‚ã®ã‚„ã€æ¥µç«¯ã«å¤§ãã„å€¤ãƒ»å°ã•ã„å€¤ã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚\nã—ã‹ã—ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒæ¼”ç®—ã‚„è¨˜æ†¶ã«ä½¿ãˆã‚‹æ¡æ•°ã«ã¯é™ã‚ŠãŒã‚ã‚Šã€è¡¨ç¾ã§ãã‚‹å€¤ã®å¤§ãã•ã«ã‚‚åˆ¶ç´„ãŒã‚ã‚Šã¾ã™ã€‚\nå¤šãã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€æ•°å€¤ã‚’è¡¨ç¾ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ IEEE 754 è¦æ ¼ã® 2 é€²æ•°ã®å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ï¼ˆdouble precisionï¼‰ ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚\næ•°å­¦ã®ä¸–ç•Œã§ã¯ç„¡é™ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä»®å®šã§ãã¾ã™ãŒã€ç¾å®Ÿã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒä½¿ãˆã‚‹ãƒªã‚½ãƒ¼ã‚¹ã¯æœ‰é™ã§ã™ã€‚å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ã¯ã€å®Ÿæ•°ã‚’ æ­£ç¢ºã«è¡¨ã™å€¤ã§ã¯ãªãã€ã‚ãã¾ã§è¿‘ä¼¼çš„ã«è¡¨ã™ãŸã‚ã®å€¤ ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚\nIEEE æ¨™æº–è¦æ ¼ã®æµ®å‹•å°æ•°ç‚¹æ•° IEEE 754 æ¨™æº–è¦æ ¼ã§å®šã‚ã‚‰ã‚Œã¦ã„ã‚‹æµ®å‹•å°æ•°ç‚¹æ•°ï¼ˆæ­£è¦åŒ–æ•°ï¼‰ã¯ã€æ¬¡ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™ã€‚\n$$ \\begin{aligned} a \u0026amp;= (-1)^{s} \\times \\left( 1 + \\frac{d_{1}}{2^{1}} + \\frac{d_{2}}{2^{2}} + \\dots + \\frac{d_{N-1}}{2^{N-1}} \\right) \\times 2^{e} \\\\ s \u0026amp;\\in {0,1},\\quad s\\ \\text{is a bit} \\\\ d_{i} \u0026amp;\\in {0,1},\\quad d_{i}\\ \\text{is a bit} \\end{aligned} $$\nç¬¦å·éƒ¨ï¼ˆSign bitï¼‰ æµ®å‹•å°æ•°ç‚¹æ•°ã§ æ­£è² ã®ç¬¦å·ã‚’è¡¨ã™ 1 ãƒ“ãƒƒãƒˆåˆ†ã®é ˜åŸŸ ã‚’ ç¬¦å·éƒ¨ ã¨å‘¼ã³ã¾ã™ã€‚\nç¬¦å· $s$ ãŒ $0$ ãªã‚‰æ­£ï¼ˆ$+$ï¼‰ã€$1$ ãªã‚‰è² ï¼ˆ$-$ï¼‰ã‚’è¡¨ã—ã¾ã™ã€‚\n$$ (-1)^{s} $$\nä»®æ•°éƒ¨ï¼ˆMantissa / Significandï¼‰ æµ®å‹•å°æ•°ç‚¹æ•°ã§ æœ‰åŠ¹æ¡ï¼ˆç²¾åº¦ï¼‰ã‚’æ‹…ã†éƒ¨åˆ† ã‚’ ä»®æ•°éƒ¨ ã¨å‘¼ã³ã¾ã™ã€‚\nä»®æ•°éƒ¨ã¯å˜ç²¾åº¦ã§ã¯ 23 ãƒ“ãƒƒãƒˆã€å€ç²¾åº¦ã§ã¯ 52 ãƒ“ãƒƒãƒˆã§ã™ã€‚\nIEEE 754 ã§ã¯ã€æ­£è¦åŒ–æ•°ã«ã¤ã„ã¦ã¯å…ˆé ­ãƒ“ãƒƒãƒˆãŒå¿…ãš $1$ ã«ãªã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã¦ã€ãã® $1$ ã‚’æ ¼ç´ã—ãªã„ ã‚±ãƒè¡¨ç¾ï¼ˆhidden bitï¼‰ ã‚’ç”¨ã„ã¾ã™ã€‚\nã“ã®ãŸã‚ã€æ­£è¦åŒ–æ•°ã§ã‚ã‚Œã°å˜ç²¾åº¦ã¯ 24 ãƒ“ãƒƒãƒˆåˆ†ã€å€ç²¾åº¦ã¯ 53 ãƒ“ãƒƒãƒˆåˆ†ã®ç²¾åº¦ã‚’æŒã¡ã¾ã™ã€‚\n$$ \\begin{aligned} m \u0026amp;= \\left( 1 + \\frac{d_{1}}{2^{1}} + \\frac{d_{2}}{2^{2}} + \\dots + \\frac{d_{N-1}}{2^{N-1}} \\right) \\\\ d_{i} \u0026amp;\\in {0,1},\\quad d_{i}\\ \\text{is a bit} \\end{aligned} $$\nåé€²æ•°ã§è¦‹ã‚‹ã¨ã€å˜ç²¾åº¦ã¯ç´„ 7 æ¡ç¨‹åº¦ã€å€ç²¾åº¦ã¯ãŠã‚ˆã 15ï½16 æ¡ç¨‹åº¦ã®ç²¾åº¦ãŒã‚ã‚Šã¾ã™ã€‚\n$$ \\begin{aligned} 24\\log_{10}(2) \u0026amp;\\approx 7.22 \\\\ 53\\log_{10}(2) \u0026amp;\\approx 15.95 \\end{aligned} $$\næŒ‡æ•°éƒ¨ï¼ˆExponentï¼‰ å°æ•°ç‚¹ã®ä½ç½®ï¼ˆ2 é€²æ•°ã§ã®æ¡ã®ã‚·ãƒ•ãƒˆé‡ï¼‰ã‚„æ•°ã®å¤§ãã•ã‚’è¡¨ã™éƒ¨åˆ†ã‚’ æŒ‡æ•°éƒ¨ ã¨å‘¼ã³ã¾ã™ã€‚\næŒ‡æ•°éƒ¨ã¯ä¸€å®šã®ãƒã‚¤ã‚¢ã‚¹å€¤ã‚’åŠ ãˆã‚‹ã“ã¨ã§ã€è² ã®æ•°ã‚’å«ã‚€æŒ‡æ•°ã‚’ç¬¦å·ãªã—æ•´æ•°ã§è¡¨ç¾ã™ã‚‹ ãƒã‚¤ã‚¢ã‚¹ä»˜ãæ•´æ•° ã¨ã—ã¦æ ¼ç´ã•ã‚Œã¾ã™ã€‚\n$$ 2^{e} $$\næŒ‡æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆåˆ—ã‚’ $E$ ã¨ã—ã¦ãƒã‚¤ã‚¢ã‚¹å€¤ã‚’ $b$ ã¨ã™ã‚‹ã¨ã€å®Ÿéš›ã®æŒ‡æ•° $e$ ã¯\n$$ e = E - b $$\nã§è¡¨ã•ã‚Œã¾ã™ã€‚\nå˜ç²¾åº¦ãŠã‚ˆã³å€ç²¾åº¦ã®æŒ‡æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ã‚„ãƒã‚¤ã‚¢ã‚¹å€¤ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nç²¾åº¦ æŒ‡æ•°éƒ¨ $E$ $b$ $e = E - b$ å˜ç²¾åº¦ (32bit) 8bit $1 \\le E \\le 254$ $b=127$ $-126 \\le e \\le 127$ å€ç²¾åº¦ (64bit) 11bit $1 \\le E \\le 2046$ $b=1023$ $-1022 \\le e \\le 1023$ ç‰¹åˆ¥ãªæŒ‡æ•°ãƒ“ãƒƒãƒˆåˆ— ã¾ãŸã€ç‰¹åˆ¥ãªæŒ‡æ•°ãƒ“ãƒƒãƒˆåˆ—ã¯æ¬¡ã®ç”¨é€”ã«äºˆç´„ã•ã‚Œã¦ã„ã¾ã™ã€‚\næŒ‡æ•°éƒ¨ ä»®æ•°éƒ¨ å€¤ã®ç¨®é¡ èª¬æ˜ $E = 0$ $m = 0$ $\\pm 0$ æ­£è² ã®ã‚¼ãƒ­ $E = 0$ $m \\neq 0$ éæ­£è¦åŒ–æ•° çµ¶å¯¾å€¤ãŒæ¥µç«¯ã«å°ã•ã„ã€0ã«éå¸¸ã«è¿‘ã„æ•°ã‚’è¡¨ã™æ–¹æ³• $E_{max}$ $m = 0$ $\\pm \\infty$ è¨ˆç®—çµæœãŒè¡¨ç¾å¯èƒ½ãªç¯„å›²ã‚’è¶…ãˆãŸã¨ããªã©ã«ç¾ã‚Œã‚‹ã€‚ã“ã®ç¾è±¡ã‚’ ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ ã¨å‘¼ã¶ $E_{max}$ $m \\neq 0$ NaNï¼ˆéæ•°ï¼‰ 0 ã§å‰²ã‚‹ãªã©ã€æ•°ã¨ã—ã¦è§£é‡ˆã§ããªã„çµæœã‚’è¡¨ã™ æŒ‡æ•°éƒ¨$E=0$ã¯æŒ‡æ•°ãƒ“ãƒƒãƒˆåˆ—ãŒã™ã¹ã¦0ã®ã¨ãã‚’æŒ‡ã—ã¾ã™ã€‚ æŒ‡æ•°éƒ¨$E_{max}$ã¯æŒ‡æ•°ãƒ“ãƒƒãƒˆåˆ—ãŒã™ã¹ã¦1ã®ã¨ãã‚’æŒ‡ã—ã¾ã™ã€‚\nå˜ç²¾åº¦ï¼š$E = 255$\nå€ç²¾åº¦ï¼š$E = 2047$ ç²¾åº¦ã«ã‚ˆã‚‹é•ã„ æµ®å‹•å°æ•°ç‚¹æ•°ã®ç²¾åº¦ã«ã¯å˜ç²¾åº¦ï¼ˆ32 ãƒ“ãƒƒãƒˆï¼‰ã€å€ç²¾åº¦ï¼ˆ64 ãƒ“ãƒƒãƒˆï¼‰ã€ä»»æ„ç²¾åº¦ãªã©æ§˜ã€…ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚\nç²¾åº¦ãŒé«˜ããªã‚‹ã¨ä»®æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ãŒå¢—ãˆã‚‹ã“ã¨ã§ æ‰±ãˆã‚‹æ¡æ•°ï¼ˆæœ‰åŠ¹æ¡æ•°ï¼‰ ãŒå¢—ãˆã€æŒ‡æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ãŒå¢—ãˆã‚‹ã“ã¨ã§ è¡¨ç¾ã§ãã‚‹å€¤ã®ç¯„å›² ã‚‚åºƒããªã‚Šã¾ã™ã€‚\næ­£è¦åŒ–æ•°ã«å¯¾ã™ã‚‹ä»®æ•°ãƒ“ãƒƒãƒˆ $N$ ã¨æŒ‡æ•° $e$ ã®ç¯„å›²ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n$$ \\begin{aligned} \\text{å˜ç²¾åº¦}\\quad N \u0026amp;= 24,\\quad -126 \\le e \\le 127 \\\\ \\text{å€ç²¾åº¦}\\quad N \u0026amp;= 53,\\quad -1022 \\le e \\le 1023 \\end{aligned} $$\nå›³ã«ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™ã€‚\nå˜ç²¾åº¦(32bit) flowchart LR\rS[Sign1 bit]:::small\rE[Exponent8 bits]:::mid\rM[Mantissa23 bits]:::large\rS --- E --- M\rclassDef small fill:#fee,border:#f66;\rclassDef mid fill:#eef,border:#66f;\rclassDef large fill:#efe,border:#6f6;\rå€ç²¾åº¦(64bit) flowchart LR\rS[Sign1 bit]:::small\rE[Exponent11 bits]:::mid\rM[Mantissa52 bits]:::large\rS --- E --- M\rclassDef small fill:#fee,border:#f66;\rclassDef mid fill:#eef,border:#66f;\rclassDef large fill:#efe,border:#6f6;\rãªãœã™ã¹ã¦ã®å®Ÿæ•°ã‚’æ­£ç¢ºã«è¡¨ç¾ã§ããªã„ã®ã‹ æµ®å‹•å°æ•°ç‚¹æ•°ã‚’ç”¨ã„ã¦ã™ã¹ã¦ã®å®Ÿæ•°ã‚’æ­£ç¢ºã«è¡¨ç¾ã§ããªã„ç†ç”±ã¯ã€æ¬¡ã® 3 ç‚¹ã«ã¾ã¨ã‚ã‚‰ã‚Œã¾ã™ã€‚\n2 é€²æ•°ã§å°æ•°ã‚’è¡¨ç¾ã—ã¦ã„ã‚‹ã“ã¨\n10 é€²æ•°ã§ã¯æœ‰é™æ¡ã§æ›¸ã‘ã‚‹æ•°ã§ã‚‚ã€2 é€²æ•°ã«ã™ã‚‹ã¨ç„¡é™ã«ç¶šãå°æ•°ã«ãªã‚‹å ´åˆãŒå¤šãã‚ã‚Šã¾ã™ã€‚\næœ‰åãªä¾‹ã¨ã—ã¦å¾ªç’°å°æ•°ã«ãªã‚‹ 0.1 ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚\næœ‰åŠ¹æ¡æ•°ï¼ˆä»®æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ï¼‰ãŒæœ‰é™ã§ã‚ã‚‹ã“ã¨\n2 é€²å°æ•°ãŒç„¡é™ã«ç¶šãå ´åˆã§ã‚‚ã€é€”ä¸­ã§ã©ã“ã‹ã®æ¡ã§ä¸¸ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã“ã®éç¨‹ã§ä¸¸ã‚èª¤å·®ï¼ˆrounding errorï¼‰ ãŒç™ºç”Ÿã—ã¾ã™ã€‚\næ‰±ãˆã‚‹æŒ‡æ•°ã®ç¯„å›²ãŒæœ‰é™ã§ã‚ã‚‹ã“ã¨\næŒ‡æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ã«ã¯é™ã‚ŠãŒã‚ã‚‹ãŸã‚ã€æ¥µç«¯ã«å¤§ãã„å€¤ãƒ»å°ã•ã„å€¤ã¯è¡¨ç¾ã§ãã¾ã›ã‚“ã€‚\næµ®å‹•å°æ•°ç‚¹æ•°ã§æ­£ç¢ºã«è¡¨ç¾å¯èƒ½ãªä¾‹ ä»®æ•°éƒ¨ã®æ§‹é€ ã«æ³¨ç›®ã™ã‚‹ã¨ã€æµ®å‹•å°æ•°ç‚¹æ•°ã§æ­£ç¢ºã«è¡¨ã›ã‚‹å€¤ã¯ã€å®Ÿã¯éå¸¸ã«é™ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\næ¬¡ã®æ•°ã®ã†ã¡ã€å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ã§ èª¤å·®ãªãæ­£ç¢ºã«è¡¨ç¾ã§ãã‚‹æ•° ã¯ã©ã‚Œã§ã—ã‚‡ã†ã‹ï¼Ÿ\n$$ \\begin{aligned} 0.1,\\ 0.2,\\ 0.3,\\ 0.4,\\ 0.5,\\ 0.6,\\ 0.7,\\ 0.8,\\ 0.9 \\end{aligned} $$\nç­”ãˆã¯ 0.5 ã®ã¿ ã§ã™ã€‚\n$$ \\begin{aligned} 0.5 = \\frac{1}{2^1} \\end{aligned} $$\nç†ç”±ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚\næµ®å‹•å°æ•°ç‚¹æ•°ã§æ­£ç¢ºã«è¡¨ç¾ã§ãã‚‹å®Ÿæ•°ã¯ã€\n$$ \\begin{aligned} \u0026amp;\\frac{\\mu}{2^\\nu}\\\\ \\mu, \\nu \u0026amp;\\in \\mathbb{Z} \\end{aligned} $$\nã®å½¢ã§æ›¸ã‘ã¦ã€ã‹ã¤ æŒ‡æ•°ãŒæŒ‡æ•°éƒ¨ã®ç¯„å›²å†…ã«åã¾ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã¤ã¾ã‚Šã€æ¬¡ã® 3 ã¤ã™ã¹ã¦ã‚’æº€ãŸã™å ´åˆã«ã®ã¿ æ­£ç¢ºã«è¡¨ç¾ã§ãã¾ã™ã€‚\n2 é€²è¡¨ç¾ãŒæœ‰é™ã§çµ‚ã‚ã‚‹ã“ã¨ï¼ˆ$2^{\\nu}$ ã§å‰²ã£ãŸå½¢ã«æ›¸ã‘ã‚‹ã“ã¨ï¼‰ åˆ†å­$\\mu$ãŒä»®æ•°éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ã§è¡¨ã›ã‚‹ç¯„å›²ã®æ•´æ•°ã§ã‚ã‚‹ã“ã¨ æµ®å‹•å°æ•°ç‚¹æ•°ã®å½¢ã«ç›´ã—ãŸæ™‚ã«ã€æŒ‡æ•°ãŒæŒ‡æ•°éƒ¨ã®ç¯„å›²å†…ã«åã¾ã‚‹ã“ã¨ ã“ã®æ¡ä»¶ã‚’æº€ãŸã™ã®ã¯ã€ä¸Šã®ä¾‹ã§ã¯ 0.5ï¼ˆ1/2ï¼‰ ã®ã¿ã§ã™ã€‚\nä»–ã«ã‚‚ã€æ¬¡ã®ã‚ˆã†ãªå€¤ã¯2é€²å°æ•°ãŒæœ‰é™ã§çµ‚ã‚ã‚Šã€ä»®æ•°éƒ¨ã¨æŒ‡æ•°éƒ¨ã®ç¯„å›²ã«åã¾ã‚‹ãŸã‚æ­£ç¢ºã«è¡¨ç¾ã§ãã¾ã™ã€‚\n$$ \\begin{aligned} \\qquad \\qquad 3.625 \u0026amp;= 2^1 + 2^0 + \\frac{1}{2^1} + \\frac{1}{2^3} \\\\ \u0026amp;= \\frac{29}{2^3} \\end{aligned} $$\n$$ \\begin{aligned} 0.75 \u0026amp;= \\frac{1}{2^1} + \\frac{1}{2^2} \\\\ \u0026amp;= \\frac{3}{2^2} \\end{aligned} $$\n$$ \\begin{aligned} 0.000000954606549 \u0026amp;= \\frac{1}{2^{20}} + \\frac{1}{2^{30}} + \\frac{1}{2^{40}} + \\frac{1}{2^{50}}\\\\ \u0026amp;= \\frac{1,074,791,425}{2^{50}} \\end{aligned} $$\n10é€²æ•°ã®æµ®å‹•å°æ•°ç‚¹æ•°ãªã‚‰èª¤å·®ã¯ç™ºç”Ÿã—ãªã„ï¼Ÿ 10 é€²æ•°ã®æµ®å‹•å°æ•°ç‚¹æ•°ï¼ˆdecimal å‹ï¼‰ã¯ã€2 é€²æ•°ã®å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ï¼ˆdouble å‹ï¼‰ã¨æ¯”ã¹ã¦ã€Œ10 é€²ã§æœ‰é™æ¡ã®å°æ•°ã‚’æ­£ç¢ºã«è¡¨ã›ã‚‹ã€ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚\nãŸã¨ãˆã° 0.1 ã‚„ 0.01 ãªã©ã¯ decimal å‹ã§ã¯èª¤å·®ãªãè¡¨ç¾ã§ãã¾ã™ã€‚\nã—ã‹ã—ã€æ¬¡ã®å•é¡Œã¯ä¾ç„¶ã¨ã—ã¦æ®‹ã‚Šã¾ã™ã€‚\næœ‰åŠ¹æ¡æ•°ï¼ˆä»®æ•°éƒ¨ã®æ¡æ•°ï¼‰ãŒæœ‰é™ã§ã‚ã‚‹ã“ã¨ æ‰±ãˆã‚‹æŒ‡æ•°ã®ç¯„å›²ãŒæœ‰é™ã§ã‚ã‚‹ã“ã¨ ãã®ãŸã‚ decimal å‹ã§ã‚‚ã€ä¾‹ãˆã°\n$$ \\frac{1}{3} = 0.333333\\dots $$\nã®ã‚ˆã†ã« 10 é€²ã§ã‚‚ç„¡é™ã«ç¶šãå°æ•°ã‚’å³å¯†ã«ä¿æŒã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\nã¾ãŸã€decimal å‹ã¯ double å‹ã«æ¯”ã¹ã¦ æŒ‡æ•°éƒ¨ã®ç¯„å›²ãŒç‹­ã„ãŸã‚ã€\nè¡¨ç¾ã§ãã‚‹å€¤ã®æœ€å¤§å€¤ãƒ»æœ€å°å€¤ãŒå°ã•ããªã‚Šã€\nã€Œéå¸¸ã«å¤§ããªæ•°å€¤ã€ã€Œéå¸¸ã«å°ã•ãªæ•°å€¤ã€ã‚’æ‰±ã†ç”¨é€”ã«ã¯å‘ãã¾ã›ã‚“ã€‚\nã¤ã¾ã‚Šã€decimal å‹ã¯\n10é€²åŸºæº–ã®è¨ˆç®—ã‚’æ­£ç¢ºã«è¡Œã„ãŸã„ ãŸã ã—æ‰±ãˆã‚‹æ•°å€¤ãƒ¬ãƒ³ã‚¸ã¯ç‹­ããªã‚‹ ã¨ã„ã†ç‰¹å¾´ã‚’æŒã£ãŸå½¢å¼ã§ã™ã€‚\nå›ºå®šå°æ•°ç‚¹æ•°ã¯ï¼Ÿ å›ºå®šå°æ•°ç‚¹æ•°ï¼ˆfixed-pointï¼‰ã‚‚ã€decimal å‹ã¨åŒæ§˜ã« æœ‰åŠ¹æ¡æ•°ãŒæœ‰é™ã§ã‚ã‚‹ ã¨ã„ã†å•é¡Œã‚’é¿ã‘ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\nãã®ãŸã‚ã€è¡¨ç¾ã§ãã‚‹å€¤ã¯åˆ»ã¿å¹…ã«ä¾å­˜ã—ã¦ãŠã‚Šã€æ¬¡ã®åˆ¶ç´„ãŒå­˜åœ¨ã—ã¾ã™ã€‚\nè¡¨ã›ã‚‹å°æ•°ã®åˆ»ã¿ãŒå›ºå®šã•ã‚Œã¦ã„ã‚‹ï¼ˆä¾‹ï¼š0.01 åˆ»ã¿ãªã©ï¼‰ ãã®åˆ»ã¿ã§è¡¨ã›ãªã„å€¤ã¯ä¸¸ã‚ãŒç™ºç”Ÿã™ã‚‹ æ‰±ãˆã‚‹ç¯„å›²ã‚‚æœ‰é™ã§ã‚ã‚‹ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã®å¯èƒ½æ€§ï¼‰ ãŸã¨ãˆã°å°æ•°ç¬¬2ä½ã¾ã§ã—ã‹ä¿æŒã—ãªã„å›ºå®šå°æ•°ç‚¹å½¢å¼ã§ã¯ã€\n$$ 0.123 \\rightarrow 0.12 $$\nã®ã‚ˆã†ã«å¿…ãšä¸¸ã‚ãŒç™ºç”Ÿã—ã¾ã™ã€‚\nå›ºå®šå°æ•°ç‚¹æ•°ã¯ã€æ¼”ç®—ãŒé«˜é€Ÿã§äºˆæ¸¬å¯èƒ½ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚‹ä¸€æ–¹ã§ã€\næµ®å‹•å°æ•°ç‚¹æ•°ã®ã‚ˆã†ã« åºƒã„ç¯„å›²ã®æ•°ã‚’æŸ”è»Ÿã«æ‰±ã†ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\nãã‚Œã§ã‚‚å³å¯†ã«æ­£ã—ã„å€¤ã‚’ä¿æŒã—ãŸã„ æµ®å‹•å°æ•°ç‚¹æ•°ã§ã¯èª¤å·®ã‚’å®Œå…¨ã«é¿ã‘ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ãŒ\nè¨ˆç®—çµæœãŒå¿…ãšçœŸã®å€¤ã‚’å«ã‚€ç¯„å›²ï¼ˆåŒºé–“ï¼‰ã¨ã—ã¦å¾—ã‚‰ã‚Œã‚‹æ–¹æ³• ãŒã‚ã‚Šã¾ã™ã€‚\nãã®ä¸€ã¤ãŒ åŒºé–“æ¼”ç®—ï¼ˆInterval Arithmeticï¼‰ ã§ã™ã€‚\nåŒºé–“æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ä¸¸ã‚èª¤å·®ã‚’å«ã‚€è¨ˆç®—ã§ã‚‚ã€ã€ŒçœŸã®å€¤ãŒå¿…ãšã“ã®ç¯„å›²ã«ã‚ã‚‹ã€ã¨ã„ã† ç²¾åº¦ä¿è¨¼ä»˜ãã®è¨ˆç®—(Verified numerics) ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚\nã¾ã¨ã‚ ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¯æœ‰é™ã®ãƒ“ãƒƒãƒˆæ•°ã—ã‹æŒãŸãªã„ãŸã‚ã€å®Ÿæ•°ã‚’ãã®ã¾ã¾æ ¼ç´ã™ã‚‹ã“ã¨ã¯ã§ããªã„ IEEE 754 æµ®å‹•å°æ•°ç‚¹æ•°ã¯ã€Œè¿‘ä¼¼è¨ˆç®—ã®ãŸã‚ã®ä»•çµ„ã¿ã€ã§ã‚ã‚Šã€èª¤å·®ã¯é¿ã‘ã‚‰ã‚Œãªã„ æ­£ç¢ºã«è¡¨ã›ã‚‹å€¤ã¯ã”ãé™ã‚‰ã‚ŒãŸã€Œ2é€²ã§æœ‰é™ã«è¡¨ã›ã‚‹æ•°ã€ã®ã¿ decimal å‹ã‚„å›ºå®šå°æ•°ç‚¹æ•°ã«ã‚‚ã€ç²¾åº¦ã‚„ç¯„å›²ã®åˆ¶é™ãŒã‚ã‚‹ ã€Œèª¤å·®ã‚’å«ã‚“ã ã¾ã¾å®‰å…¨ã«è¨ˆç®—ã—ãŸã„ã€ã¨ã„ã†ç›®çš„ã«ã¯åŒºé–“æ¼”ç®—ãŒæœ‰åŠ¹ æ¬¡ã®è¨˜äº‹ã§ã¯ã€åŒºé–“æ¼”ç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\n","permalink":"http://localhost:1313/posts/float/","summary":"\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ’¡ \u003cstrong\u003eã“ã®è¨˜äº‹ã¯ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§è¨ˆç®—ã™ã‚‹ã€ã‚·ãƒªãƒ¼ã‚ºã®ä¸€éƒ¨ã§ã™ã€‚\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../float\"\u003e\u003cstrong\u003e1. æµ®å‹•å°æ•°ç‚¹æ•°\u003c/strong\u003e\u003c/a\u003e\u003cstrong\u003eğŸ‘ˆ ä»Šã“ã“\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"../interval\"\u003e\u003cstrong\u003e2. åŒºé–“æ¼”ç®—\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalIntegration\"\u003e\u003cstrong\u003e3. æ•°å€¤ç©åˆ†\u003c/strong\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"../numericalDifferentiation\"\u003e\u003cstrong\u003e4. æ•°å€¤å¾®åˆ†\u003c/strong\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp\u003eãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ä¸­ã« \u003cstrong\u003eã€Œ0.1 + 0.2 ãŒ 0.3 ã«ãªã‚‰ãªã„ã€\u003c/strong\u003e ã¨ã„ã£ãŸã€æµ®å‹•å°æ•°ç‚¹æ•°ç‰¹æœ‰ã®æŒ™å‹•ã«æˆ¸æƒ‘ã£ãŸçµŒé¨“ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚\u003cbr\u003e\nã“ã‚Œã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒæ•°ã‚’æ‰±ã†ã¨ãã«åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹æµ®å‹•å°æ•°ç‚¹æ•°ãŒå®Ÿæ•°ã‚’ãã®ã¾ã¾æ­£ç¢ºã«æ‰±ãˆãªã„ã“ã¨ã«èµ·å› ã—ã¦ã„ã¾ã™ã€‚\u003c/p\u003e","title":"æµ®å‹•å°æ•°ç‚¹æ•°"}]